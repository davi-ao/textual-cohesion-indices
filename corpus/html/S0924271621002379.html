<div class="Body u-font-serif" id="body"><div><section id="s0005"><h2 id="st015" class="u-h3 u-margin-l-top u-margin-xs-bottom">1. Introduction</h2><p id="p0005"><span>Driven by the rapid development of Earth observation technology, massive numbers of remotely sensed images at fine spatial resolution are commercially available for a variety of applications, such as <a href="/topics/computer-science/image-classification" title="Learn more about image classification from ScienceDirect's AI-generated Topic Pages" class="topic-link">image classification</a> (</span><a name="bb0205" href="#b0205" class="workspace-trigger">Lyons et al., 2018</a>, <a name="bb9000" href="#b9000" class="workspace-trigger">Maggiori et al., 2016</a>), object detection (<a name="bb9015" href="#b9015" class="workspace-trigger">Li et al., 2017</a>; <a name="bb0310" href="#b0310" class="workspace-trigger">Xia et al., 2018</a>) and semantic segmentation (<a name="bb0140" href="#b0140" class="workspace-trigger">Kemker et al., 2018</a>, <a name="bb0355" href="#b0355" class="workspace-trigger">Zhang et al., 2019a</a>). The re-visit capabilities of orbital sensors facilitate continuous monitoring of the land surface, ocean, and atmosphere (<a name="bb0065" href="#b0065" class="workspace-trigger">Duan and Li, 2020</a><span><span>). Fine-resolution remotely sensed images are rich in information and contain substantial <a href="/topics/computer-science/spatial-detail" title="Learn more about spatial detail from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial detail</a> for land cover and land use classification and segmentation. Different automatic and semi-automatic methods have been developed to identify land cover and land use categories by exploiting spectral and spectral-spatial features within </span><a href="/topics/computer-science/remote-sensing-image" title="Learn more about remote sensing images from ScienceDirect's AI-generated Topic Pages" class="topic-link">remote sensing images</a> (</span><a name="bb0085" href="#b0085" class="workspace-trigger">Gong et al., 1992</a>, <a name="bb0210" href="#b0210" class="workspace-trigger">Ma et al., 2017</a>, <a name="bb0270" href="#b0270" class="workspace-trigger">Tucker, 1979</a>, <a name="bb0380" href="#b0380" class="workspace-trigger">Zhong et al., 2014</a>, <a name="bb0385" href="#b0385" class="workspace-trigger">Zhu et al., 2017</a>). However, these traditional approaches rely on handcrafting features and information transformation, which commonly fail to adequately capture the contextual information contained abundantly within images, and are often limited in their flexibility and general adaptability (<a name="bb0165" href="#b0165" class="workspace-trigger">Li et al., 2020</a>, <a name="bb0265" href="#b0265" class="workspace-trigger">Tong et al., 2020</a><span>). This is especially true given the detailed structural and contextual information provided at a very fine spatial resolution. Meanwhile, recent developments in deep learning, and <a href="/topics/computer-science/deep-convolutional-neural-networks" title="Learn more about deep convolutional neural network from ScienceDirect's AI-generated Topic Pages" class="topic-link">deep convolutional neural network</a> (CNN), in particular, have replaced feature engineering with high-level non-linear feature representations created end-to-end, hierarchically, and in an automatic fashion. This has had a transformative impact on information understanding and semantic characterization from fine-resolution remotely sensed imagery (</span><a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>, <a name="bb0375" href="#b0375" class="workspace-trigger">Zheng et al., 2020</a>).</p><div><p id="p0010">Semantic segmentation, which assigns each pixel in an image to a particular category, has become one of the most important approaches for ground feature interpretation, playing a pivotal role in different application scenarios (<a name="bb0285" href="#b0285" class="workspace-trigger">Wang et al., 2021</a>), such as precision agriculture (<a name="bb0090" href="#b0090" class="workspace-trigger">Griffiths et al., 2019</a>, <a name="bb0230" href="#b0230" class="workspace-trigger">Picoli et al., 2018</a>), environmental protection (<a name="bb0250" href="#b0250" class="workspace-trigger">Samie et al., 2020</a>, <a name="bb0320" href="#b0320" class="workspace-trigger">Yin et al., 2018</a>) and economic assessment (<a name="bb0350" href="#b0350" class="workspace-trigger">Zhang et al., 2020</a>, <a name="bb0355" href="#b0355" class="workspace-trigger">Zhang et al., 2019a</a><span>). The fully <a href="/topics/computer-science/convolutional-network" title="Learn more about convolutional network from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolutional network</a><span> (FCN) was demonstrated to be the first effective end-to-end <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNN from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNN</a> structure for semantic segmentation (</span></span><a name="bb0195" href="#b0195" class="workspace-trigger">Long et al., 2015</a><span>). Restricted by the oversimplified design of the <a href="/topics/earth-and-planetary-sciences/decoder" title="Learn more about decoder from ScienceDirect's AI-generated Topic Pages" class="topic-link">decoder</a>, the results of FCN, although encouraging in principle, are presented at a coarse resolution. Subsequently, more elaborate encoder-decoder structures, such as U-Net, have been proposed, with two symmetric paths: a contracting path for extracting features and an expanding path for achieving accurate results through precise positioning (</span><a name="bb0010" href="#b0010" class="workspace-trigger">Badrinarayanan et al., 2017</a>, <a name="bb0155" href="#b0155" class="workspace-trigger">Li et al., 2021a</a>, <a name="bb0245" href="#b0245" class="workspace-trigger">Ronneberger et al., 2015</a>). The per-pixel classification is often ambiguous in the presence of only local information for semantic segmentation, while the task becomes much simpler if global contextual information, from the whole image, is available (as shown in <a name="bf0005" href="#f0005" class="workspace-trigger">Fig. 1</a><span><span>). Therefore, to guarantee the accuracy of segmentation, global contextual information and multiscale <a href="/topics/computer-science/semantic-feature" title="Learn more about semantic features from ScienceDirect's AI-generated Topic Pages" class="topic-link">semantic features</a> were utilized comprehensively to differentiate </span><a href="/topics/computer-science/semantic-category" title="Learn more about semantic categories from ScienceDirect's AI-generated Topic Pages" class="topic-link">semantic categories</a><span> at different spatial scales. Through the spatial pyramid pooling module, the pyramid scene <a href="/topics/computer-science/parsing" title="Learn more about parsing from ScienceDirect's AI-generated Topic Pages" class="topic-link">parsing</a> network (PSPNet) aggregated contextual information across different regions (</span></span><a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a><span>). The dual <a href="/topics/computer-science/attention-network" title="Learn more about attention network from ScienceDirect's AI-generated Topic Pages" class="topic-link">attention network</a> (DANet) applied the dot-product attention mechanism to extract abundant contextual relationships (</span><a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a>). Subject to an enormous memory and computational demand, DANet simply attached the dot-product attention mechanism at the lowest layer without capturing the long-range dependencies from the larger feature maps in the higher layers. DeeplabV3 adopted atrous convolution to mine the multiscale features (<a name="bb0030" href="#b0030" class="workspace-trigger">Chen et al., 2017a</a>) and a simple, yet useful, decoder module was added in DeepLabV3&nbsp;+&nbsp;to further refine the segmentation results (<a name="bb0035" href="#b0035" class="workspace-trigger">Chen et al., 2018a</a>).</p><figure class="figure text-xs" id="f0005"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr1.jpg" height="359" alt="" aria-describedby="cn0005"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr1_lrg.jpg" target="_blank" download="" title="Download high-res image (466KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (466KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr1.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0005"><p id="sp0010"><span class="label">Fig. 1</span>. Illustration of global and local contextual information.</p></span></span></figure></div><p id="p0015">The extraction of global contextual information and the exploitation of large-scale feature maps are computationally expensive (<a name="bb0040" href="#b0040" class="workspace-trigger">Chen et al., 2017b</a>, <a name="bb0060" href="#b0060" class="workspace-trigger">Diakogiannis et al., 2020b</a>, <a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>). Therefore, a series of lightweight networks have been developed to accelerate the computation while maintaining the trade-off between accuracy and efficiency (<a name="bb9005" href="#b9005" class="workspace-trigger">Hu et al., 2020</a>; <a name="bb0225" href="#b0225" class="workspace-trigger">Oršić and Šegvić, 2021</a>; <a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a>; <a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>, <a name="bb0390" href="#b0390" class="workspace-trigger">Zhuang et al., 2019</a>). For example, the asymmetric convolution used in ERFNet factorized the standard 3&nbsp;×&nbsp;3 convolutions into a 1&nbsp;×&nbsp;3 convolution and a 3&nbsp;×&nbsp;1 convolution, saving approximately 33% of the computational cost (<a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a><span>). By exploiting <a href="/topics/computer-science/spatial-correlation" title="Learn more about spatial correlations from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial correlations</a> and cross-channel correlations, respectively, BiseNet achieved depth-wise separable convolution (</span><a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>), which further reduced the consumption of standard convolution (<a name="bb0050" href="#b0050" class="workspace-trigger">Chollet, 2017</a>). Multi-scale encoder-decoder branch pairs with skip connections were studied in ShelfNet (<a name="bb0390" href="#b0390" class="workspace-trigger">Zhuang et al., 2019</a>), where a shared-weight strategy was harnessed in the residual block to reduce the number of parameters without sacrificing accuracy. For non-local context aggregation, FANet employed the fast attention module in efficient semantic segmentation (<a name="bb9005" href="#b9005" class="workspace-trigger">Hu et al., 2020</a>). SwiftNet explored the effectiveness of pyramidal fusion in compact architectures (<a name="bb0225" href="#b0225" class="workspace-trigger">Oršić and Šegvić, 2021</a>). However, the CNN is designed to extract local patterns and lacks the ability to model global context in its nature. More severely, as lightweight networks normally adopted relatively shallow backbones, the capacity of those networks to extract global contextual information is further limited.</p><p id="p0020">Due to the limited capacity of lightweight networks to extract global contextual information, there is a huge gap in accuracy between lightweight networks and state-of-the-art deep models, which limits their applicability to fine-resolution remotely sensed images. The dot-product attention mechanism, as a powerful approach that can capture long-range dependencies, is potentially an ideal solution to address this issue (<a name="bb0275" href="#b0275" class="workspace-trigger">Vaswani et al., 2017</a>). However, the memory and computational costs of the dot-product attention mechanism increase quadratically with an increase in the spatio-temporal size of the input, which runs counter to the aim of lightweight networks. Encouragingly, previous researches on linear attention (<a name="bb0135" href="#b0135" class="workspace-trigger">Katharopoulos et al., 2020</a>, <a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>) reduce the complexity of the dot-product attention mechanism from <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-75-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>O</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi></mrow><mn is=&quot;true&quot;>2</mn></msup><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.08ex" height="3.199ex" viewBox="0 -952.9 3048.5 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use></g><use xlink:href="#MJSZ1-28" is="true" x="763" y="-1"></use><g is="true" transform="translate(1222,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(914,410)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g><use xlink:href="#MJSZ1-29" is="true" x="2589" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><msup is="true"><mrow is="true"><mi is="true">N</mi></mrow><mn is="true">2</mn></msup><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-75"><math><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><msup is="true"><mrow is="true"><mi is="true">N</mi></mrow><mn is="true">2</mn></msup><mo stretchy="true" is="true">)</mo></mrow></math></script></span> to <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-76-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>O</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>N</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.646ex" height="2.709ex" viewBox="0 -847.3 2431 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use></g><g is="true" transform="translate(763,0)"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(1153,0)"><use xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(2041,0)"><use xlink:href="#MJMAIN-29"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><mi is="true">N</mi><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-76"><math><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><mi is="true">N</mi><mo stretchy="true" is="true">)</mo></mrow></math></script></span>, with a significant increase in computational speed, while maintaining high accuracy.</p><div><p id="p0025">In this paper, we aim to further increase segmentation accuracy while ensuring the efficiency of semantic segmentation simultaneously. We address this challenge by modeling the global contextual information using the linear attention mechanism. Specifically, we propose an Attentive Bilateral Contextual Network (ABCNet) to realize efficient semantic segmentation of fine-resolution remote sensing images. Following the design philosophy of BiSeNet (<a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>), we design the ABCNet based on a bilateral architecture: a spatial path to retain the abundant spatial detail and a contextual path to capture the global contextual information. As the features generated by the two paths are quite disparate semantically, we further design a feature aggregation module (FAM) to fuse those features. The comparison between the conventional encoder-decoder structure and the bilateral architecture used in the proposed ABCNet can be seen in <a name="bf0010" href="#f0010" class="workspace-trigger">Fig. 2</a>. The main contributions are two-fold. On the one hand, we propose a novel approach for efficient semantic segmentation of fine-resolution remotely sensed imagery, i.e., ABCNet with spatial and contextual paths. On the other hand, we design two specific modules: an attention enhancement module (AEM) for exploring long-range contextual information, and a feature aggregation module (FAM) for fusing the features obtained by the two paths. A thorough benchmark comparison was undertaken against the state-of-the-art to demonstrate the effectiveness of the proposed ABCNet.</p><figure class="figure text-xs" id="f0010"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr2.jpg" height="328" alt="" aria-describedby="cn0010"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr2_lrg.jpg" target="_blank" download="" title="Download high-res image (158KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (158KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr2.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0010"><p id="sp0015"><span class="label">Fig. 2</span>. Illustration of (a) the encoder-decoder structure and (b) the bilateral architecture.</p></span></span></figure></div></section><section id="s0010"><h2 id="st020" class="u-h3 u-margin-l-top u-margin-xs-bottom">2. Related work</h2><section id="s0015"><h3 id="st025" class="u-h4 u-margin-m-top u-margin-xs-bottom">2.1. Context information extraction</h3><p id="p0030">Context is critically important for semantic segmentation and, thus, tremendous effort has been made to extract such information in an intelligent manner. The dilated or atrous convolution (<a name="bb0025" href="#b0025" class="workspace-trigger">Chen et al., 2014</a>, <a name="bb0335" href="#b0335" class="workspace-trigger">Yu and Koltun, 2015</a>) has been demonstrated to be an effective approach for enlarging receptive fields without shrinking spatial resolution. Besides, the encoder-decoder architecture (<a name="bb0245" href="#b0245" class="workspace-trigger">Ronneberger et al., 2015</a>), which merges high-level and low-level features via skip connections, is an alternative for extracting spatial context. Based on the encoder-decoder framework or dilation backbone, some research has focused on exploring the use of spatial pyramid pooling (SPP) (<a name="bb0095" href="#b0095" class="workspace-trigger">He et al., 2015</a><span>). For example, the pyramid pooling module (PPM) in <a href="/topics/computer-science/parsing" title="Learn more about PSPNet from ScienceDirect's AI-generated Topic Pages" class="topic-link">PSPNet</a> is composed of convolutions with kernels of four different sizes (</span><a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a>), while DeepLab v2 (<a name="bb0035" href="#b0035" class="workspace-trigger">Chen et al., 2018a</a><span>), equipped with the atrous spatial pyramid pooling (ASPP) module, groups parallel atrous <a href="/topics/computer-science/convolution-layer" title="Learn more about convolution layers from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolution layers</a> with varying dilation rates. However, certain limitations persist in SPP. Particularly, the SPP with the standard convolution faces a dilemma when expanding the receptive field with a large kernel size. The above operations are normally accompanied by a very large number of parameters. The SPP with small kernels (e.g. ASPP), on the other hand, lacks sufficient connection between adjacent features, and the gridding problem (</span><a name="bb0290" href="#b0290" class="workspace-trigger">Wang et al., 2018a</a><span>) occurs when the field is enlarged by a dilated <a href="/topics/computer-science/convolutional-layer" title="Learn more about convolutional layer from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolutional layer</a>. In contrast, the dot-product attention mechanism has the powerful ability to model long-range dependencies, which enables contextual information extraction at a global scale.</span></p></section><section id="s0020"><h3 id="st030" class="u-h4 u-margin-m-top u-margin-xs-bottom">2.2. Dot-Product attention mechanism</h3><div><p id="p0035">Let <em>H</em>, <em>W,</em> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-77-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>C</mi></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.766ex" height="2.095ex" viewBox="0 -794.4 760.5 902.1" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">C</mi></math></span></span><script type="math/mml" id="MathJax-Element-77"><math><mi is="true">C</mi></math></script></span> denote the height, weight, and channels of the input, respectively. The input feature is defined as <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-78-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>X</mi></mrow><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>=</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>[</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>x</mi></mrow><mn is=&quot;true&quot;>1</mn></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x22EF;</mo><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>x</mi></mrow></mrow><mi is=&quot;true&quot;>N</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>]</mo></mrow><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>C</mi></mrow></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.332ex" height="3.077ex" viewBox="0 -1005.7 11337.3 1324.7" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-58"></use></g></g><g is="true" transform="translate(1231,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2287,0)"><g is="true"><use xlink:href="#MJMAIN-5B"></use></g><g is="true" transform="translate(278,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-78"></use></g></g><g is="true" transform="translate(659,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1391,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1837,0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-22EF"></use></g><g is="true" transform="translate(1339,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1784,0)"><g is="true"><use xlink:href="#MJMATHBI-78"></use></g></g></g><g is="true" transform="translate(2443,-232)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(5009,0)"><use xlink:href="#MJMAIN-5D"></use></g></g><g is="true" transform="translate(7853,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(8798,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1178,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-43"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">[</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">x</mi></mrow><mn is="true">1</mn></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mo is="true">⋯</mo><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">x</mi></mrow></mrow><mi is="true">N</mi></msub><mo stretchy="true" is="true">]</mo></mrow><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><mi is="true">C</mi></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-78"><math><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">[</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">x</mi></mrow><mn is="true">1</mn></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mo is="true">⋯</mo><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">x</mi></mrow></mrow><mi is="true">N</mi></msub><mo stretchy="true" is="true">]</mo></mrow><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><mi is="true">C</mi></mrow></msup></mrow></math></script></span>, where <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-79-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>H</mi><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>W</mi></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.501ex" height="1.972ex" viewBox="0 -741.6 5382.5 849.3" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(1166,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2222,0)"><use xlink:href="#MJMATHI-48"></use></g><g is="true" transform="translate(3333,0)"><use xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(4334,0)"><use xlink:href="#MJMATHI-57"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">N</mi><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mi is="true">H</mi><mo is="true">×</mo><mi is="true">W</mi></mrow></math></span></span><script type="math/mml" id="MathJax-Element-79"><math><mrow is="true"><mi is="true">N</mi><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mi is="true">H</mi><mo is="true">×</mo><mi is="true">W</mi></mrow></math></script></span>. Initially, the dot-product attention mechanism utilizes three projected matrices <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-80-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>W</mi></mrow><mi is=&quot;true&quot;>q</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>x</mi></msub><mo is=&quot;true&quot;>&amp;#xD7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>k</mi></msub></mrow></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.878ex" height="3.077ex" viewBox="0 -952.9 5975.3 1324.7" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-57"></use></g></g><g is="true" transform="translate(1093,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-71"></use></g></g><g is="true" transform="translate(1796,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2742,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(942,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1493,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow><mi is="true">q</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">x</mi></msub><mo is="true">×</mo><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-80"><math><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow><mi is="true">q</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">x</mi></msub><mo is="true">×</mo><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></mrow></msup></mrow></math></script></span>, <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-81-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>W</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>x</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>D</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.978ex" height="2.709ex" viewBox="0 -952.9 6018.4 1166.2" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-57"></use></g></g><g is="true" transform="translate(1093,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1840,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2785,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(942,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g></g><g is="true" transform="translate(1136,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow><mi is="true">k</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">x</mi></msub><msub is="true"><mrow is="true"><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">k</mi></msub></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-81"><math><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow><mi is="true">k</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">x</mi></msub><msub is="true"><mrow is="true"><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">k</mi></msub></mrow></msup></mrow></math></script></span>, and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-82-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>W</mi></mrow><mi is=&quot;true&quot;>v</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>x</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>D</mi></mrow><mi is=&quot;true&quot;>v</mi></msub></mrow></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.877ex" height="2.709ex" viewBox="0 -952.9 5974.9 1166.2" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-57"></use></g></g><g is="true" transform="translate(1093,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-76"></use></g></g><g is="true" transform="translate(1814,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2759,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(942,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g></g><g is="true" transform="translate(1136,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-76"></use></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow><mi is="true">v</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">x</mi></msub><msub is="true"><mrow is="true"><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">v</mi></msub></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-82"><math><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow><mi is="true">v</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">x</mi></msub><msub is="true"><mrow is="true"><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">v</mi></msub></mrow></msup></mrow></math></script></span> to generate the corresponding <em>query</em> matrix <strong><em>Q</em></strong>, the <em>key</em> matrix <strong><em>K,</em></strong> and the <em>value</em> matrix <strong><em>V</em></strong>:<span class="display"><span id="e0005" class="formula"><span class="label">(1)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-83-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfenced open=&quot;{&quot; close=&quot;&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mtable is=&quot;true&quot;><mtr is=&quot;true&quot;><mtd is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>Q</mi><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>W</mi></mrow></mrow><mi is=&quot;true&quot;>q</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>D</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></msup><mo is=&quot;true&quot;>;</mo></mrow></mtd></mtr><mtr is=&quot;true&quot;><mtd is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>K</mi><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>W</mi></mrow></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>&amp;#xD7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>k</mi></msub></mrow></msup><mo is=&quot;true&quot;>;</mo></mrow></mtd></mtr><mtr is=&quot;true&quot;><mtd is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>V</mi><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>W</mi></mrow></mrow><mi is=&quot;true&quot;>v</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>&amp;#xD7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>v</mi></msub></mrow></msup><mo is=&quot;true&quot;>.</mo></mrow></mtd></mtr></mtable></mrow></mrow></mfenced></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="24.082ex" height="10.193ex" viewBox="0 -2432.1 10368.7 4388.8" role="img" focusable="false" style="vertical-align: -4.545ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g transform="translate(0,2366)"><use xlink:href="#MJSZ4-23A7" x="0" y="-900"></use><g transform="translate(0,-1241.9837804934461) scale(1,1.2250282330978974)"><use xlink:href="#MJSZ4-23AA"></use></g><use xlink:href="#MJSZ4-23A8" x="0" y="-2367"></use><g transform="translate(0,-3358.442871550969) scale(1,1.2250282330978974)"><use xlink:href="#MJSZ4-23AA"></use></g><use xlink:href="#MJSZ4-23A9" x="0" y="-3333"></use></g><g is="true" transform="translate(889,0)"><g is="true"><g is="true" transform="translate(167,0)"><g transform="translate(-15,0)"><g is="true" transform="translate(70,1471)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-51"></use></g><g is="true" transform="translate(1069,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2125,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-58"></use></g></g><g is="true" transform="translate(953,0)"><g is="true"><use xlink:href="#MJMATHBI-57"></use></g></g></g><g is="true" transform="translate(2047,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-71"></use></g></g><g is="true" transform="translate(4875,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(5821,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g></g><g is="true" transform="translate(1136,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g><g is="true" transform="translate(8739,0)"><use xlink:href="#MJMAIN-3B"></use></g></g></g><g is="true" transform="translate(0,-142)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(1167,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2223,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-58"></use></g></g><g is="true" transform="translate(953,0)"><g is="true"><use xlink:href="#MJMATHBI-57"></use></g></g></g><g is="true" transform="translate(2047,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(5017,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(5962,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1178,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g><g is="true" transform="translate(8880,0)"><use xlink:href="#MJMAIN-3B"></use></g></g></g><g is="true" transform="translate(81,-1667)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-56"></use></g><g is="true" transform="translate(1047,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2103,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-58"></use></g></g><g is="true" transform="translate(953,0)"><g is="true"><use xlink:href="#MJMATHBI-57"></use></g></g></g><g is="true" transform="translate(2047,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-76"></use></g></g><g is="true" transform="translate(4871,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(5816,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1178,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-76"></use></g></g></g></g><g is="true" transform="translate(8717,0)"><use xlink:href="#MJMAIN-2E"></use></g></g></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfenced open="{" close="" is="true"><mrow is="true"><mrow is="true"><mtable is="true"><mtr is="true"><mtd is="true"><mrow is="true"><mi is="true">Q</mi><mo is="true">=</mo><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow></mrow><mi is="true">q</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><msub is="true"><mrow is="true"><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">k</mi></msub></mrow></msup><mo is="true">;</mo></mrow></mtd></mtr><mtr is="true"><mtd is="true"><mrow is="true"><mi is="true">K</mi><mo is="true">=</mo><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow></mrow><mi is="true">k</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></mrow></msup><mo is="true">;</mo></mrow></mtd></mtr><mtr is="true"><mtd is="true"><mrow is="true"><mi is="true">V</mi><mo is="true">=</mo><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow></mrow><mi is="true">v</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><msub is="true"><mi is="true">D</mi><mi is="true">v</mi></msub></mrow></msup><mo is="true">.</mo></mrow></mtd></mtr></mtable></mrow></mrow></mfenced></math></span></span><script type="math/mml" id="MathJax-Element-83"><math><mfenced open="{" close="" is="true"><mrow is="true"><mrow is="true"><mtable is="true"><mtr is="true"><mtd is="true"><mrow is="true"><mi is="true">Q</mi><mo is="true">=</mo><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow></mrow><mi is="true">q</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><msub is="true"><mrow is="true"><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">k</mi></msub></mrow></msup><mo is="true">;</mo></mrow></mtd></mtr><mtr is="true"><mtd is="true"><mrow is="true"><mi is="true">K</mi><mo is="true">=</mo><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow></mrow><mi is="true">k</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></mrow></msup><mo is="true">;</mo></mrow></mtd></mtr><mtr is="true"><mtd is="true"><mrow is="true"><mi is="true">V</mi><mo is="true">=</mo><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">X</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">W</mi></mrow></mrow><mi is="true">v</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><msub is="true"><mi is="true">D</mi><mi is="true">v</mi></msub></mrow></msup><mo is="true">.</mo></mrow></mtd></mtr></mtable></mrow></mrow></mfenced></math></script></span></span></span><span>The <a href="/topics/computer-science/graphical-representation" title="Learn more about graphical representation from ScienceDirect's AI-generated Topic Pages" class="topic-link">graphical representation</a> of the dot-product attention mechanism can be seen in </span><a name="bf0015" href="#f0015" class="workspace-trigger">Fig. 3</a>. The dimensions of <strong><em>Q</em></strong> and <strong><em>K</em></strong> are identical, and all vectors in this section are column vectors by default. Accordingly, a normalization function <em>ρ</em> is employed to measure the similarity between the <em>i</em>-th <em>query</em> feature <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-84-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>k</mi></msub></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.555ex" height="3.077ex" viewBox="0 -952.9 4114 1324.7" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(552,345)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(542,-304)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(1428,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2374,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-84"><math><mrow is="true"><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></msup></mrow></math></script></span> and the <em>j</em>-th <em>key</em> feature <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-85-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>k</mi></msub></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.195ex" height="3.077ex" viewBox="0 -952.9 3959 1324.7" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(1273,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2219,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-85"><math><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub></msup></mrow></math></script></span> as <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-86-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C1;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mn is=&quot;true&quot;>1</mn></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.474ex" height="3.199ex" viewBox="0 -952.9 7092.9 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C1"></use></g><g is="true" transform="translate(684,0)"><use xlink:href="#MJSZ1-28" is="true"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(552,345)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(542,-304)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(1831,0)"><use xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(2554,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><use xlink:href="#MJSZ1-29" is="true" x="3550" y="-1"></use></g><g is="true" transform="translate(4971,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(5916,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">ρ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mn is="true">1</mn></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-86"><math><mrow is="true"><mi is="true">ρ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mn is="true">1</mn></msup></mrow></math></script></span>. As the <em>query</em> feature and <em>key</em> feature are generated via different layers, the similarities between <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-87-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C1;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.514ex" height="3.199ex" viewBox="0 -952.9 4526.7 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C1"></use></g><use xlink:href="#MJSZ1-28" is="true" x="517" y="-1"></use><g is="true" transform="translate(976,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(552,345)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(542,-304)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(2349,0)"><use xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(3072,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><use xlink:href="#MJSZ1-29" is="true" x="4068" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">ρ</mi><mo stretchy="true" is="true">(</mo><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-87"><math><mrow is="true"><mi is="true">ρ</mi><mo stretchy="true" is="true">(</mo><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-88-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C1;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.049ex" height="4.549ex" viewBox="0 -1217.1 4757.4 1958.7" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C1"></use></g><use xlink:href="#MJSZ2-28" is="true" x="517" y="-1"></use><g is="true" transform="translate(1115,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(552,345)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(542,-304)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(2488,0)"><use xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(3211,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><use xlink:href="#MJSZ2-29" is="true" x="4159" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">ρ</mi><mo stretchy="true" is="true">(</mo><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-88"><math><mrow is="true"><mi is="true">ρ</mi><mo stretchy="true" is="true">(</mo><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow></math></script></span> are not identical. Therefore, the <em>N</em>&nbsp;×&nbsp;<em>N</em> <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-89-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.762ex" height="2.831ex" viewBox="0 -952.9 2480.8 1219.1" role="img" focusable="false" style="vertical-align: -0.618ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-89"><math><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></math></script></span><span> matrix model the long-range dependency between each pixel pair in the <a href="/topics/computer-science/input-feature-map" title="Learn more about input feature maps from ScienceDirect's AI-generated Topic Pages" class="topic-link">input feature maps</a>, where the pixel at </span><em>j-</em>th row and <em>i-</em>th column measures the <em>i-</em>th position’s impact on <em>j-</em>th position. In other words, the long-range global contextual information between every pixel of the input can be fully modeled by the <em>N</em>&nbsp;×&nbsp;<em>N</em> matrix <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-90-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.762ex" height="2.831ex" viewBox="0 -952.9 2480.8 1219.1" role="img" focusable="false" style="vertical-align: -0.618ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-90"><math><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></math></script></span>. By calculating similarities between all pairs of pixels in the input feature maps and taking the similarities as weights, the dot-product attention mechanism generates the <em>value</em> at position <em>i</em> by aggregating the <em>value</em> features from all positions using weighted summation:<span class="display"><span id="e0010" class="formula"><span class="label">(2)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-91-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>&amp;#x3C1;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></mfenced><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow><mo is=&quot;true&quot;>.</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="26.463ex" height="3.199ex" viewBox="0 -952.9 11393.9 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g><g is="true" transform="translate(5257,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6313,0)"><use xlink:href="#MJMATHI-3C1"></use></g><g is="true" transform="translate(6831,0)"><use xlink:href="#MJSZ1-28"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g><use xlink:href="#MJSZ1-29" x="2939" y="-1"></use></g><g is="true" transform="translate(10228,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g><g is="true" transform="translate(11115,0)"><use xlink:href="#MJMAIN-2E"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mi is="true">ρ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow><mo is="true">.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-91"><math><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mi is="true">ρ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow><mo is="true">.</mo></mrow></math></script></span></span></span></p><figure class="figure text-xs" id="f0015"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr3.jpg" height="287" alt="" aria-describedby="cn0015"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr3_lrg.jpg" target="_blank" download="" title="Download high-res image (94KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (94KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr3.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0015"><p id="sp0020"><span class="label">Fig. 3</span>. Illustration of the calculation of dot-product attention mechanism.</p></span></span></figure></div><p id="p0040">Softmax is frequently used as the normalization function:<span class="display"><span id="e0015" class="formula"><span class="label">(3)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-92-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C1;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>softmax</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>row</mi></mrow></msub><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></mfenced><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.83ex" height="3.199ex" viewBox="0 -952.9 13704.6 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C1"></use></g><g is="true" transform="translate(517,0)"><use xlink:href="#MJSZ1-28"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g><use xlink:href="#MJSZ1-29" x="2939" y="-1"></use></g><g is="true" transform="translate(3915,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(4971,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-73"></use><use xlink:href="#MJMATHI-6F" x="469" y="0"></use><use xlink:href="#MJMATHI-66" x="955" y="0"></use><use xlink:href="#MJMATHI-74" x="1445" y="0"></use><use xlink:href="#MJMATHI-6D" x="1807" y="0"></use><use xlink:href="#MJMATHI-61" x="2685" y="0"></use><use xlink:href="#MJMATHI-78" x="3215" y="0"></use></g></g><g is="true" transform="translate(3787,-242)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-77" x="937" y="0"></use></g></g></g><g is="true" transform="translate(10028,0)"><use xlink:href="#MJSZ1-28"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g><use xlink:href="#MJSZ1-29" x="2939" y="-1"></use></g><g is="true" transform="translate(13426,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">ρ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">softmax</mi></mrow><mrow is="true"><mi mathvariant="italic" is="true">row</mi></mrow></msub><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-92"><math><mrow is="true"><mi is="true">ρ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">softmax</mi></mrow><mrow is="true"><mi mathvariant="italic" is="true">row</mi></mrow></msub><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced><mo is="true">,</mo></mrow></math></script></span></span></span></p><p id="p0045">where <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-93-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>softmax</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>row</mi></mrow></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.745ex" height="2.581ex" viewBox="0 -792.8 5056.7 1111.1" role="img" focusable="false" style="vertical-align: -0.739ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-73"></use><use xlink:href="#MJMATHI-6F" x="469" y="0"></use><use xlink:href="#MJMATHI-66" x="955" y="0"></use><use xlink:href="#MJMATHI-74" x="1445" y="0"></use><use xlink:href="#MJMATHI-6D" x="1807" y="0"></use><use xlink:href="#MJMATHI-61" x="2685" y="0"></use><use xlink:href="#MJMATHI-78" x="3215" y="0"></use></g></g><g is="true" transform="translate(3787,-242)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-77" x="937" y="0"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">softmax</mi></mrow><mrow is="true"><mi mathvariant="italic" is="true">row</mi></mrow></msub></math></span></span><script type="math/mml" id="MathJax-Element-93"><math><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">softmax</mi></mrow><mrow is="true"><mi mathvariant="italic" is="true">row</mi></mrow></msub></math></script></span> indicates that the softmax along each row of the matrix <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-94-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.762ex" height="2.826ex" viewBox="0 -951 2480.8 1216.6" role="img" focusable="false" style="vertical-align: -0.617ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-94"><math><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></math></script></span>.</p><div><p id="p0050">By modeling the similarities between each pair of positions of the input, the global dependencies in the features can be extracted thoroughly by <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-95-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C1;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow></mfenced></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.094ex" height="3.193ex" viewBox="0 -951 3915.3 1374.7" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C1"></use></g><g is="true" transform="translate(517,0)"><use xlink:href="#MJSZ1-28"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g><use xlink:href="#MJSZ1-29" x="2939" y="-1"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">ρ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced></mrow></math></span></span><script type="math/mml" id="MathJax-Element-95"><math><mrow is="true"><mi is="true">ρ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></mrow></mfenced></mrow></math></script></span>. The dot-product attention mechanism was initially designed for machine translation (<a name="bb0275" href="#b0275" class="workspace-trigger">Vaswani et al., 2017</a>), while the non-local module (<a name="bb0300" href="#b0300" class="workspace-trigger">Wang et al., 2018b</a>) was introduced and modified for computer vision (<a name="bf0020" href="#f0020" class="workspace-trigger">Fig. 4</a><span>). Based on the dot-product attention mechanism, as well as its variants, different attention-based networks have been proposed to address the semantic <a href="/topics/computer-science/segmentation-task" title="Learn more about segmentation task from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation task</a>. Inspired by the non-local module (</span><a name="bb0300" href="#b0300" class="workspace-trigger">Wang et al., 2018b</a><span>), the double <a href="/topics/computer-science/attention-network" title="Learn more about attention networks from ScienceDirect's AI-generated Topic Pages" class="topic-link">attention networks</a> (</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-96-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>A</mi></mrow><mn is=&quot;true&quot;>2</mn></msup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.797ex" height="2.581ex" viewBox="0 -1003.7 1204.4 1111.1" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-41"></use></g></g><g is="true" transform="translate(750,443)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mi is="true">A</mi></mrow><mn is="true">2</mn></msup></math></span></span><script type="math/mml" id="MathJax-Element-96"><math><msup is="true"><mrow is="true"><mi is="true">A</mi></mrow><mn is="true">2</mn></msup></math></script></span>-Net) (<a name="bb0045" href="#b0045" class="workspace-trigger">Chen et al., 2018b</a>), dual attention network (DANet) (<a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a>), and object context network (OCNet) (<a name="bb0345" href="#b0345" class="workspace-trigger">Yuan and Wang, 2018</a>) were proposed successively for scene segmentation by exploring the long-range dependencies. Furthermore, <a name="bb0015" href="#b0015" class="workspace-trigger">Bello et al. (2019)</a> augmented convolutional operators with attention mechanisms, while <a name="bb0365" href="#b0365" class="workspace-trigger">Zhang et al. (2019c)</a><span> incorporated the attention mechanism into the <a href="/topics/computer-science/generative-adversarial-networks" title="Learn more about generative adversarial network from ScienceDirect's AI-generated Topic Pages" class="topic-link">generative adversarial network</a>. </span><a name="bb0200" href="#b0200" class="workspace-trigger">Lu et al. (2019)</a> extended the attention mechanism to CO-attention Siamese Network (COSNet) for unsupervised video object segmentation. Recently, <a name="bb0055" href="#b0055" class="workspace-trigger">Diakogiannis et al. (2020a)</a> improved the attention mechanism and proposed the fractal Tanimoto attention layer for semantic change detection.</p><figure class="figure text-xs" id="f0020"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr4.jpg" height="184" alt="" aria-describedby="cn0020"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr4_lrg.jpg" target="_blank" download="" title="Download high-res image (141KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (141KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr4.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0020"><p id="sp0025"><span class="label">Fig. 4</span>. Illustration of the dot-product attention mechanism utilized in computer vision.</p></span></span></figure></div><p id="p0055">Although the introduction of attention boosts segmentation accuracy significantly, the huge resource-demand of the dot-product hinders its application to large inputs. Specifically, for <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-97-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>D</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="11.639ex" height="2.831ex" viewBox="0 -952.9 5011.1 1219.1" role="img" focusable="false" style="vertical-align: -0.618ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(1147,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2092,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1178,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g></g><g is="true" transform="translate(1764,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><msub is="true"><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">k</mi></msub></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-97"><math><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><msub is="true"><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><mi is="true">D</mi></mrow><mi is="true">k</mi></msub></msup></mrow></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-98-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>N</mi></mrow></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.362ex" height="2.463ex" viewBox="0 -952.9 5752.9 1060.6" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(1889,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2834,0)"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(585,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(917,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1467,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub><mo is="true">×</mo><mi is="true">N</mi></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-98"><math><mrow is="true"><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup><mo is="true">∈</mo><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub><mo is="true">×</mo><mi is="true">N</mi></mrow></msup></mrow></math></script></span>, the product between <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-99-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.019ex" height="2.463ex" viewBox="0 -794.4 869.5 1060.6" role="img" focusable="false" style="vertical-align: -0.618ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow></math></span></span><script type="math/mml" id="MathJax-Element-99"><math><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-100-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow><mi is=&quot;true&quot;>T</mi></msup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.742ex" height="2.463ex" viewBox="0 -952.9 1611.3 1060.6" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><g is="true" transform="translate(1013,413)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></math></span></span><script type="math/mml" id="MathJax-Element-100"><math><msup is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow><mi is="true">T</mi></msup></math></script></span> belongs to <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-101-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>&amp;#xD7;</mo><mi is=&quot;true&quot;>N</mi></mrow></msup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.107ex" height="2.463ex" viewBox="0 -952.9 2629.5 1060.6" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJAMS-52"></use></g></g><g is="true" transform="translate(722,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(1178,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><mi is="true">N</mi></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-101"><math><msup is="true"><mrow is="true"><mi mathvariant="double-struck" is="true">R</mi></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">×</mo><mi is="true">N</mi></mrow></msup></math></script></span>, leading to <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-102-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>O</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi></mrow><mn is=&quot;true&quot;>2</mn></msup><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.08ex" height="3.199ex" viewBox="0 -952.9 3048.5 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use></g><use xlink:href="#MJSZ1-28" is="true" x="763" y="-1"></use><g is="true" transform="translate(1222,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(914,410)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g><use xlink:href="#MJSZ1-29" is="true" x="2589" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><msup is="true"><mrow is="true"><mi is="true">N</mi></mrow><mn is="true">2</mn></msup><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-102"><math><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><msup is="true"><mrow is="true"><mi is="true">N</mi></mrow><mn is="true">2</mn></msup><mo stretchy="true" is="true">)</mo></mrow></math></script></span> memory and computational complexity. Consequently, it is necessary to reduce the demand for computational resources of the dot-product attention mechanism. Substantial endeavors have been poured in aiming to alleviate the bottleneck to efficiency and push the boundaries of attention, including accelerating the generation process of the attention matrix (<a name="bb0115" href="#b0115" class="workspace-trigger">Huang et al., 2019a</a>, <a name="bb0120" href="#b0120" class="workspace-trigger">Huang et al., 2019b</a>, <a name="bb0340" href="#b0340" class="workspace-trigger">Yuan et al., 2019</a>, <a name="bb0360" href="#b0360" class="workspace-trigger">Zhang et al., 2019b</a>), pruning the structure of the attention block (<a name="bb0020" href="#b0020" class="workspace-trigger">Cao et al., 2019</a>), and optimizing attention based on low-rank reconstruction (<a name="bb0180" href="#b0180" class="workspace-trigger">Li et al., 2019c</a>).</p></section><section id="s0025"><h3 id="st035" class="u-h4 u-margin-m-top u-margin-xs-bottom">2.3. Generalization and simplification of the dot-product attention mechanism</h3><p id="p0060">If the normalization function is set as softmax, the <em>i</em>-th row of the result matrix generated by the dot-product attention mechanism can be written as:<span class="display"><span id="e0020" class="formula"><span class="label">(4)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-103-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>i</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>e</mi></mrow><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></msup><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>e</mi></mrow><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></msup></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.308ex" height="6.39ex" viewBox="0 -1639.7 12188.2 2751.1" role="img" focusable="false" style="vertical-align: -2.581ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g></g><g is="true" transform="translate(5257,-287)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(5879,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6657,0)"><g transform="translate(397,0)"><rect stroke="none" width="4734" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,714)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g></g><g is="true" transform="translate(329,337)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(494,181)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(896,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(1146,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g><g is="true" transform="translate(3935,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(399,-730)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g></g><g is="true" transform="translate(329,337)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(494,144)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(896,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(1146,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></g></g></g><g is="true" transform="translate(11909,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-103"><math><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span></p><p id="p0065">where <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-104-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.228ex" height="2.095ex" viewBox="0 -530.3 959.2 902.1" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(567,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-104"><math><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></math></script></span> is <em>j</em>-th <em>value</em> feature.</p><p id="p0070">Eq. <a name="be0020" href="#e0020" class="workspace-trigger">(4)</a> can be rewritten and generalized to any normalization function as:<span class="display"><span id="e0025" class="formula"><span class="label">(5)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-105-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mtable is=&quot;true&quot;><mtr is=&quot;true&quot;><mtd is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>s</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>i</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>s</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>i</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></mtd></mtr><mtr is=&quot;true&quot;><mtd is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>s</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>i</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced><mo is=&quot;true&quot;>&amp;#x2265;</mo><mn is=&quot;true&quot;>0</mn><mo is=&quot;true&quot;>.</mo></mrow></mtd></mtr></mtable></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="31.464ex" height="9.212ex" viewBox="0 -2220.8 13546.9 3966.2" role="img" focusable="false" style="vertical-align: -4.054ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true" transform="translate(167,0)"><g transform="translate(-15,0)"><g is="true" transform="translate(0,762)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g></g><g is="true" transform="translate(5257,-287)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(5879,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6657,0)"><g transform="translate(397,0)"><rect stroke="none" width="5772" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,714)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-73"></use></g><g is="true" transform="translate(2109,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-69"></use></g><g is="true" transform="translate(2306,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-6D"></use></g><g is="true" transform="translate(2895,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(627,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(823,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2550" y="0"></use></g><g is="true" transform="translate(4974,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(399,-590)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-73"></use></g><g is="true" transform="translate(2109,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-69"></use></g><g is="true" transform="translate(2306,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-6D"></use></g><g is="true" transform="translate(2895,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(627,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(823,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="2550" y="0"></use></g></g></g></g><g is="true" transform="translate(12948,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g><g is="true" transform="translate(3389,-1362)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-73"></use></g><g is="true" transform="translate(394,0)"><use xlink:href="#MJMAIN-69"></use></g><g is="true" transform="translate(673,0)"><use xlink:href="#MJMAIN-6D"></use></g><g is="true" transform="translate(1506,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(886,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1331,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><use xlink:href="#MJMAIN-29" x="2717" y="0"></use></g><g is="true" transform="translate(4613,0)"><use xlink:href="#MJMAIN-2265"></use></g><g is="true" transform="translate(5669,0)"><use xlink:href="#MJMAIN-30"></use></g><g is="true" transform="translate(6170,0)"><use xlink:href="#MJMAIN-2E"></use></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mtable is="true"><mtr is="true"><mtd is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced></mrow></mfrac><mo is="true">,</mo></mrow></mtd></mtr><mtr is="true"><mtd is="true"><mrow is="true"><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo is="true">≥</mo><mn is="true">0</mn><mo is="true">.</mo></mrow></mtd></mtr></mtable></mrow></math></span></span><script type="math/mml" id="MathJax-Element-105"><math><mrow is="true"><mtable is="true"><mtr is="true"><mtd is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced></mrow></mfrac><mo is="true">,</mo></mrow></mtd></mtr><mtr is="true"><mtd is="true"><mrow is="true"><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo is="true">≥</mo><mn is="true">0</mn><mo is="true">.</mo></mrow></mtd></mtr></mtable></mrow></math></script></span></span></span></p><p id="p0075"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-106-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>s</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>i</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.716ex" height="2.831ex" viewBox="0 -847.3 4613.7 1219.1" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-73"></use></g><g is="true" transform="translate(394,0)"><use xlink:href="#MJMAIN-69"></use></g><g is="true" transform="translate(673,0)"><use xlink:href="#MJMAIN-6D"></use></g><g is="true" transform="translate(1506,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(886,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1331,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><use xlink:href="#MJMAIN-29" x="2717" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced></mrow></math></span></span><script type="math/mml" id="MathJax-Element-106"><math><mrow is="true"><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced></mrow></math></script></span> can be expanded as <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-107-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mi is=&quot;true&quot;>T</mi></msup><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="12.674ex" height="3.322ex" viewBox="0 -1058.6 5456.8 1430.4" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(596,0)"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(986,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1872,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(2262,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(2860,0)"><use xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(3681,0)"><use xlink:href="#MJMAIN-28" is="true"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><use xlink:href="#MJMAIN-29" is="true" x="1385" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-107"><math><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></math></script></span> which measures the similarity between <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-108-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.06ex" height="1.972ex" viewBox="0 -530.3 886.8 849.3" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-108"><math><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-109-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.314ex" height="2.709ex" viewBox="0 -794.4 996.2 1166.2" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-109"><math><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></math></script></span>, and Eq. <a name="be0020" href="#e0020" class="workspace-trigger">(4)</a> can be rewritten as Eq. <a name="be0030" href="#e0030" class="workspace-trigger">(6)</a> and simplified as Eq. <a name="be0035" href="#e0035" class="workspace-trigger">(7)</a>:<span class="display"><span id="e0030" class="formula"><span class="label">(6)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-110-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>i</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mi is=&quot;true&quot;>T</mi></msup><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mi is=&quot;true&quot;>T</mi></msup><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.106ex" height="5.653ex" viewBox="0 -1481.2 13823.3 2434.1" role="img" focusable="false" style="vertical-align: -2.213ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g></g><g is="true" transform="translate(5257,-287)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(5879,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6657,0)"><g transform="translate(397,0)"><rect stroke="none" width="6369" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,714)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(421,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(697,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1324,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(1599,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(3852,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(4315,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" is="true"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" is="true" x="1385" y="0"></use></g><g is="true" transform="translate(5570,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(399,-590)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(421,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(697,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1324,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(1599,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(3852,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(4315,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" is="true"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" is="true" x="1385" y="0"></use></g></g></g></g><g is="true" transform="translate(13544,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-110"><math><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span><span class="display"><span id="e0035" class="formula"><span class="label">(7)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-111-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>i</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mi is=&quot;true&quot;>T</mi></msup><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup></mrow><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mi is=&quot;true&quot;>T</mi></msup><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></mrow></mfrac><mo is=&quot;true&quot;>.</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="33.475ex" height="5.653ex" viewBox="0 -1481.2 14412.9 2434.1" role="img" focusable="false" style="vertical-align: -2.213ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g></g><g is="true" transform="translate(5257,-287)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(5879,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6657,0)"><g transform="translate(397,0)"><rect stroke="none" width="6958" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,714)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(421,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(697,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1324,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(1599,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(2189,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(4019,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(4482,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" is="true"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" is="true" x="1385" y="0"></use></g><g is="true" transform="translate(5737,0)"><g is="true"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(678,256)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g></g><g is="true" transform="translate(610,-590)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(421,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(697,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1324,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(1599,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(2189,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(4019,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(4482,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" is="true"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" is="true" x="1385" y="0"></use></g></g></g></g><g is="true" transform="translate(14134,0)"><use xlink:href="#MJMAIN-2E"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mi is="true">T</mi></msup></mrow><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></mfrac><mo is="true">.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-111"><math><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub></mrow><mi is="true">T</mi></msup></mrow><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></mfrac><mo is="true">.</mo></mrow></math></script></span></span></span></p><p id="p0080">I<span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-112-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>f</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>s</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>i</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>=</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>e</mi></mrow><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></msup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.247ex" height="3.322ex" viewBox="0 -1058.6 8717.3 1430.4" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-66"></use></g><g is="true" transform="translate(372,0)"><use xlink:href="#MJMAIN-73"></use></g><g is="true" transform="translate(767,0)"><use xlink:href="#MJMAIN-69"></use></g><g is="true" transform="translate(1045,0)"><use xlink:href="#MJMAIN-6D"></use></g><g is="true" transform="translate(1879,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(886,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1331,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><use xlink:href="#MJMAIN-29" x="2717" y="0"></use></g><g is="true" transform="translate(4986,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6042,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-65"></use></g></g><g is="true" transform="translate(466,362)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(627,256)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(1050,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(1403,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="normal" is="true">f</mi><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-112"><math><mrow is="true"><mi mathvariant="normal" is="true">f</mi><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup></mrow></math></script></span>, Eq. <a name="be0025" href="#e0025" class="workspace-trigger">(5)</a> is equivalent to Eq. <a name="be0020" href="#e0020" class="workspace-trigger">(4)</a>. The vectorized form of Eq. <a name="be0035" href="#e0035" class="workspace-trigger">(7)</a> is:<span class="display"><span id="e0040" class="formula"><span class="label">(8)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-113-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow></mrow></mfenced><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>T</mi></msup><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow></mrow></mfenced><msub is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mi is=&quot;true&quot;>j</mi></msub><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mo is=&quot;true&quot;>,</mo><mi is=&quot;true&quot;>j</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup></mrow></mfrac></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="27.323ex" height="5.285ex" viewBox="0 -1322.7 11763.9 2275.6" role="img" focusable="false" style="vertical-align: -2.213ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g><g is="true" transform="translate(5257,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6035,0)"><g transform="translate(397,0)"><rect stroke="none" width="5210" height="60" x="0" y="220"></rect><g is="true" transform="translate(424,586)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(421,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-51"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="1259" y="0"></use></g><g is="true" transform="translate(1587,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(462,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-4B"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="1393" y="0"></use></g></g><g is="true" transform="translate(1723,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(3733,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-56"></use></g></g></g><g is="true" transform="translate(60,-587)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(421,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-51"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="1259" y="0"></use></g><g is="true" transform="translate(1587,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,-203)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(2778,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(462,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-4B"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJMAIN-29" x="1393" y="0"></use></g></g><g is="true" transform="translate(1723,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(1723,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(172,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(312,0)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><mi is="true">ϕ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow></mrow></mfenced><msup is="true"><mrow is="true"><mi is="true">φ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow></mfenced></mrow><mi is="true">T</mi></msup><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow><mrow is="true"><mi is="true">ϕ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow></mrow></mfenced><msub is="true"><mo is="true">∑</mo><mi is="true">j</mi></msub><msubsup is="true"><mrow is="true"><mi is="true">φ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow></mfenced></mrow><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow></mfrac></mrow></math></span></span><script type="math/mml" id="MathJax-Element-113"><math><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><mi is="true">ϕ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow></mrow></mfenced><msup is="true"><mrow is="true"><mi is="true">φ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow></mfenced></mrow><mi is="true">T</mi></msup><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow><mrow is="true"><mi is="true">ϕ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow></mrow></mfenced><msub is="true"><mo is="true">∑</mo><mi is="true">j</mi></msub><msubsup is="true"><mrow is="true"><mi is="true">φ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow></mfenced></mrow><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow></mfrac></mrow></math></script></span></span></span></p><p id="p0085"><span>As the <a href="/topics/computer-science/softmax-function" title="Learn more about softmax function from ScienceDirect's AI-generated Topic Pages" class="topic-link">softmax function</a> is substituted for </span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-114-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>s</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>i</mi><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>=</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow><mi is=&quot;true&quot;>T</mi></msup><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.843ex" height="3.322ex" viewBox="0 -1058.6 11126.7 1430.4" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-73"></use></g><g is="true" transform="translate(394,0)"><use xlink:href="#MJMAIN-69"></use></g><g is="true" transform="translate(673,0)"><use xlink:href="#MJMAIN-6D"></use></g><g is="true" transform="translate(1506,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(886,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1331,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><use xlink:href="#MJMAIN-29" x="2717" y="0"></use></g><g is="true" transform="translate(4613,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(5669,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(596,0)"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(986,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1872,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(2262,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(8530,0)"><use xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(9351,0)"><use xlink:href="#MJMAIN-28" is="true"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><use xlink:href="#MJMAIN-29" is="true" x="1385" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-114"><math><mrow is="true"><mi mathvariant="normal" is="true">s</mi><mi mathvariant="normal" is="true">i</mi><mi mathvariant="normal" is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><msup is="true"><mrow is="true"><mi is="true">ϕ</mi><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo stretchy="true" is="true">)</mo></mrow><mi is="true">T</mi></msup><mi is="true">φ</mi><mrow is="true"><mo stretchy="true" is="true">(</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo stretchy="true" is="true">)</mo></mrow></mrow></math></script></span>, the order of the commutative operation can be altered, thereby avoiding multiplication between the reshaped <em>key</em> matrix <strong><em>K</em></strong> and <em>query</em> matrix <strong><em>Q</em></strong>. In concrete terms, we can first compute the multiplication between <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-115-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>T</mi></msup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.049ex" height="3.199ex" viewBox="0 -1058.6 3035.2 1377.5" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(654,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g></g><use xlink:href="#MJMAIN-29" x="1393" y="0"></use></g></g><g is="true" transform="translate(2437,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mi is="true">φ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow></mfenced></mrow><mi is="true">T</mi></msup></math></span></span><script type="math/mml" id="MathJax-Element-115"><math><msup is="true"><mrow is="true"><mi is="true">φ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow></mrow></mfenced></mrow><mi is="true">T</mi></msup></math></script></span> and <strong><em>V</em></strong>, and then multiply the result with <strong><em>Q</em></strong>, leading to only <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-116-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>O</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>d</mi><mi is=&quot;true&quot;>N</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.862ex" height="2.709ex" viewBox="0 -847.3 2954.5 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use></g><g is="true" transform="translate(763,0)"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(1153,0)"><use xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(1676,0)"><use xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(2565,0)"><use xlink:href="#MJMAIN-29"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><mi is="true">d</mi><mi is="true">N</mi><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-116"><math><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><mi is="true">d</mi><mi is="true">N</mi><mo stretchy="true" is="true">)</mo></mrow></math></script></span> time complexity and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-117-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>O</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>d</mi><mi is=&quot;true&quot;>N</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.862ex" height="2.709ex" viewBox="0 -847.3 2954.5 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use></g><g is="true" transform="translate(763,0)"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(1153,0)"><use xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(1676,0)"><use xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(2565,0)"><use xlink:href="#MJMAIN-29"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><mi is="true">d</mi><mi is="true">N</mi><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-117"><math><mrow is="true"><mi is="true">O</mi><mo stretchy="true" is="true">(</mo><mi is="true">d</mi><mi is="true">N</mi><mo stretchy="true" is="true">)</mo></mrow></math></script></span> space complexity. The suitable <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-118-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3D5;</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2219;</mo></mrow></mfenced></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.357ex" height="2.709ex" viewBox="0 -847.3 1876 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3D5"></use></g><g is="true" transform="translate(596,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMAIN-2219"></use></g></g><use xlink:href="#MJMAIN-29" x="890" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">ϕ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mo is="true">∙</mo></mrow></mfenced></mrow></math></span></span><script type="math/mml" id="MathJax-Element-118"><math><mrow is="true"><mi is="true">ϕ</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mo is="true">∙</mo></mrow></mfenced></mrow></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-119-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C6;</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mo is=&quot;true&quot;>&amp;#x2219;</mo><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.492ex" height="2.709ex" viewBox="0 -847.3 1934 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C6"></use></g><g is="true" transform="translate(654,0)"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(1044,0)"><use xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(1544,0)"><use xlink:href="#MJMAIN-29"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">φ</mi><mo stretchy="true" is="true">(</mo><mo is="true">∙</mo><mo stretchy="true" is="true">)</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-119"><math><mrow is="true"><mi is="true">φ</mi><mo stretchy="true" is="true">(</mo><mo is="true">∙</mo><mo stretchy="true" is="true">)</mo></mrow></math></script></span> enable the above scheme to achieve competitive performance with finite computational complexity (<a name="bb0135" href="#b0135" class="workspace-trigger">Katharopoulos et al., 2020</a>, <a name="bb0170" href="#b0170" class="workspace-trigger">Li et al., 2021c</a>).</p></section><section id="s0030"><h3 id="st040" class="u-h4 u-margin-m-top u-margin-xs-bottom">2.4. Linear attention mechanism</h3><p id="p0090">In our previous research (<a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a><span>), we proposed a linear attention mechanism to replace the softmax function with the first-order approximation of the <a href="/topics/computer-science/taylor-expansion" title="Learn more about Taylor expansion from ScienceDirect's AI-generated Topic Pages" class="topic-link">Taylor expansion</a>, as in Eq. </span><a name="be0045" href="#e0045" class="workspace-trigger">(9)</a>:<span class="display"><span id="e0045" class="formula"><span class="label">(9)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-120-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>e</mi></mrow><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></msup><mo is=&quot;true&quot;>&amp;#x2248;</mo><mn is=&quot;true&quot;>1</mn><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>+</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.271ex" height="3.322ex" viewBox="0 -1058.6 9158.4 1430.4" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-65"></use></g></g><g is="true" transform="translate(466,362)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(627,256)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(1050,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(1403,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g><g is="true" transform="translate(2952,0)"><use xlink:href="#MJMAIN-2248"></use></g><g is="true" transform="translate(4008,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(4731,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(5732,0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(886,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(7439,0)"><use xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(8162,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup><mo is="true">≈</mo><mn is="true">1</mn><mo linebreak="badbreak" is="true">+</mo><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-120"><math><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">e</mi></mrow><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></msup><mo is="true">≈</mo><mn is="true">1</mn><mo linebreak="badbreak" is="true">+</mo><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></math></script></span></span></span></p><p id="p0095">To guarantee the above approximation to be nonnegative, <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-121-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.06ex" height="1.972ex" viewBox="0 -530.3 886.8 849.3" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-121"><math><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-122-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.314ex" height="2.709ex" viewBox="0 -794.4 996.2 1166.2" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-122"><math><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></math></script></span> are normalized by the <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-123-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>l</mi><mn is=&quot;true&quot;>2</mn></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.748ex" height="2.341ex" viewBox="0 -794.4 752.4 1007.7" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-6C"></use></g><g is="true" transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mi is="true">l</mi><mn is="true">2</mn></msub></math></span></span><script type="math/mml" id="MathJax-Element-123"><math><msub is="true"><mi is="true">l</mi><mn is="true">2</mn></msub></math></script></span> norm, thereby ensuring <span class="math"><span class="MathJax_Preview" style="display: none;"></span><span class="MathJax_SVG" id="MathJax-Element-124-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub></mrow><mi is=&quot;true&quot;>T</mi></msup><mo is=&quot;true&quot;>&amp;#x2219;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo is=&quot;true&quot;>&amp;#x2265;</mo><mo linebreak=&quot;badbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>-</mo><mn is=&quot;true&quot;>1</mn></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.026ex" height="2.954ex" viewBox="0 -900.1 6039.1 1271.9" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(886,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(1707,0)"><use xlink:href="#MJMAIN-2219"></use></g><g is="true" transform="translate(2429,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(3703,0)"><use xlink:href="#MJMAIN-2265"></use></g><g is="true" transform="translate(4760,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(5538,0)"><use xlink:href="#MJMAIN-31"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo is="true">≥</mo><mo linebreak="badbreak" linebreakstyle="after" is="true">-</mo><mn is="true">1</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-124"><math><mrow is="true"><msup is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub></mrow><mi is="true">T</mi></msup><mo is="true">∙</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mo is="true">≥</mo><mo linebreak="badbreak" linebreakstyle="after" is="true">-</mo><mn is="true">1</mn></mrow></math></script></span>:<span class="display"><span id="e0050" class="formula"><span class="label">(10)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-125-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>m</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>+</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow><mi is=&quot;true&quot;>T</mi></msup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="34.09ex" height="5.04ex" viewBox="0 -1428.4 14677.6 2170" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-73"></use></g><g is="true" transform="translate(469,0)"><use xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(815,0)"><use xlink:href="#MJMATHI-6D"></use></g><g is="true" transform="translate(1693,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(542,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(886,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1331,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(604,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><use xlink:href="#MJMAIN-29" x="2717" y="0"></use></g><g is="true" transform="translate(4800,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(5856,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(6579,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(7580,0)"><g is="true"><g is="true"><use xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(597,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1775" height="60" x="0" y="220"></rect><g is="true" transform="translate(574,577)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(60,-441)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(353,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(383,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(980,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225"></use></g></g></g><g is="true" transform="translate(1334,-203)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use xlink:href="#MJSZ2-29" x="2613" y="-1"></use></g></g><g is="true" transform="translate(3210,877)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(11389,0)"><use xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(597,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1853" height="60" x="0" y="220"></rect><g is="true" transform="translate(574,617)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(60,-418)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-32"></use></g><g is="true" transform="translate(353,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(1058,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-32"></use></g></g><g is="true" transform="translate(1412,-234)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use xlink:href="#MJSZ2-29" x="2690" y="-1"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">s</mi><mi is="true">i</mi><mi is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mn is="true">1</mn><mo linebreak="badbreak" is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></math></span></span><script type="math/mml" id="MathJax-Element-125"><math><mrow is="true"><mi is="true">s</mi><mi is="true">i</mi><mi is="true">m</mi><mfenced open="(" close=")" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mn is="true">1</mn><mo linebreak="badbreak" is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></math></script></span></span></span></p><p id="p0100">Thus, Eq. <a name="be0025" href="#e0025" class="workspace-trigger">(5)</a> can be rewritten as Eq. <a name="be0055" href="#e0055" class="workspace-trigger">(11)</a> and simplified as Eq. <a name="be0060" href="#e0060" class="workspace-trigger">(12)</a>:<span class="display"><span id="e0055" class="formula"><span class="label">(11)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-126-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>D</mi></mrow><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>i</mi></mrow></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>N</mi></mrow></msubsup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>+</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>i</mi></mrow></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>i</mi></mrow></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>T</mi></mrow></msup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow></mfenced><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow></msub></mrow><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>N</mi></mrow></msubsup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>+</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>i</mi></mrow></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>i</mi></mrow></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>T</mi></mrow></msup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>j</mi></mrow></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow></mfenced></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="41.459ex" height="8.966ex" viewBox="0 -2168 17850.4 3860.5" role="img" focusable="false" style="vertical-align: -3.931ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-44"></use></g></g><g is="true" transform="translate(938,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g></g><g is="true" transform="translate(5367,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-69"></use></g></g></g><g is="true" transform="translate(6031,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6810,0)"><g transform="translate(397,0)"><rect stroke="none" width="10243" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,1081)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-4E"></use></g></g><g is="true" transform="translate(747,-203)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g><g is="true" transform="translate(235,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(625,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1693,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(904,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1444" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,515)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-69"></use></g></g></g><g is="true" transform="translate(60,-322)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-74"></use></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-69"></use></g></g></g><g is="true" transform="translate(774,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-74"></use></g></g><g is="true" transform="translate(1024,-205)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2980" y="-1"></use></g></g><g is="true" transform="translate(2529,620)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-54"></use></g></g></g><g is="true" transform="translate(3891,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1508" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,612)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1054"></use></g></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g></g><g is="true" transform="translate(838,0)"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1054"></use></g></g></g><g is="true" transform="translate(1088,-302)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="3209" y="-1"></use></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="10185" y="-1"></use></g><g is="true" transform="translate(9415,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,-107)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g></g></g><g is="true" transform="translate(413,-935)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-4E"></use></g></g><g is="true" transform="translate(747,-203)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g><g is="true" transform="translate(235,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(625,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1693,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(904,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1444" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,515)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-69"></use></g></g></g><g is="true" transform="translate(60,-322)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-74"></use></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-69"></use></g></g></g><g is="true" transform="translate(774,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-74"></use></g></g><g is="true" transform="translate(1024,-205)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2980" y="-1"></use></g></g><g is="true" transform="translate(2529,620)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-54"></use></g></g></g><g is="true" transform="translate(3891,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1508" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,612)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1054"></use></g></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-176)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6A"></use></g></g></g><g is="true" transform="translate(838,0)"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1054"></use></g></g></g><g is="true" transform="translate(1088,-302)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="3209" y="-1"></use></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="10185" y="-1"></use></g></g></g></g><g is="true" transform="translate(17571,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">D</mi></mrow><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">N</mi></mrow></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mn is="true">1</mn><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">T</mi></mrow></msup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></mfenced><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">N</mi></mrow></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mn is="true">1</mn><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">T</mi></mrow></msup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></mfenced></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-126"><math><mrow is="true"><msub is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">D</mi></mrow><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">N</mi></mrow></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mn is="true">1</mn><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">T</mi></mrow></msup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></mfenced><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">N</mi></mrow></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mn is="true">1</mn><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">i</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">T</mi></mrow></msup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mrow is="true"><mi mathvariant="bold-italic" is="true">j</mi></mrow></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></mfenced></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span><span class="display"><span id="e0060" class="formula"><span class="label">(12)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-127-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mi is=&quot;true&quot;>i</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mo is=&quot;true&quot;>+</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow><mi is=&quot;true&quot;>T</mi></msup><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>+</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>q</mi></mrow><mi is=&quot;true&quot;>i</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow><mi is=&quot;true&quot;>T</mi></msup><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow></mfrac><mo is=&quot;true&quot;>.</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="44.062ex" height="8.966ex" viewBox="0 -2168 18971.1 3860.5" role="img" focusable="false" style="vertical-align: -3.931ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g></g><g is="true" transform="translate(5257,-287)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(5879,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6657,0)"><g transform="translate(397,0)"><rect stroke="none" width="11516" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,1081)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1830,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(2508,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(3058,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1414" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,500)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(60,-331)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-55"></use></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(744,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-55"></use></g></g><g is="true" transform="translate(994,-190)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2937" y="-1"></use></g></g><g is="true" transform="translate(2499,620)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(6148,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(7811,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1479" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,597)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1023"></use></g></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(808,0)"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1023"></use></g></g></g><g is="true" transform="translate(1059,-287)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="3167" y="-1"></use></g><g is="true" transform="translate(10572,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(401,244)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(401,-215)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g><g is="true" transform="translate(1412,-935)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(1178,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1414" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,500)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(60,-331)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-55"></use></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-71"></use></g></g><g is="true" transform="translate(271,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(744,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-55"></use></g></g><g is="true" transform="translate(994,-190)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2937" y="-1"></use></g></g><g is="true" transform="translate(2499,620)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(4268,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(206,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(595,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(5931,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1479" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,597)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1023"></use></g></g><g is="true" transform="translate(250,0)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(302,-159)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(808,0)"><g is="true" transform="translate(0,375)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-751"></use><use transform="scale(0.5)" xlink:href="#MJMAIN-2225" x="0" y="-1023"></use></g></g></g><g is="true" transform="translate(1059,-287)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="3167" y="-1"></use></g></g></g></g><g is="true" transform="translate(18692,0)"><use xlink:href="#MJMAIN-2E"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></mfrac><mo is="true">.</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-127"><math><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mi is="true">i</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mi is="true">j</mi></msub><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">+</mo><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">q</mi></mrow><mi is="true">i</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></mfrac><mo is="true">.</mo></mrow></math></script></span></span></span></p><p id="p0105">Eq. <a name="be0060" href="#e0060" class="workspace-trigger">(12)</a> can be turned into a vectorized form:<span class="display"><span id="e0065" class="formula"><span class="label">(13)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-128-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo is=&quot;true&quot;>,</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mi is=&quot;true&quot;>j</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mo is=&quot;true&quot;>,</mo><mi is=&quot;true&quot;>j</mi></mrow></msub><mo is=&quot;true&quot;>+</mo><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow><mi is=&quot;true&quot;>T</mi></msup><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>V</mi></mrow></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>+</mo><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>Q</mi></mrow><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced><msub is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mi is=&quot;true&quot;>j</mi></msub><msubsup is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>K</mi></mrow><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mo is=&quot;true&quot;>,</mo><mi is=&quot;true&quot;>j</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup></mrow></mfrac></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="38.376ex" height="8.721ex" viewBox="0 -2168 16522.9 3754.8" role="img" focusable="false" style="vertical-align: -3.686ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(869,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1314,0)"><g is="true"><use xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(2318,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2763,0)"><g is="true"><use xlink:href="#MJMATHBI-56"></use></g></g></g><use xlink:href="#MJMAIN-29" x="4039" y="0"></use></g><g is="true" transform="translate(5257,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6035,0)"><g transform="translate(397,0)"><rect stroke="none" width="9969" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,1081)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,-203)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(1190,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-56"></use></g></g><g is="true" transform="translate(479,-107)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(172,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(312,0)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(2259,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(2809,0)"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1355" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,433)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g><g is="true" transform="translate(250,0)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(685,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(935,-162)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2853" y="-1"></use></g><g is="true" transform="translate(5250,0)"><use transform="scale(0.707)" xlink:href="#MJSZ3-28"></use><g is="true" transform="translate(520,0)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1422" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,336)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g><g is="true" transform="translate(250,0)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(752,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(1002,-162)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2948" y="-1"></use></g></g><g is="true" transform="translate(2507,620)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g></g><g is="true" transform="translate(2930,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-56"></use></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ3-29" x="5767" y="-1"></use></g></g><g is="true" transform="translate(1031,-869)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(628,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(1178,0)"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1355" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,433)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g><g is="true" transform="translate(250,0)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-51"></use></g></g><g is="true" transform="translate(685,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(935,-162)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2853" y="-1"></use></g><g is="true" transform="translate(3619,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,-203)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(4809,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(422,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1422" height="60" x="0" y="146"></rect><g is="true" transform="translate(460,336)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(60,-358)"><g is="true"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g><g is="true" transform="translate(250,0)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHBI-4B"></use></g></g><g is="true" transform="translate(752,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(1002,-162)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use transform="scale(0.707)" xlink:href="#MJSZ2-29" x="2948" y="-1"></use></g><g is="true" transform="translate(2507,620)"><use transform="scale(0.5)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(2507,-545)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(172,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(312,0)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msub is="true"><mo is="true">∑</mo><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">j</mi></mrow></msub><mo is="true">+</mo><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><mfenced open="(" close=")" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">+</mo><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><msub is="true"><mo is="true">∑</mo><mi is="true">j</mi></msub><msubsup is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow></mfrac></mrow></math></span></span><script type="math/mml" id="MathJax-Element-128"><math><mrow is="true"><mi is="true">D</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo is="true">,</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msub is="true"><mo is="true">∑</mo><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">j</mi></mrow></msub><mo is="true">+</mo><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><mfenced open="(" close=")" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow><mi is="true">T</mi></msup><mrow is="true"><mi mathvariant="bold-italic" is="true">V</mi></mrow></mrow></mfenced></mrow><mrow is="true"><mi is="true">N</mi><mo is="true">+</mo><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">Q</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><msub is="true"><mo is="true">∑</mo><mi is="true">j</mi></msub><msubsup is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><msub is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo><mrow is="true"><mi mathvariant="bold-italic" is="true">K</mi></mrow><mo stretchy="true" is="true">‖</mo></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><mrow is="true"><mi is="true">i</mi><mo is="true">,</mo><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow></mfrac></mrow></math></script></span></span></span></p><p id="p0110">Since <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-129-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>v</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi></mrow><mi is=&quot;true&quot;>T</mi></msubsup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="15.808ex" height="4.549ex" viewBox="0 -1217.1 6806.4 1958.7" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(291,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(842,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(2352,0)"><use xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(597,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1853" height="60" x="0" y="220"></rect><g is="true" transform="translate(574,617)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(60,-418)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-32"></use></g><g is="true" transform="translate(353,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(1058,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-32"></use></g></g><g is="true" transform="translate(1412,-234)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use xlink:href="#MJSZ2-29" x="2690" y="-1"></use></g><g is="true" transform="translate(5640,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHBI-76"></use></g></g><g is="true" transform="translate(567,345)"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g><g is="true" transform="translate(567,-304)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-129"><math><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced><msubsup is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">v</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow><mi is="true">T</mi></msubsup></mrow></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-130-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold-italic&quot; is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>j</mi></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2016;</mo></mrow></mrow><mn is=&quot;true&quot;>2</mn></msub></mfrac></mrow></mfenced></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.101ex" height="4.549ex" viewBox="0 -1217.1 5640.8 1958.7" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(291,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(842,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(2352,0)"><use xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(597,0)"><g is="true"><g transform="translate(120,0)"><rect stroke="none" width="1853" height="60" x="0" y="220"></rect><g is="true" transform="translate(574,617)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(60,-418)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-32"></use></g><g is="true" transform="translate(353,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHBI-6B"></use></g></g><g is="true" transform="translate(427,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(1058,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2225" is="true" x="0" y="-32"></use></g></g><g is="true" transform="translate(1412,-234)"><use transform="scale(0.5)" xlink:href="#MJMAIN-32"></use></g></g></g></g></g><use xlink:href="#MJSZ2-29" x="2690" y="-1"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></math></span></span><script type="math/mml" id="MathJax-Element-130"><math><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">j</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><mfenced open="(" close=")" is="true"><mrow is="true"><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><msub is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow><msub is="true"><mrow is="true"><mi mathvariant="bold-italic" is="true">k</mi></mrow><mi is="true">j</mi></msub><mrow is="true"><mo stretchy="true" is="true">‖</mo></mrow></mrow><mn is="true">2</mn></msub></mfrac></mrow></mfenced></mrow></math></script></span> can be calculated and reused for each <em>query</em>, the time and memory complexity of the attention based on Eq. <a name="be0065" href="#e0065" class="workspace-trigger">(13)</a> is <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-131-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>O</mi><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>d</mi><mi is=&quot;true&quot;>N</mi></mrow></mfenced></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.862ex" height="2.709ex" viewBox="0 -847.3 2954.5 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use></g><g is="true" transform="translate(763,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(523,0)"><use xlink:href="#MJMATHI-4E"></use></g></g><use xlink:href="#MJMAIN-29" x="1801" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">O</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mi is="true">d</mi><mi is="true">N</mi></mrow></mfenced></mrow></math></span></span><script type="math/mml" id="MathJax-Element-131"><math><mrow is="true"><mi is="true">O</mi><mfenced open="(" close=")" is="true"><mrow is="true"><mi is="true">d</mi><mi is="true">N</mi></mrow></mfenced></mrow></math></script></span>. For more detailed information on the proposed attention mechanism, as well as its validity and efficiency, the reader is referred to (<a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>).</p></section><section id="s0035"><h3 id="st045" class="u-h4 u-margin-m-top u-margin-xs-bottom">2.5. Scaling attention mechanism</h3><p id="p0115">Besides dot-product attention, there exists another genre of techniques referred to as attention mechanisms in the literature. To distinguish it from the dot-product attention mechanism, we call them scaling attention. Unlike dot-product attention which models global dependencies from feature maps, scaling attention reinforces informative features and whittles information-lacking features. For example, <a name="bb0280" href="#b0280" class="workspace-trigger">Wang et al. (2017)</a><span> proposed a residual attention network (RAN) which introduces the scaling attention mechanism inserted into <a href="/topics/computer-science/deep-residual-network" title="Learn more about deep residual networks from ScienceDirect's AI-generated Topic Pages" class="topic-link">deep residual networks</a>. As a high-capacity structure, the residual attention is mainly built on max-pooling layers, convolutional layers, and residual units. In contrast, </span><a name="bb0105" href="#b0105" class="workspace-trigger">Hu et al. (2018)</a><span> presented the squeeze-and-excitation (SE) module, a lightweight gating mechanism constructed on the global <a href="/topics/computer-science/average-pooling" title="Learn more about average pooling from ScienceDirect's AI-generated Topic Pages" class="topic-link">average pooling</a> layer and linear layers, to calculate a scaling factor for each channel, thereby weighting the channels accordingly. The convolutional block attention module (CBAM) (</span><a name="bb0305" href="#b0305" class="workspace-trigger">Woo et al., 2018</a>), selective kernel unit (SK unit) (<a name="bb0175" href="#b0175" class="workspace-trigger">Li et al., 2019b</a>) and efficient channel attention module (ECA) (<a name="bb0295" href="#b0295" class="workspace-trigger">Wang et al., 2020</a>) further boost the SE block’s performance. Despite both names containing attention, the principles and purposes of dot-product attention and scaling attention are entirely divergent.</p></section><section id="s0040"><h3 id="st050" class="u-h4 u-margin-m-top u-margin-xs-bottom">2.6. Efficient semantic segmentation</h3><p id="p0120"><span>For many practical applications, efficiency is critical, and this is especially pertinent for real-time (≥30FPS) scenarios such as <a href="/topics/computer-science/autonomous-driving" title="Learn more about autonomous driving from ScienceDirect's AI-generated Topic Pages" class="topic-link">autonomous driving</a>. Therefore, huge efforts have been made to accelerate models for efficient semantic segmentation, by employing lightweight operations or down-sampling the input size. The utilization of lightweight convolutions (e.g., asymmetric convolution and depth-wise separable convolution) is a common strategy for designing lightweight networks (</span><a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a>; <a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a><span><span>). The down-sampling of the input size is a <a href="/topics/computer-science/trivial-solution" title="Learn more about trivial solution from ScienceDirect's AI-generated Topic Pages" class="topic-link">trivial solution</a> to speed up semantic segmentation by reducing the resolution of the input images, which inevitably results in the loss of information. To extract </span><a href="/topics/computer-science/spatial-detail" title="Learn more about spatial details from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial details</a> at the original resolution, some of the latest methods include a further shallow branch, forming a two-path architecture (</span><a name="bb0325" href="#b0325" class="workspace-trigger">Yu et al., 2020</a>, <a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>).</p></section></section><section id="s0045"><h2 id="st055" class="u-h3 u-margin-l-top u-margin-xs-bottom">3. Attentive bilateral contextual network</h2><div><p id="p0125">The proposed Attentive Bilateral Contextual Network (ABCNet), as well as the components, are demonstrated in <a name="bf0025" href="#f0025" class="workspace-trigger">Fig. 5</a>.</p><figure class="figure text-xs" id="f0025"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr5.jpg" height="314" alt="" aria-describedby="cn0025"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr5_lrg.jpg" target="_blank" download="" title="Download high-res image (332KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (332KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr5.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0025"><p id="sp0030"><span class="label">Fig. 5</span>. An overview of the Attentive Bilateral Contextual Network. (a) <a href="/topics/computer-science/network-architecture" title="Learn more about network architecture from ScienceDirect's AI-generated Topic Pages" class="topic-link">network architecture</a><span>. (b) the Feature Aggregation Module (FAM). (c) the Attention Enhancement Module (AEM). (d) the Linear Attention Mechanism. Note that CBR means Convolution&nbsp;+&nbsp;BatchNorm&nbsp;+&nbsp;ReLU, LAM denotes Linear Attention Mechanism, Conv signifies <a href="/topics/computer-science/convolution-layer" title="Learn more about Convolution layer from ScienceDirect's AI-generated Topic Pages" class="topic-link">Convolution layer</a>, Concat represents Concatenate operation, BN illustrates BatchNorm layer, and Mul is Multiplication operation.</span></p></span></span></figure></div><section id="s0050"><h3 id="st060" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.1. Spatial path</h3><p id="p0130"><span>It is very challenging to reconcile the requirement for <a href="/topics/computer-science/spatial-detail" title="Learn more about spatial detail from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial detail</a> with a large receptive field simultaneously. However, both of them are crucial to achieving high segmentation accuracy. Especially, for efficient semantic segmentation, mainstream solutions focus on down-sampling of the input image or speeding up the network by channel pruning. The former loses the majority of the spatial detail, whereas the latter can change its character deleteriously. By contrast, in the proposed ABCNet, we adopt a bilateral architecture (</span><a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>), which is equipped with a spatial path to capture spatial details and generate low-level feature maps. Therefore, a rich channel capacity is essential for this path to encode sufficient spatial detailed information. Meanwhile, since the spatial path focuses merely on low-level details, a shallow structure with a small stride is sufficient for this branch. Specifically, the spatial path is comprised of three layers as shown in <a name="bf0025" href="#f0025" class="workspace-trigger">Fig. 5</a><span>(a). The kernel size, channel number, stride and padding for each layer is [7, 64, 2, 3], [3, 64, 2, 1], and [3, 64, 2, 1], respectively. Each layer is followed by <a href="/topics/computer-science/batch-normalization" title="Learn more about batch normalization from ScienceDirect's AI-generated Topic Pages" class="topic-link">batch normalization</a> (</span><a name="bb0130" href="#b0130" class="workspace-trigger">Ioffe and Szegedy, 2015</a>) and ReLU (<a name="bb0080" href="#b0080" class="workspace-trigger">Glorot et al., 2011</a><span>). Therefore, the <a href="/topics/computer-science/output-feature-map" title="Learn more about output feature maps from ScienceDirect's AI-generated Topic Pages" class="topic-link">output feature maps</a> of this path are 1/8 of the original image, which encodes abundant spatial details resulting from the large spatial size.</span></p></section><section id="s0055"><h3 id="st065" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.2. Contextual path</h3><p id="p0135">In parallel to the spatial path, the contextual path is designed to provide a sufficient receptive field, thereby extracting global high-level contextual information. For segmentation, as the receptive field determines the richness of context, several recent approaches attempt to address the issue by taking advantage of the spatial pyramid pooling. However, huge computational demand and memory consumption will be brought when expanding the receptive field by a large kernel size. Instead, we develop the contextual path with the linear attention mechanism (<a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>), which considers the long-range contextual information and efficient computation simultaneously.</p><p id="p0140">In the contextual path as shown in <a name="bf0025" href="#f0025" class="workspace-trigger">Fig. 5</a>(a), we harness the lightweight backbone (i.e., ResNet-18) (<a name="bb0100" href="#b0100" class="workspace-trigger">He et al., 2016</a><span><span>) to down-sample the feature map and encode the high-level <a href="/topics/computer-science/semantic-information" title="Learn more about semantic information from ScienceDirect's AI-generated Topic Pages" class="topic-link">semantic information</a>. We deploy two attention enhancement modules (AEM) on the last two layers of the backbone to fully extract the global contextual information. Besides, a global </span><a href="/topics/computer-science/average-pooling" title="Learn more about average pooling from ScienceDirect's AI-generated Topic Pages" class="topic-link">average pooling</a> operation is attached to the tail of the contextual path to extract the contextual information, while the obtained features are added with the enhanced features generated by AEM2. Thereafter, the acquired features are upsampled by scale&nbsp;=&nbsp;2 to restore the shape. Finally, the features obtained by the AEM1 and AEM2 are added and then fed into the feature aggregation module (FAM).</span></p></section><section id="s0060"><h3 id="st070" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.3. Feature aggregation module</h3><p id="p0145">The feature representations of the spatial path and the contextual path are complementary, but provided in different domains (i.e., the spatial path generates the low-level and detailed features, while the contextual path provides the high-level and semantic features). Specifically, the output feature captured by the spatial path encodes mainly rich detail information, while the information generated by the contextual path mostly encodes contextual information. Thus, even though summation and concatenation can merge those features (<a name="bb0235" href="#b0235" class="workspace-trigger">Poudel et al., 2019</a>), these simple fusion schemes are less effective to fuse information in diverse domains (<a name="bb0315" href="#b0315" class="workspace-trigger">Yang et al., 2021</a>). Here, we design a feature aggregation module (FAM) to merge both types of feature representation in consideration of the need for high accuracy and efficiency.</p><p id="p0150">As shown in <a name="bf0025" href="#f0025" class="workspace-trigger">Fig. 5</a><span>(b), with two domains of features, we first concatenate the output of the spatial and contextual paths. Thereafter, a <a href="/topics/computer-science/convolutional-layer" title="Learn more about convolutional layer from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolutional layer</a> with batch normalization (</span><a name="bb0130" href="#b0130" class="workspace-trigger">Ioffe and Szegedy, 2015</a>) and ReLU (<a name="bb0080" href="#b0080" class="workspace-trigger">Glorot et al., 2011</a>) is attached to balance the scales of the features. Then, we capture the long-range dependencies of the generated features using the linear attention mechanism, thereby weighing the features selectively. Finally, the weighted features are multiplied and added with the balanced features. As both the scales and contributions of features are readjusted adaptively, the outputs of spatial and contextual paths can be fused effectively.</p></section><section id="s0065"><h3 id="st075" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.4. Loss function</h3><p id="p0155">As shown in <a name="bf0025" href="#f0025" class="workspace-trigger">Fig. 5</a>(a), besides the principal loss function used to supervise the output of the entire network, we utilize two auxiliary loss functions along the contextual path to accelerate the convergence velocity. We select the cross-entropy loss as the principal loss:<span class="display"><span id="e0070" class="formula"><span class="label">(14)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-132-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>L</mi><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>CE</mi></mrow></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>-</mo><mfrac is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mi is=&quot;true&quot;>N</mi></mfrac><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>n</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>K</mi></msubsup><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msubsup><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>log</mi><msubsup is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>^</mo></mover><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msubsup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.056ex" height="3.69ex" viewBox="0 -1111.4 15093.7 1588.9" role="img" focusable="false" style="vertical-align: -1.109ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAIN-4C"></use></g><g is="true" transform="translate(625,-155)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-43"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-45" x="715" y="0"></use></g></g></g><g is="true" transform="translate(2031,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(3087,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(3866,0)"><g transform="translate(120,0)"><rect stroke="none" width="748" height="60" x="0" y="220"></rect><g is="true" transform="translate(197,409)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(60,-393)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g></g><g is="true" transform="translate(5021,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(424,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(975,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(7673,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(368,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(919,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(10269,0)"><g is="true"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(499,521)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(490,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g><g is="true" transform="translate(12011,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><g is="true" transform="translate(13457,0)"><g is="true"><g is="true" transform="translate(1,0)"><use xlink:href="#MJMATHI-79"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="60" y="-7"></use></g><g is="true" transform="translate(560,521)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(560,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">CE</mi></mrow></msub><mo linebreak="goodbreak" is="true">=</mo><mo linebreak="badbreak" is="true">-</mo><mfrac is="true"><mn is="true">1</mn><mi is="true">N</mi></mfrac><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">n</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msubsup is="true"><mi is="true">y</mi><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup><mi mathvariant="normal" is="true">log</mi><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-132"><math><mrow is="true"><msub is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">CE</mi></mrow></msub><mo linebreak="goodbreak" is="true">=</mo><mo linebreak="badbreak" is="true">-</mo><mfrac is="true"><mn is="true">1</mn><mi is="true">N</mi></mfrac><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">n</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msubsup is="true"><mi is="true">y</mi><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup><mi mathvariant="normal" is="true">log</mi><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></mrow></math></script></span></span></span></p><p id="p0160">where <em>N</em> and <em>K</em> are the number of samples and number of classes, respectively. <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-133-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.658ex" height="2.831ex" viewBox="0 -952.9 1575.1 1219.1" role="img" focusable="false" style="vertical-align: -0.618ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(499,362)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-133"><math><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msup></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-134-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>^</mo></mover></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.8ex" height="2.954ex" viewBox="0 -1005.7 1636.1 1271.9" role="img" focusable="false" style="vertical-align: -0.618ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true" transform="translate(1,0)"><use xlink:href="#MJMATHI-79"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="60" y="-7"></use></g></g><g is="true" transform="translate(560,415)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-134"><math><msup is="true"><mrow is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msup></math></script></span> with <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-135-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>n</mi><mo is=&quot;true&quot;>&amp;#x2208;</mo><mo stretchy=&quot;true&quot; is=&quot;true&quot;>[</mo><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>,</mo><mo is=&quot;true&quot;>&amp;#x22EF;</mo><mo is=&quot;true&quot;>,</mo><mi is=&quot;true&quot;>N</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>]</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.831ex" height="2.709ex" viewBox="0 -847.3 5955.1 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-6E"></use></g><g is="true" transform="translate(834,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(1779,0)"><use xlink:href="#MJMAIN-5B"></use></g><g is="true" transform="translate(2058,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(2558,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(3003,0)"><use xlink:href="#MJMAIN-22EF"></use></g><g is="true" transform="translate(4342,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(4788,0)"><use xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(5676,0)"><use xlink:href="#MJMAIN-5D"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="normal" is="true">n</mi><mo is="true">∈</mo><mo stretchy="true" is="true">[</mo><mn is="true">1</mn><mo is="true">,</mo><mo is="true">⋯</mo><mo is="true">,</mo><mi is="true">N</mi><mo stretchy="true" is="true">]</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-135"><math><mrow is="true"><mi mathvariant="normal" is="true">n</mi><mo is="true">∈</mo><mo stretchy="true" is="true">[</mo><mn is="true">1</mn><mo is="true">,</mo><mo is="true">⋯</mo><mo is="true">,</mo><mi is="true">N</mi><mo stretchy="true" is="true">]</mo></mrow></math></script></span> are one-hot vectors of the true labels and the corresponding softmax output from the network. Essentially, <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-136-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>^</mo></mover><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msubsup></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.8ex" height="3.568ex" viewBox="0 -1111.4 1636.1 1536" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true" transform="translate(1,0)"><use xlink:href="#MJMATHI-79"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="60" y="-7"></use></g><g is="true" transform="translate(560,521)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(560,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-136"><math><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></math></script></span> depicts the network’s confidence of sample <em>n</em> being classified as <em>k.</em> The auxiliary loss functions are chosen as the focal loss:<span class="display"><span id="e0075" class="formula"><span class="label">(15)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-137-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>L</mi><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>Focal</mi></mrow></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>-</mo><mfrac is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mi is=&quot;true&quot;>N</mi></mfrac><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>n</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>N</mi></msubsup><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>K</mi></msubsup><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced open=&quot;(&quot; close=&quot;)&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>-</mo><msubsup is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>^</mo></mover><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msubsup></mrow></mfenced></mrow><mi is=&quot;true&quot;>&amp;#x3B3;</mi></msup><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msubsup><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>log</mi><msubsup is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>^</mo></mover><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>n</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>)</mo></mrow></msubsup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="48.298ex" height="4.672ex" viewBox="0 -1269.9 20794.8 2011.5" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAIN-4C"></use></g><g is="true" transform="translate(625,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="643" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="1129" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="1562" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="2092" y="0"></use></g></g></g><g is="true" transform="translate(2693,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(3749,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(4528,0)"><g transform="translate(120,0)"><rect stroke="none" width="748" height="60" x="0" y="220"></rect><g is="true" transform="translate(197,409)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(60,-393)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g></g><g is="true" transform="translate(5683,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(424,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(975,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(8335,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(368,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(919,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(10931,0)"><g is="true"><g is="true"><use xlink:href="#MJSZ2-28"></use><g is="true" transform="translate(597,0)"><g is="true"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(722,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(1723,0)"><g is="true"><g is="true" transform="translate(1,0)"><use xlink:href="#MJMATHI-79"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="60" y="-7"></use></g><g is="true" transform="translate(560,521)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(560,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></g><use xlink:href="#MJSZ2-29" x="3957" y="-1"></use></g></g><g is="true" transform="translate(4554,877)"><use transform="scale(0.707)" xlink:href="#MJMATHI-3B3"></use></g></g><g is="true" transform="translate(15970,0)"><g is="true"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(499,521)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(490,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g><g is="true" transform="translate(17712,0)"><use xlink:href="#MJMAIN-6C"></use><use xlink:href="#MJMAIN-6F" x="278" y="0"></use><use xlink:href="#MJMAIN-67" x="779" y="0"></use></g><g is="true" transform="translate(19158,0)"><g is="true"><g is="true" transform="translate(1,0)"><use xlink:href="#MJMATHI-79"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="60" y="-7"></use></g><g is="true" transform="translate(560,521)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(700,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(560,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">Focal</mi></mrow></msub><mo linebreak="goodbreak" is="true">=</mo><mo linebreak="badbreak" is="true">-</mo><mfrac is="true"><mn is="true">1</mn><mi is="true">N</mi></mfrac><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">n</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mn is="true">1</mn><mo is="true">-</mo><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></mrow></mfenced></mrow><mi is="true">γ</mi></msup><msubsup is="true"><mi is="true">y</mi><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup><mi mathvariant="normal" is="true">log</mi><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-137"><math><mrow is="true"><msub is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">Focal</mi></mrow></msub><mo linebreak="goodbreak" is="true">=</mo><mo linebreak="badbreak" is="true">-</mo><mfrac is="true"><mn is="true">1</mn><mi is="true">N</mi></mfrac><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">n</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">N</mi></msubsup><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msup is="true"><mrow is="true"><mfenced open="(" close=")" is="true"><mrow is="true"><mn is="true">1</mn><mo is="true">-</mo><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></mrow></mfenced></mrow><mi is="true">γ</mi></msup><msubsup is="true"><mi is="true">y</mi><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup><mi mathvariant="normal" is="true">log</mi><msubsup is="true"><mover accent="true" is="true"><mi is="true">y</mi><mo stretchy="true" is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mrow is="true"><mo stretchy="true" is="true">(</mo><mi is="true">n</mi><mo stretchy="true" is="true">)</mo></mrow></msubsup></mrow></math></script></span></span></span></p><p id="p0165">where <em>γ</em> is the focusing parameter, which controls the down-weighting of the easily classified examples, parameterized as 2 in the experiments. Hence, the overall loss of the network is:<span class="display"><span id="e0080" class="formula"><span class="label">(16)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-138-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>L</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>L</mi><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>CE</mi></mrow></msub><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>+</mo><msubsup is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>L</mi><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>Focal</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>a</mi><mi is=&quot;true&quot;>u</mi><mi is=&quot;true&quot;>x</mi><mn is=&quot;true&quot;>1</mn></mrow></msubsup><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>+</mo><msubsup is=&quot;true&quot;><mi mathvariant=&quot;normal&quot; is=&quot;true&quot;>L</mi><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>Focal</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>a</mi><mi is=&quot;true&quot;>u</mi><mi is=&quot;true&quot;>x</mi><mn is=&quot;true&quot;>2</mn></mrow></msubsup></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.527ex" height="3.077ex" viewBox="0 -900.1 10990.8 1324.7" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-4C"></use></g><g is="true" transform="translate(903,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1959,0)"><g is="true"><use xlink:href="#MJMAIN-4C"></use></g><g is="true" transform="translate(625,-155)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-43"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-45" x="715" y="0"></use></g></g></g><g is="true" transform="translate(3935,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(4936,0)"><g is="true"><use xlink:href="#MJMAIN-4C"></use></g><g is="true" transform="translate(625,352)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-61"></use></g><g is="true" transform="translate(374,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-75"></use></g><g is="true" transform="translate(779,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(1184,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(625,-328)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="643" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="1129" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="1562" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="2092" y="0"></use></g></g></g><g is="true" transform="translate(7574,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(8574,0)"><g is="true"><use xlink:href="#MJMAIN-4C"></use></g><g is="true" transform="translate(625,352)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-61"></use></g><g is="true" transform="translate(374,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-75"></use></g><g is="true" transform="translate(779,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(1184,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g><g is="true" transform="translate(625,-328)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="643" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="1129" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="1562" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="2092" y="0"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="normal" is="true">L</mi><mo linebreak="goodbreak" is="true">=</mo><msub is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">CE</mi></mrow></msub><mo linebreak="badbreak" is="true">+</mo><msubsup is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">Focal</mi></mrow><mrow is="true"><mi is="true">a</mi><mi is="true">u</mi><mi is="true">x</mi><mn is="true">1</mn></mrow></msubsup><mo linebreak="badbreak" is="true">+</mo><msubsup is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">Focal</mi></mrow><mrow is="true"><mi is="true">a</mi><mi is="true">u</mi><mi is="true">x</mi><mn is="true">2</mn></mrow></msubsup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-138"><math><mrow is="true"><mi mathvariant="normal" is="true">L</mi><mo linebreak="goodbreak" is="true">=</mo><msub is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">CE</mi></mrow></msub><mo linebreak="badbreak" is="true">+</mo><msubsup is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">Focal</mi></mrow><mrow is="true"><mi is="true">a</mi><mi is="true">u</mi><mi is="true">x</mi><mn is="true">1</mn></mrow></msubsup><mo linebreak="badbreak" is="true">+</mo><msubsup is="true"><mi mathvariant="normal" is="true">L</mi><mrow is="true"><mi mathvariant="italic" is="true">Focal</mi></mrow><mrow is="true"><mi is="true">a</mi><mi is="true">u</mi><mi is="true">x</mi><mn is="true">2</mn></mrow></msubsup></mrow></math></script></span></span></span></p></section><section id="s0070"><h3 id="st080" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.5. Network variants</h3><p id="p0170">There are four main parts in our proposed ABCNet, i.e., the contextual path, the spatial path, the attention enhancement module (AEM), and the feature aggregation module (FAM). Hence, there are mainly five variants of our ABCNet.</p><p id="p0175"><strong>Baseline</strong>: The baseline (denoted as Cp) can be constructed based on the contextual path without AEM and FAM, while the backbone is set as ResNet-18. The baseline can be utilized as the benchmark to evaluate the effectiveness of components in the network.</p><p id="p0180"><strong>Cp&nbsp;+&nbsp;AEM</strong>: In the contextual path, the attention enhancement module is designed to capture global contextual information. Hence, a simple variant is a contextual path with attention enhancement modules. The performance of Cp&nbsp;+&nbsp;AEM compared with the baseline will illustrate the effectiveness of the attention enhancement module.</p><p id="p0185"><strong>Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM (Sum)</strong> and <strong>Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM (Cat)</strong>: As abundant spatial information is crucial for semantic segmentation, the spatial path is designed to provide a relatively large spatial size and extract spatial information. Two simple fusion schemes including summation (Sum) and concatenation (Cat) can be utilized to merge features. The effectiveness of the spatial path can be validated by merging the spatial information into the network.</p><p id="p0190"><strong>Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM&nbsp;+&nbsp;FAM</strong>: Given that the features obtained by the spatial and contextual paths are in different domains, neither summation nor concatenation provides the optimal fusion scheme. The full version of the proposed ABCNet is fusing the contextual information and spatial information by the feature aggregation module. By comparing the accuracy with Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM (Sum) and Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM (Cat), the superiority of the feature aggregation module will be demonstrated.</p></section></section><section id="s0075"><h2 id="st085" class="u-h3 u-margin-l-top u-margin-xs-bottom">4. Eeperimental results and discussion</h2><section id="s0080"><h3 id="st090" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.1. Experimental settings</h3><p id="p0195"><dl class="list"><dt class="list-label">a)</dt><dd class="list-description"><p id="p0200">Datasets</p></dd></dl></p><p id="p0205">The effectiveness of the proposed ABCNet was tested using the ISPRS Vaihingen dataset and the ISPRS Potsdam dataset (<a href="http://www2.isprs.org/commissions/comm3/wg4/semantic-label-ing.html" target="_blank" rel="noreferrer noopener"><u>http://www2.isprs.org/commissions/comm3/wg4/semantic-label-ing.html</u></a>). There are two types of ground truth provided in the ISPRS datasets: with and without eroded boundaries. We conducted all experiments on the ground truth with eroded boundaries.</p><p id="p0210"><strong>Vaihingen</strong>: The Vaihingen dataset contains 33 images with an average size of 2494&nbsp;×&nbsp;2064 pixels and a ground sampling distance (GSD) of 9&nbsp;cm. The near-infrared, red, and green channels together with corresponding digital surface models (DSMs) and normalized DSMs (NDSMs) are provided in the dataset. We utilized ID: 2, 4, 6, 8, 10, 12, 14, 16, 20, 22, 24, 27, 29, 31, 33, 35, 38 for testing, ID: 30 for validation, and the remaining 15 images for training. The DSMs were not used in the experiments. The reference data are labeled according to six land-cover types: impervious surfaces, building, low vegetation, tree, car, and clutter/background.</p><p id="p0215"><strong>Potsdam</strong>: There exist 38 fine-resolution images of size 6000&nbsp;×&nbsp;6000 pixels with a GSD of 5&nbsp;cm in the Potsdam dataset. The dataset provides the near-infrared, red, green, and blue channels as well as DSMs and NDSMs. We utilized ID: 2_13, 2_14, 3_13, 3_14, 4_13, 4_14, 4_15, 5_13, 5_14, 5_15, 6_13, 6_14, 6_15, 7_13 for testing, ID: 2_10 for validation, and the remaining 22 images, except for image named 7_10 with error annotations, for training. We employed only the red, green, and blue channels in the experiments. The reference data are divided into the same six categories as the Vaihingen data set.<dl class="list"><dt class="list-label">b)</dt><dd class="list-description"><p id="p0220">Training and testing setting</p></dd></dl></p><p id="p0225"><span>All the training processes were implemented with PyTorch on a single Tesla V100 with 32 batch size, and the optimizer was set as AdamW with a learning rate of 0.0003 and a weight decay value of 0.0025. For the learning rate scheduler, we adopted available ReduceLROnPlateau in PyTorch with the patience of 5 and the learning rate decrease factor as 0.5. If OA on the validation set does not increase for more than 10 epochs, the training procedure will be stopped, while the maximum <a href="/topics/computer-science/iteration-period" title="Learn more about iteration period from ScienceDirect's AI-generated Topic Pages" class="topic-link">iteration period</a><span><span> is 1000 epochs. For training, we cropped the raw images as well as corresponding labels into 512&nbsp;×&nbsp;512 patches and augmented them via rotating on a random angle (90°, 180°, or 270°), resizing by a random scale (from 0.5 to 2.0), flipping by the horizontal axis, flipping by the vertical axis, and adding stochastic <a href="/topics/computer-science/gaussian-noise" title="Learn more about Gaussian noise from ScienceDirect's AI-generated Topic Pages" class="topic-link">Gaussian noise</a>. The probabilities to conduct those augmentation strategies for a patch were set as 0.15, 0.15, 0.25, 0.25, and 0.1, respectively. The comparative benchmark methods selected included the contextual information aggregation methods designed initially for natural images, such as pyramid scene </span><a href="/topics/computer-science/parsing" title="Learn more about parsing from ScienceDirect's AI-generated Topic Pages" class="topic-link">parsing</a> network (PSPNet) (</span></span><a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a><span>) and dual <a href="/topics/computer-science/attention-network" title="Learn more about attention network from ScienceDirect's AI-generated Topic Pages" class="topic-link">attention network</a> (DANet) (</span><a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a><span>), the multi-scale feature aggregation models proposed for <a href="/topics/computer-science/remote-sensing-image" title="Learn more about remote sensing images from ScienceDirect's AI-generated Topic Pages" class="topic-link">remote sensing images</a>, including multi-stage attention ResU-Net (MAResU-Net) (</span><a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a><span>) and edge-aware <a href="/topics/computer-science/neural-networks" title="Learn more about neural network from ScienceDirect's AI-generated Topic Pages" class="topic-link">neural network</a> (EaNet) (</span><a name="bb0375" href="#b0375" class="workspace-trigger">Zheng et al., 2020</a>), as well as lightweight networks developed for efficient semantic segmentation, including depth-wise asymmetric bottleneck network (DABNet) (<a name="bb0145" href="#b0145" class="workspace-trigger">Li et al., 2019a</a>), efficient residual factorized convNet (ERFNet) (<a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a><span>), bilateral <a href="/topics/computer-science/network-segmentation" title="Learn more about segmentation network from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation network</a> V1 (BiSeNetV1) (</span><a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>) and V2 (BiSeNetV2) (<a name="bb0325" href="#b0325" class="workspace-trigger">Yu et al., 2020</a>), fast attention network (FANet) (<a name="bb9005" href="#b9005" class="workspace-trigger">Hu et al., 2020</a>), ShelfNet (<a name="bb0390" href="#b0390" class="workspace-trigger">Zhuang et al., 2019</a>) and SwiftNet (<a name="bb0225" href="#b0225" class="workspace-trigger">Oršić and Šegvić, 2021</a>). In the inference stage, we also utilized the data augmentation operation including random rotation and horizontal as well as vertical flipping which is also known as test-time augmentation (TTA).<dl class="list"><dt class="list-label">c)</dt><dd class="list-description"><p id="p0230"><a href="/topics/computer-science/evaluation-metric" title="Learn more about Evaluation metrics from ScienceDirect's AI-generated Topic Pages" class="topic-link">Evaluation metrics</a></p></dd></dl></p><p id="p0235"><span>The performance of ABCNet was evaluated using the overall accuracy (OA), mean Intersection over Union (mIoU), and F1 score (F1). Based on the accumulated <a href="/topics/computer-science/confusion-matrix" title="Learn more about confusion matrix from ScienceDirect's AI-generated Topic Pages" class="topic-link">confusion matrix</a>, the OA, mIoU, and F1 are computed as:</span><span class="display"><span id="e0085" class="formula"><span class="label">(17)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-139-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>OA</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>K</mi></msubsup><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>K</mi></msubsup><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TN</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FN</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.173ex" height="5.285ex" viewBox="0 -1375.5 12130.1 2275.6" role="img" focusable="false" style="vertical-align: -2.091ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4F"></use><use xlink:href="#MJMATHI-41" x="763" y="0"></use></g><g is="true" transform="translate(1791,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2570,0)"><g transform="translate(397,0)"><rect stroke="none" width="8763" height="60" x="0" y="220"></rect><g is="true" transform="translate(2839,617)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(260,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(650,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1884,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g><g is="true" transform="translate(60,-590)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(747,337)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(747,-203)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(260,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(650,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1884,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(3083,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(3634,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="643" y="0"></use></g></g><g is="true" transform="translate(909,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(4875,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(5425,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-4E" x="584" y="0"></use></g></g><g is="true" transform="translate(981,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(6738,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(7288,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-4E" x="643" y="0"></use></g></g><g is="true" transform="translate(1023,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g><g is="true" transform="translate(11851,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="italic" is="true">OA</mi><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TN</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-139"><math><mrow is="true"><mi mathvariant="italic" is="true">OA</mi><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub></mrow><mrow is="true"><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TN</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span><span class="display"><span id="e0090" class="formula"><span class="label">(18)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-140-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>mIoU</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mi is=&quot;true&quot;>K</mi></mfrac><msubsup is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>K</mi></msubsup><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FN</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.444ex" height="3.936ex" viewBox="0 -1111.4 13108 1694.5" role="img" focusable="false" style="vertical-align: -1.354ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-6D"></use><use xlink:href="#MJMATHI-49" x="878" y="0"></use><use xlink:href="#MJMATHI-6F" x="1319" y="0"></use><use xlink:href="#MJMATHI-55" x="1804" y="0"></use></g><g is="true" transform="translate(2765,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(3544,0)"><g transform="translate(397,0)"><rect stroke="none" width="748" height="60" x="0" y="220"></rect><g is="true" transform="translate(197,409)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(60,-393)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g></g></g><g is="true" transform="translate(4977,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(368,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(919,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(7407,0)"><g transform="translate(286,0)"><rect stroke="none" width="5015" height="60" x="0" y="220"></rect><g is="true" transform="translate(1908,521)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(60,-393)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1199,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(1749,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="643" y="0"></use></g></g><g is="true" transform="translate(909,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(2990,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(3540,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-4E" x="643" y="0"></use></g></g><g is="true" transform="translate(1023,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g><g is="true" transform="translate(12829,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="italic" is="true">mIoU</mi><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mn is="true">1</mn><mi is="true">K</mi></mfrac><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-140"><math><mrow is="true"><mi mathvariant="italic" is="true">mIoU</mi><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><mn is="true">1</mn><mi is="true">K</mi></mfrac><msubsup is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></msubsup><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span><span class="display"><span id="e0095" class="formula"><span class="label">(19)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-141-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>precision</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.231ex" height="3.936ex" viewBox="-38.5 -1111.4 9571.7 1694.5" role="img" focusable="false" style="vertical-align: -1.354ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-70"></use><use xlink:href="#MJMATHI-72" x="503" y="0"></use><use xlink:href="#MJMATHI-65" x="955" y="0"></use><use xlink:href="#MJMATHI-63" x="1421" y="0"></use><use xlink:href="#MJMATHI-69" x="1855" y="0"></use><use xlink:href="#MJMATHI-73" x="2200" y="0"></use><use xlink:href="#MJMATHI-69" x="2670" y="0"></use><use xlink:href="#MJMATHI-6F" x="3015" y="0"></use><use xlink:href="#MJMATHI-6E" x="3501" y="0"></use></g></g><g is="true" transform="translate(4101,-231)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(4848,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(5626,0)"><g transform="translate(397,0)"><rect stroke="none" width="3110" height="60" x="0" y="220"></rect><g is="true" transform="translate(955,521)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(60,-393)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1199,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(1749,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="643" y="0"></use></g></g><g is="true" transform="translate(909,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g><g is="true" transform="translate(9254,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">precision</mi></mrow><mi is="true">k</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-141"><math><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">precision</mi></mrow><mi is="true">k</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span><span class="display"><span id="e0100" class="formula"><span class="label">(20)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-142-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>recall</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FN</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></mfrac><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.635ex" height="3.936ex" viewBox="0 -1111.4 8023.5 1694.5" role="img" focusable="false" style="vertical-align: -1.354ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-72"></use><use xlink:href="#MJMATHI-65" x="451" y="0"></use><use xlink:href="#MJMATHI-63" x="918" y="0"></use><use xlink:href="#MJMATHI-61" x="1351" y="0"></use><use xlink:href="#MJMATHI-6C" x="1881" y="0"></use><use xlink:href="#MJMATHI-6C" x="2179" y="0"></use></g></g><g is="true" transform="translate(2478,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(3224,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(4003,0)"><g transform="translate(397,0)"><rect stroke="none" width="3224" height="60" x="0" y="220"></rect><g is="true" transform="translate(1012,521)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(60,-393)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(867,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1199,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(1749,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-4E" x="643" y="0"></use></g></g><g is="true" transform="translate(1023,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g><g is="true" transform="translate(7745,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">recall</mi></mrow><mi is="true">k</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-142"><math><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">recall</mi></mrow><mi is="true">k</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mfrac is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac><mo is="true">,</mo></mrow></math></script></span></span></span><span class="display"><span id="e0105" class="formula"><span class="label">(21)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-143-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>k</mi></msub><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>2</mn><mo is=&quot;true&quot;>&amp;#xD7;</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>precision</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>&amp;#xD7;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>recall</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>precision</mi></mrow><mi is=&quot;true&quot;>k</mi></msub><mo is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>recall</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></mrow></mfrac></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.553ex" height="4.181ex" viewBox="0 -1164.2 11002.1 1800.2" role="img" focusable="false" style="vertical-align: -1.477ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(749,0)"><use xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1250,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1996,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(3052,0)"><use xlink:href="#MJMAIN-32"></use></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(4554,0)"><g transform="translate(342,0)"><rect stroke="none" width="5985" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,577)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-70"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-72" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-65" x="955" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="1421" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1855" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-73" x="2200" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="2670" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="3015" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="3501" y="0"></use></g></g><g is="true" transform="translate(2900,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(3231,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-D7"></use></g><g is="true" transform="translate(3782,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="1351" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="1880" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="2179" y="0"></use></g></g><g is="true" transform="translate(1752,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g><g is="true" transform="translate(60,-402)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-70"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-72" x="503" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-65" x="955" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="1421" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="1855" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-73" x="2200" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-69" x="2670" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6F" x="3015" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6E" x="3501" y="0"></use></g></g><g is="true" transform="translate(2900,-163)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(3231,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(3782,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-65" x="451" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-63" x="918" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-61" x="1351" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="1880" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMATHI-6C" x="2179" y="0"></use></g></g><g is="true" transform="translate(1752,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-6B"></use></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">F</mi><mn is="true">1</mn></mrow><mi is="true">k</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mn is="true">2</mn><mo is="true">×</mo><mfrac is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">precision</mi></mrow><mi is="true">k</mi></msub><mo is="true">×</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">recall</mi></mrow><mi is="true">k</mi></msub></mrow><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">precision</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">recall</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac></mrow></math></span></span><script type="math/mml" id="MathJax-Element-143"><math><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">F</mi><mn is="true">1</mn></mrow><mi is="true">k</mi></msub><mo linebreak="goodbreak" is="true">=</mo><mn is="true">2</mn><mo is="true">×</mo><mfrac is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">precision</mi></mrow><mi is="true">k</mi></msub><mo is="true">×</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">recall</mi></mrow><mi is="true">k</mi></msub></mrow><mrow is="true"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">precision</mi></mrow><mi is="true">k</mi></msub><mo is="true">+</mo><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">recall</mi></mrow><mi is="true">k</mi></msub></mrow></mfrac></mrow></math></script></span></span></span></p><p id="p0240">where <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-144-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="3.939ex" height="2.218ex" viewBox="0 -741.6 1695.8 954.9" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-54"></use><use xlink:href="#MJMATHI-50" x="584" y="0"></use></g></g><g is="true" transform="translate(1227,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-144"><math><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TP</mi></mrow><mi is="true">k</mi></msub></math></script></span>, <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-145-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FP</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.076ex" height="2.218ex" viewBox="0 -741.6 1754.8 954.9" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-46"></use><use xlink:href="#MJMATHI-50" x="643" y="0"></use></g></g><g is="true" transform="translate(1286,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-145"><math><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FP</mi></mrow><mi is="true">k</mi></msub></math></script></span>, <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-146-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>TN</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.312ex" height="2.218ex" viewBox="0 -741.6 1856.8 954.9" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-54"></use><use xlink:href="#MJMATHI-4E" x="584" y="0"></use></g></g><g is="true" transform="translate(1388,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TN</mi></mrow><mi is="true">k</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-146"><math><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">TN</mi></mrow><mi is="true">k</mi></msub></math></script></span>, and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-147-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;italic&quot; is=&quot;true&quot;>FN</mi></mrow><mi is=&quot;true&quot;>k</mi></msub></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.45ex" height="2.218ex" viewBox="0 -741.6 1915.8 954.9" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-46"></use><use xlink:href="#MJMATHI-4E" x="643" y="0"></use></g></g><g is="true" transform="translate(1447,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></math></span></span><script type="math/mml" id="MathJax-Element-147"><math><msub is="true"><mrow is="true"><mi mathvariant="italic" is="true">FN</mi></mrow><mi is="true">k</mi></msub></math></script></span> represent the true positive, false positive, true negative, and false negatives, respectively, for a particular object indexed as class <em>k</em>. The OA was computed for all categories including the background class.</p></section><section id="s0085"><h3 id="st095" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.2. Experimental results</h3><p id="p0245"><dl class="list"><dt class="list-label">a)</dt><dd class="list-description"><p id="p0250">Ablation study</p></dd></dl></p><div><p id="p0255">To evaluate the effectiveness of the components in the proposed ABCNet, we conducted extensive ablation experiments; the setting details and quantitative results are listed in <a name="bt0005" href="#t0005" class="workspace-trigger">Table 1</a>.</p><div class="tables frame-topbot rowsep-0 colsep-0" id="t0005"><span class="captions"><span id="cn0055"><p id="sp0060"><span class="label">Table 1</span>. Ablation study of each component in the proposed ABCNet.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" class="align-left">Dataset</th><th scope="col" class="align-left">Method</th><th scope="col" class="align-char">Mean F1</th><th scope="col" class="align-char">OA (%)</th><th scope="col" class="align-char">mIoU (%)</th></tr></thead><tbody><tr class="valign-top"><td class="align-left" rowspan="5">Vaihingen</td><td class="align-left">Cp</td><td class="align-char">83.9</td><td class="align-char">88.1</td><td class="align-char">73.9</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;AEM</td><td class="align-char">85.8</td><td class="align-char">88.8</td><td class="align-char">75.6</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM(Sum)</td><td class="align-char">86.6</td><td class="align-char">89.8</td><td class="align-char">77.4</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM(Cat)</td><td class="align-char">87.1</td><td class="align-char">89.7</td><td class="align-char">77.8</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM&nbsp;+&nbsp;FAM</td><td class="align-char">89.5</td><td class="align-char">90.7</td><td class="align-char">81.3</td></tr><tr class="valign-top"><td class="align-left" rowspan="5">Potsdam</td><td class="align-left">Cp</td><td class="align-char">89.7</td><td class="align-char">87.9</td><td class="align-char">81.6</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;AEM</td><td class="align-char">90.6</td><td class="align-char">89.3</td><td class="align-char">83.0</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM(Sum)</td><td class="align-char">91.0</td><td class="align-char">89.4</td><td class="align-char">83.4</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM(Cat)</td><td class="align-char">91.2</td><td class="align-char">89.8</td><td class="align-char">84.1</td></tr><tr class="valign-top"><td class="align-left">Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM&nbsp;+&nbsp;FAM</td><td class="align-char">92.7</td><td class="align-char">91.3</td><td class="align-char">86.5</td></tr></tbody></table></div></div></div><p id="p0260"><strong>Baseline</strong>: The baseline was constructed based on the contextual path, while the generated feature maps were up-sampled directly to the same shape as the original input image.</p><p id="p0265"><strong>Ablation for attention enhancement module</strong>: To capture the global contextual information, we designed an attention enhancement module (AEM) in the contextual path. As presented in <a name="bt0005" href="#t0005" class="workspace-trigger">Table 1</a>, for two datasets, the utilization of AEM (indicated as Cp&nbsp;+&nbsp;AEM) produced an increase of greater than 1.4% in the mIoU.</p><p id="p0270"><strong>Ablation for the spatial path</strong>: <a name="bt0005" href="#t0005" class="workspace-trigger">Table 1</a> demonstrates that even simple fusion schemes for merging spatial information such as summation (represented as Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM(Sum)) and concatenation (represented as Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM(Cat)) boosted the performance of the mIoU by about 1.8% on Vaihingen dataset, and 0.4% on Potsdam dataset.</p><p id="p0275"><strong>Ablation for feature aggregation module</strong>: As shown in <a name="bt0005" href="#t0005" class="workspace-trigger">Table 1</a>, the significant gap in performance (more than 2.4% in the mIoU) demonstrates the validity of the feature aggregation module (signified as Cp&nbsp;+&nbsp;Sp&nbsp;+&nbsp;AEM&nbsp;+&nbsp;FAM).<dl class="list"><dt class="list-label">b)</dt><dd class="list-description"><p id="p0280">The complexity and speed of the network</p></dd></dl></p><div><p id="p0285">Complexity and speed are important criteria for measuring the merit of an algorithm, and this is especially true for practical applications. We first compared the computation and memory requirements between the linear attention mechanism and dot-product attention mechanism which can be found in <a name="bf0030" href="#f0030" class="workspace-trigger">Fig. 6</a>.</p><figure class="figure text-xs" id="f0030"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr6.jpg" height="212" alt="" aria-describedby="cn0030"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr6_lrg.jpg" target="_blank" download="" title="Download high-res image (177KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (177KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr6.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0030"><p id="sp0035"><span class="label">Fig. 6</span>. Comparison between the (a) computational and (b) memory requirements of the linear attention mechanism and dot-product attention mechanism under different input sizes. The calculation assumes <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-148-Frame" tabindex="0" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mo is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>D</mi></mrow><mi is=&quot;true&quot;>v</mi></msub><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>2</mn><msub is=&quot;true&quot;><mi is=&quot;true&quot;>D</mi><mi is=&quot;true&quot;>k</mi></msub><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>64</mn></mrow></math>" role="presentation" style="font-size: 90%; display: inline-block; position: relative;"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.516ex" height="2.354ex" viewBox="0 -774 8833.2 1013.6" role="img" focusable="false" style="vertical-align: -0.556ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(1038,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2094,0)"><use xlink:href="#MJMATHI-44"></use></g></g><g is="true" transform="translate(2923,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-76"></use></g></g><g is="true" transform="translate(3644,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(4700,0)"><use xlink:href="#MJMAIN-32"></use></g><g is="true" transform="translate(5200,0)"><g is="true"><use xlink:href="#MJMATHI-44"></use></g><g is="true" transform="translate(828,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(6775,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(7832,0)"><use xlink:href="#MJMAIN-36"></use><use xlink:href="#MJMAIN-34" x="500" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">C</mi><mo is="true">=</mo><mi is="true">D</mi></mrow><mi is="true">v</mi></msub><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mn is="true">2</mn><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mn is="true">64</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-148"><math><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">C</mi><mo is="true">=</mo><mi is="true">D</mi></mrow><mi is="true">v</mi></msub><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mn is="true">2</mn><msub is="true"><mi is="true">D</mi><mi is="true">k</mi></msub><mo linebreak="goodbreak" linebreakstyle="after" is="true">=</mo><mn is="true">64</mn></mrow></math></script></span>. MM denotes 1 Mega multiply-accumulation (MACC), where 1 MACC means 1 multiplication and 1 addition operation. GM means 1 Giga MACC, while TM signifies 1 Tera MACC. Similarly, MB, GB, and TB represent 1 MegaByte, 1 GigaByte, and 1 TeraByte, respectively. Note the figure is shown on the log scale.</p></span></span></figure></div><div><p id="p0290">For a comprehensive comparison, we further implemented the experiments under different settings. A comparison between the parameters and computational complexity of the different networks is reported in <a name="bt0010" href="#t0010" class="workspace-trigger">Table 2</a>. The proposed ABCNet maintained both high speed and high accuracy simultaneously. As listed in the last column of <a name="bt0010" href="#t0010" class="workspace-trigger">Table 2</a>, the mIoU on the Potsdam dataset achieved by the ABCNet is at least 2.0% higher than the benchmark methods. Meanwhile, the ABCNet was able to achieve a 72.13 FPS speed for a 512&nbsp;×&nbsp;512 input. The remarkable performance of the speed and occupation of memory not only derives from the linear attention mechanism but also results from that we only utilized the AEM in deeper layers with small spatial dimensionality. Besides, the elaborate design enabled the ABCNet to handle the massive input (4096&nbsp;×&nbsp;4096), while more than half of the benchmark methods ran out of memory for a such large input.<dl class="list"><dt class="list-label">c)</dt><dd class="list-description"><p id="p0295">Results on the ISPRS Vaihingen and Potsdam datasets</p></dd></dl></p><div class="tables frame-topbot rowsep-0 colsep-0" id="t0010"><span class="captions"><span id="cn0060"><p id="sp0065"><span class="label">Table 2</span>. The complexity and speed of the proposed ABCNet and lightweight methods. 'G' indicates Gillion (i.e., units for the number of floating point operations) and 'M' signifies Million (i.e., units for the number of parameters). For an extensive comparison, we chose 256&nbsp;×&nbsp;256, 512&nbsp;×&nbsp;512, 1024&nbsp;×&nbsp;1024, 2048&nbsp;×&nbsp;2048, and 4096&nbsp;×&nbsp;4096 pixels as the sizes of the input image and report the inference speed measured in frames per second (FPS) on a midrange notebook graphics card 1660Ti. mIoU is measured using patches of 512&nbsp;×&nbsp;512 pixels, where the first number is the mIoU on the Vaihingen dataset and the second one is on the Potsdam dataset.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" class="align-left">Method</th><th scope="col" class="align-left">Backbone</th><th scope="col" class="align-char">Complexity(G)</th><th scope="col" class="align-char">Parameters(M)</th><th scope="col" class="align-char">256&nbsp;×&nbsp;256</th><th scope="col" class="align-char">512&nbsp;×&nbsp;512</th><th scope="col" class="align-char">1024&nbsp;×&nbsp;1024</th><th scope="col" class="align-char">2048&nbsp;×&nbsp;2048</th><th scope="col" class="align-left">4096&nbsp;×&nbsp;4096</th><th scope="col" class="align-left">mIoU</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">DABNet (<a name="bb0145" href="#b0145" class="workspace-trigger">Li et al., 2019a</a>)</td><td class="align-left">–</td><td class="align-char">5.22</td><td class="align-char">0.75</td><td class="align-char">90.67</td><td class="align-char">87.74</td><td class="align-char">27.41</td><td class="align-char">7.44</td><td class="align-left">*</td><td class="align-left">70.2/79.6</td></tr><tr class="valign-top"><td class="align-left">ERFNet (<a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a>)</td><td class="align-left">–</td><td class="align-char">14.75</td><td class="align-char">2.06</td><td class="align-char">90.51</td><td class="align-char">59.04</td><td class="align-char">17.59</td><td class="align-char">4.87</td><td class="align-left">1.25</td><td class="align-left">69.1/76.2</td></tr><tr class="valign-top"><td class="align-left">BiSeNetV1 (<a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>)</td><td class="align-left">ResNet18</td><td class="align-char">15.25</td><td class="align-char">13.61</td><td class="align-char">143.50</td><td class="align-char">87.63</td><td class="align-char">25.89</td><td class="align-char">7.23</td><td class="align-left">1.84</td><td class="align-left">75.8/81.7</td></tr><tr class="valign-top"><td class="align-left">PSPNet (<a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a>)</td><td class="align-left">ResNet18</td><td class="align-char">12.55</td><td class="align-char">24.03</td><td class="align-char">151.12</td><td class="align-char">105.03</td><td class="align-char">34.83</td><td class="align-char">10.16</td><td class="align-left">2.66</td><td class="align-left">68.6/75.9</td></tr><tr class="valign-top"><td class="align-left">BiSeNetV2 (<a name="bb0325" href="#b0325" class="workspace-trigger">Yu et al., 2020</a>)</td><td class="align-left">–</td><td class="align-char">13.91</td><td class="align-char">12.30</td><td class="align-char">124.49</td><td class="align-char">82.84</td><td class="align-char">25.64</td><td class="align-char">7.07</td><td class="align-left">*</td><td class="align-left">75.5/82.3</td></tr><tr class="valign-top"><td class="align-left">DANet (<a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a>)</td><td class="align-left">ResNet18</td><td class="align-char">9.90</td><td class="align-char">12.68</td><td class="align-char">181.66</td><td class="align-char">124.18</td><td class="align-char">40.80</td><td class="align-char">11.42</td><td class="align-left">*</td><td class="align-left">69.4/80.3</td></tr><tr class="valign-top"><td class="align-left">FANet (<a name="bb9005" href="#b9005" class="workspace-trigger">Hu et al., 2020</a>)</td><td class="align-left">ResNet18</td><td class="align-char">21.66</td><td class="align-char">13.81</td><td class="align-char">112.59</td><td class="align-char">67.97</td><td class="align-char">20.41</td><td class="align-char">5.57</td><td class="align-left">*</td><td class="align-left">75.6/84.2</td></tr><tr class="valign-top"><td class="align-left">ShelfNet (<a name="bb0390" href="#b0390" class="workspace-trigger">Zhuang et al., 2019</a>)</td><td class="align-left">ResNet18</td><td class="align-char">12.36</td><td class="align-char">14.58</td><td class="align-char">123.59</td><td class="align-char">90.41</td><td class="align-char">30.93</td><td class="align-char">9.06</td><td class="align-left">2.40</td><td class="align-left">78.7/84.4</td></tr><tr class="valign-top"><td class="align-left">SwiftNet (<a name="bb0225" href="#b0225" class="workspace-trigger">Oršić and Šegvić, 2021</a>)</td><td class="align-left">ResNet18</td><td class="align-char">13.08</td><td class="align-char">11.80</td><td class="align-char">157.63</td><td class="align-char">97.62</td><td class="align-char">30.79</td><td class="align-char">8.65</td><td class="align-left">*</td><td class="align-left">78.3/83.8</td></tr><tr class="valign-top"><td class="align-left">MAResU-Net (<a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>)</td><td class="align-left">ResNet18</td><td class="align-char">25.43</td><td class="align-char">16.17</td><td class="align-char">70.12</td><td class="align-char">37.55</td><td class="align-char">13.35</td><td class="align-char">3.51</td><td class="align-left">*</td><td class="align-left">78.6/83.9</td></tr><tr class="valign-top"><td class="align-left">EaNet (<a name="bb0375" href="#b0375" class="workspace-trigger">Zheng et al., 2020</a>)</td><td class="align-left">ResNet18</td><td class="align-char">18.75</td><td class="align-char">34.23</td><td class="align-char">73.98</td><td class="align-char">55.95</td><td class="align-char">17.94</td><td class="align-char">5.53</td><td class="align-left">1.54</td><td class="align-left">79.6/83.4</td></tr><tr class="valign-top"><td class="align-left">ABCNet</td><td class="align-left">ResNet18</td><td class="align-char">18.72</td><td class="align-char">14.06</td><td class="align-char">113.09</td><td class="align-char">72.13</td><td class="align-char">22.73</td><td class="align-char">6.23</td><td class="align-left">1.60</td><td class="align-left">81.3/86.5</td></tr></tbody></table></div><p class="legend"><p id="sp0070">* means the network runs out of memory.</p></p></div></div><div><p id="p0300">The ISPRS Vaihingen is a relatively small dataset. All images represent the same city, such that the statistical characters of the training and test datasets are similar (<a name="bb0075" href="#b0075" class="workspace-trigger">Ghassemi et al., 2019</a><span>). Therefore, high accuracy can be achieved relatively easily by specifically designed networks, especially for those that fuse <a href="/topics/earth-and-planetary-sciences/orthophoto" title="Learn more about orthophoto from ScienceDirect's AI-generated Topic Pages" class="topic-link">orthophoto</a> (TOP) images with auxiliary DSMs or NDSMs. In this section, we demonstrate that the proposed ABCNet model using only TOP images with an efficient architecture can not only transcend lightweight networks (</span><a name="bt0015" href="#t0015" class="workspace-trigger">Table 3</a>) but also achieve highly competitive accuracy compared to specially designed models (<a name="bt0020" href="#t0020" class="workspace-trigger">Table 4</a>).</p><div class="tables frame-topbot rowsep-0 colsep-0" id="t0015"><span class="captions"><span id="cn0065"><p id="sp0075"><span class="label">Table 3</span>. <a href="/topics/computer-science/quantitative-comparison" title="Learn more about Quantitative comparison from ScienceDirect's AI-generated Topic Pages" class="topic-link">Quantitative comparison</a> results on the Vaihingen test set with the lightweight networks.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" class="align-left">Method</th><th scope="col" class="align-left">Backbone</th><th scope="col" class="align-char">Imp. surf.</th><th scope="col" class="align-char">Building</th><th scope="col" class="align-char">Low veg.</th><th scope="col" class="align-char">Tree</th><th scope="col" class="align-char">Car</th><th scope="col" class="align-char">Mean F1</th><th scope="col" class="align-char">OA (%)</th><th scope="col" class="align-char">mIoU (%)</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">DABNet (<a name="bb0145" href="#b0145" class="workspace-trigger">Li et al., 2019a</a>)</td><td class="align-left">–</td><td class="align-char">87.8</td><td class="align-char">88.8</td><td class="align-char">74.3</td><td class="align-char">84.9</td><td class="align-char">60.2</td><td class="align-char">79.2</td><td class="align-char">84.3</td><td class="align-char">70.2</td></tr><tr class="valign-top"><td class="align-left">ERFNet (<a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a>)</td><td class="align-left">–</td><td class="align-char">88.5</td><td class="align-char">90.2</td><td class="align-char">76.4</td><td class="align-char">85.8</td><td class="align-char">53.6</td><td class="align-char">78.9</td><td class="align-char">85.8</td><td class="align-char">69.1</td></tr><tr class="valign-top"><td class="align-left">BiSeNetV1 (<a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>)</td><td class="align-left">ResNet18</td><td class="align-char">89.1</td><td class="align-char">91.3</td><td class="align-char">80.9</td><td class="align-char">86.9</td><td class="align-char">73.1</td><td class="align-char">84.3</td><td class="align-char">87.1</td><td class="align-char">75.8</td></tr><tr class="valign-top"><td class="align-left">PSPNet (<a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a>)</td><td class="align-left">ResNet18</td><td class="align-char">89.0</td><td class="align-char">93.2</td><td class="align-char">81.5</td><td class="align-char">87.7</td><td class="align-char">43.9</td><td class="align-char">79.0</td><td class="align-char">87.7</td><td class="align-char">68.6</td></tr><tr class="valign-top"><td class="align-left">BiSeNetV2 (<a name="bb0325" href="#b0325" class="workspace-trigger">Yu et al., 2020</a>)</td><td class="align-left">–</td><td class="align-char">89.9</td><td class="align-char">91.9</td><td class="align-char">82.0</td><td class="align-char">88.3</td><td class="align-char">71.4</td><td class="align-char">84.7</td><td class="align-char">88.0</td><td class="align-char">75.5</td></tr><tr class="valign-top"><td class="align-left">DANet (<a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a>)</td><td class="align-left">ResNet18</td><td class="align-char">90.0</td><td class="align-char">93.9</td><td class="align-char">82.2</td><td class="align-char">87.3</td><td class="align-char">44.5</td><td class="align-char">79.6</td><td class="align-char">88.2</td><td class="align-char">69.4</td></tr><tr class="valign-top"><td class="align-left">FANet (<a name="bb9005" href="#b9005" class="workspace-trigger">Hu et al., 2020</a>)</td><td class="align-left">ResNet18</td><td class="align-char">90.7</td><td class="align-char">93.8</td><td class="align-char">82.6</td><td class="align-char">88.6</td><td class="align-char">71.6</td><td class="align-char">85.4</td><td class="align-char">88.9</td><td class="align-char">75.6</td></tr><tr class="valign-top"><td class="align-left">EaNet (<a name="bb0375" href="#b0375" class="workspace-trigger">Zheng et al., 2020</a>)</td><td class="align-left">ResNet18</td><td class="align-char">91.7</td><td class="align-char">94.5</td><td class="align-char">83.1</td><td class="align-char">89.2</td><td class="align-char">80.0</td><td class="align-char">87.7</td><td class="align-char">89.7</td><td class="align-char">78.7</td></tr><tr class="valign-top"><td class="align-left">ShelfNet (<a name="bb0390" href="#b0390" class="workspace-trigger">Zhuang et al., 2019</a>)</td><td class="align-left">ResNet18</td><td class="align-char">91.8</td><td class="align-char">94.6</td><td class="align-char">83.8</td><td class="align-char">89.3</td><td class="align-char">77.9</td><td class="align-char">87.5</td><td class="align-char">89.8</td><td class="align-char">78.3</td></tr><tr class="valign-top"><td class="align-left">MAResU-Net (<a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>)</td><td class="align-left">ResNet18</td><td class="align-char">92.0</td><td class="align-char">95.0</td><td class="align-char">83.7</td><td class="align-char">89.3</td><td class="align-char">78.3</td><td class="align-char">87.7</td><td class="align-char">90.1</td><td class="align-char">78.6</td></tr><tr class="valign-top"><td class="align-left">SwiftNet (<a name="bb0225" href="#b0225" class="workspace-trigger">Oršić and Šegvić, 2021</a>)</td><td class="align-left">ResNet18</td><td class="align-char">92.2</td><td class="align-char">94.8</td><td class="align-char">84.1</td><td class="align-char">89.3</td><td class="align-char">81.2</td><td class="align-char">88.3</td><td class="align-char">90.2</td><td class="align-char">79.6</td></tr><tr class="valign-top"><td class="align-left">ABCNet</td><td class="align-left">ResNet18</td><td class="align-char"><strong>92.7</strong></td><td class="align-char"><strong>95.2</strong></td><td class="align-char"><strong>84.5</strong></td><td class="align-char"><strong>89.7</strong></td><td class="align-char"><strong>85.3</strong></td><td class="align-char"><strong>89.5</strong></td><td class="align-char"><strong>90.7</strong></td><td class="align-char"><strong>81.3</strong></td></tr></tbody></table></div></div><div class="tables frame-topbot rowsep-0 colsep-0" id="t0020"><span class="captions"><span id="cn0070"><p id="sp0080"><span class="label">Table 4</span>. <a href="/topics/computer-science/quantitative-comparison" title="Learn more about Quantitative comparison from ScienceDirect's AI-generated Topic Pages" class="topic-link">Quantitative comparison</a> results on the Vaihingen test set with the state-of-the-art networks.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" class="align-left">Method</th><th scope="col" class="align-left">Backbone</th><th scope="col" class="align-char">Imp. surf.</th><th scope="col" class="align-char">Building</th><th scope="col" class="align-char">Low veg.</th><th scope="col" class="align-char">Tree</th><th scope="col" class="align-char">Car</th><th scope="col" class="align-char">Mean F1</th><th scope="col" class="align-char">OA (%)</th><th scope="col" class="align-char">mIoU (%)</th><th scope="col" class="align-char">Speed</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">DeepLabV3+ (<a name="bb0035" href="#b0035" class="workspace-trigger">Chen et al., 2018a</a>)</td><td class="align-left">ResNet101</td><td class="align-char">92.4</td><td class="align-char">95.2</td><td class="align-char">84.3</td><td class="align-char">89.5</td><td class="align-char">86.5</td><td class="align-char">89.6</td><td class="align-char">90.6</td><td class="align-char">81.5</td><td class="align-char">13.27</td></tr><tr class="valign-top"><td class="align-left">PSPNet (<a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a>)</td><td class="align-left">ResNet101</td><td class="align-char">92.8</td><td class="align-char">95.5</td><td class="align-char">84.5</td><td class="align-char">89.9</td><td class="align-char"><strong>88.6</strong></td><td class="align-char">90.3</td><td class="align-char">90.9</td><td class="align-char"><strong>82.6</strong></td><td class="align-char">22.03</td></tr><tr class="valign-top"><td class="align-left">DANet (<a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a>)</td><td class="align-left">ResNet101</td><td class="align-char">91.6</td><td class="align-char">95.0</td><td class="align-char">83.3</td><td class="align-char">88.9</td><td class="align-char">87.2</td><td class="align-char">89.2</td><td class="align-char">90.4</td><td class="align-char">81.3</td><td class="align-char">21.97</td></tr><tr class="valign-top"><td class="align-left">EaNet (<a name="bb0375" href="#b0375" class="workspace-trigger">Zheng et al., 2020</a>)</td><td class="align-left">ResNet101</td><td class="align-char"><strong>93.4</strong></td><td class="align-char"><strong>96.2</strong></td><td class="align-char">85.6</td><td class="align-char">90.5</td><td class="align-char">88.3</td><td class="align-char"><strong>90.8</strong></td><td class="align-char">91.2</td><td class="align-char">–</td><td class="align-char">9.97</td></tr><tr class="valign-top"><td class="align-left">DDCM-Net (<a name="bb0185" href="#b0185" class="workspace-trigger">Liu et al., 2020</a>)</td><td class="align-left">ResNet50</td><td class="align-char">92.7</td><td class="align-char">95.3</td><td class="align-char">83.3</td><td class="align-char">89.4</td><td class="align-char">88.3</td><td class="align-char">89.8</td><td class="align-char">90.4</td><td class="align-char">–</td><td class="align-char">37.28</td></tr><tr class="valign-top"><td class="align-left">HUSTW5 (<a name="bb0260" href="#b0260" class="workspace-trigger">Sun et al., 2019</a>)</td><td class="align-left">ResegNets</td><td class="align-char">93.3</td><td class="align-char">96.1</td><td class="align-char"><strong>86.4</strong></td><td class="align-char"><strong>90.8</strong></td><td class="align-char">74.6</td><td class="align-char">88.2</td><td class="align-char"><strong>91.6</strong></td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">CASIA2 (<a name="bb0190" href="#b0190" class="workspace-trigger">Liu et al., 2018</a>)</td><td class="align-left">ResNet101</td><td class="align-char">93.2</td><td class="align-char">96.0</td><td class="align-char">84.7</td><td class="align-char">89.9</td><td class="align-char">86.7</td><td class="align-char">90.1</td><td class="align-char">91.1</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">V-FuseNet# (<a name="bb0005" href="#b0005" class="workspace-trigger">Audebert et al., 2018</a>)</td><td class="align-left">FuseNet</td><td class="align-char">91.0</td><td class="align-char">94.4</td><td class="align-char">84.5</td><td class="align-char">89.9</td><td class="align-char">86.3</td><td class="align-char">89.2</td><td class="align-char">90.0</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">DLR_9# (<a name="bb0220" href="#b0220" class="workspace-trigger">Marmanis et al., 2018</a>)</td><td class="align-left">–</td><td class="align-char">92.4</td><td class="align-char">95.2</td><td class="align-char">83.9</td><td class="align-char">89.9</td><td class="align-char">81.2</td><td class="align-char">88.5</td><td class="align-char">90.3</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">ABCNet</td><td class="align-left">ResNet18</td><td class="align-char">92.7</td><td class="align-char">95.2</td><td class="align-char">84.5</td><td class="align-char">89.7</td><td class="align-char">85.3</td><td class="align-char">89.5</td><td class="align-char">90.7</td><td class="align-char">81.3</td><td class="align-char"><strong>72.13</strong></td></tr></tbody></table></div><p class="legend"><p id="sp0085">- means the results are not reported in the original paper.</p><p id="sp0090"># means the DSM or NDSM are used in the network.</p></p></div></div><div><p id="p0305">As shown in <a name="bt0015" href="#t0015" class="workspace-trigger">Table 3</a>, the numeric scores for the ISPRS Vaihingen test dataset demonstrated that ABCNet delivers high accuracy, exceeding other lightweight networks in the mean F1, OA, and mIoU by a significant margin. Particularly, the ‘‘car’’ class in the Vaihingen dataset is difficult to handle as it is a relatively small object. Nonetheless, ABCNet produced an 85.3% F1 score for this class, which is at least 4.1% higher than for the benchmark methods. In addition, we visualize area 27 in <a name="bf0035" href="#f0035" class="workspace-trigger">Fig. 7</a> to qualitatively demonstrate the effectiveness of ABCNet, while the enlarged results are shown in <a name="bf0045" href="#f0045" class="workspace-trigger">Fig. 9</a> (top).</p><figure class="figure text-xs" id="f0035"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr7.jpg" height="746" alt="" aria-describedby="cn0035"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr7_lrg.jpg" target="_blank" download="" title="Download high-res image (1MB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (1MB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr7.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0035"><p id="sp0040"><span class="label">Fig. 7</span>. Mapping results for test images of Vaihingen tile-27.</p></span></span></figure><figure class="figure text-xs" id="f0040"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr8.jpg" height="517" alt="" aria-describedby="cn0040"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr8_lrg.jpg" target="_blank" download="" title="Download high-res image (1MB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (1MB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr8.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0040"><p id="sp0045"><span class="label">Fig. 8</span>. Mapping results for the test images of Potsdam tile-3_13.</p></span></span></figure><figure class="figure text-xs" id="f0045"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr9.jpg" height="890" alt="" aria-describedby="cn0045"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr9_lrg.jpg" target="_blank" download="" title="Download high-res image (1003KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (1003KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr9.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0045"><p id="sp0050"><span class="label">Fig. 9</span>. Enlarged visualization of results on (top) the Vaihingen and (bottom) Potsdam datasets.</p></span></span></figure></div><p id="p0310">For a comprehensive evaluation, ABCNet was also compared with other state-of-the-art methods. As can be seen in <a name="bt0020" href="#t0020" class="workspace-trigger">Table 4</a>, as a lightweight network, the proposed ABCNet achieved a competitive performance even compared with those models designed with complex structures. It is worth noting that the speed of ABCNet is <u>two</u>-to-<u>seven</u> times faster than those methods.</p><div><p id="p0315">Furthermore, we undertook experiments on the ISPRS Potsdam dataset to further evaluate the performance of ABCNet. Compared with the encoder-decoder structure, the bilateral architecture can retain more spatial information without reducing the speed of the model (<a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a><span>). The spatial path stacks only three <a href="/topics/computer-science/convolution-layer" title="Learn more about convolution layers from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolution layers</a> to generate 1/8 feature maps, while the contextual path includes two attention enhancement modules (AEM) to refine the features and capture contextual information. Numerical comparisons with other lightweight methods are shown in </span><a name="bt0025" href="#t0025" class="workspace-trigger">Table 5</a>. Remarkably, ABCNet achieved 91.3% overall accuracy and 86.5% in mIoU. Visualization of area 3_13 is displayed in <a name="bf0040" href="#f0040" class="workspace-trigger">Fig. 8</a>, and the enlarged results are exhibited in <a name="bf0045" href="#f0045" class="workspace-trigger">Fig. 9</a> (bottom). As there are sufficient images in the Potsdam dataset to train the network, the performance of ABCNet can be equivalent to the state-of-the-art methods with a much faster speed. The comparison results are listed in <a name="bt0030" href="#t0030" class="workspace-trigger">Table 6</a>.</p><div class="tables frame-topbot rowsep-0 colsep-0" id="t0025"><span class="captions"><span id="cn0075"><p id="sp0095"><span class="label">Table 5</span>. <a href="/topics/computer-science/quantitative-comparison" title="Learn more about Quantitative comparison from ScienceDirect's AI-generated Topic Pages" class="topic-link">Quantitative comparison</a> results on the Potsdam test set with the lightweight networks.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" class="align-left">Method</th><th scope="col" class="align-left">Backbone</th><th scope="col" class="align-char">Imp. surf.</th><th scope="col" class="align-char">Building</th><th scope="col" class="align-char">Low veg.</th><th scope="col" class="align-char">Tree</th><th scope="col" class="align-char">Car</th><th scope="col" class="align-char">Mean F1</th><th scope="col" class="align-char">OA (%)</th><th scope="col" class="align-char">mIoU (%)</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">ERFNet (<a name="bb9010" href="#b9010" class="workspace-trigger">Romera et al., 2017</a>)</td><td class="align-left">–</td><td class="align-char">88.7</td><td class="align-char">93.0</td><td class="align-char">81.1</td><td class="align-char">75.8</td><td class="align-char">90.5</td><td class="align-char">85.8</td><td class="align-char">84.5</td><td class="align-char">76.2</td></tr><tr class="valign-top"><td class="align-left">DABNet (<a name="bb0145" href="#b0145" class="workspace-trigger">Li et al., 2019a</a>)</td><td class="align-left">–</td><td class="align-char">89.9</td><td class="align-char">93.2</td><td class="align-char">83.6</td><td class="align-char">82.3</td><td class="align-char">92.6</td><td class="align-char">88.3</td><td class="align-char">86.7</td><td class="align-char">79.6</td></tr><tr class="valign-top"><td class="align-left">PSPNet (<a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a>)</td><td class="align-left">ResNet18</td><td class="align-char">89.1</td><td class="align-char">94.5</td><td class="align-char">84.0</td><td class="align-char">85.8</td><td class="align-char">76.6</td><td class="align-char">86.0</td><td class="align-char">87.2</td><td class="align-char">75.9</td></tr><tr class="valign-top"><td class="align-left">BiSeNetV1 (<a name="bb0330" href="#b0330" class="workspace-trigger">Yu et al., 2018</a>)</td><td class="align-left">ResNet18</td><td class="align-char">90.2</td><td class="align-char">94.6</td><td class="align-char">85.5</td><td class="align-char">86.2</td><td class="align-char">92.7</td><td class="align-char">89.8</td><td class="align-char">88.2</td><td class="align-char">81.7</td></tr><tr class="valign-top"><td class="align-left">BiSeNetV2 (<a name="bb0325" href="#b0325" class="workspace-trigger">Yu et al., 2020</a>)</td><td class="align-left">–</td><td class="align-char">91.3</td><td class="align-char">94.3</td><td class="align-char">85.0</td><td class="align-char">85.2</td><td class="align-char">94.1</td><td class="align-char">90.0</td><td class="align-char">88.2</td><td class="align-char">82.3</td></tr><tr class="valign-top"><td class="align-left">EaNet (<a name="bb0375" href="#b0375" class="workspace-trigger">Zheng et al., 2020</a>)</td><td class="align-left">ResNet18</td><td class="align-char">92.0</td><td class="align-char">95.7</td><td class="align-char">84.3</td><td class="align-char">85.7</td><td class="align-char">95.1</td><td class="align-char">90.6</td><td class="align-char">88.7</td><td class="align-char">83.4</td></tr><tr class="valign-top"><td class="align-left">MAResU-Net (<a name="bb0160" href="#b0160" class="workspace-trigger">Li et al., 2021b</a>)</td><td class="align-left">ResNet18</td><td class="align-char">91.4</td><td class="align-char">95.6</td><td class="align-char">85.8</td><td class="align-char">86.6</td><td class="align-char">93.3</td><td class="align-char">90.5</td><td class="align-char">89.0</td><td class="align-char">83.9</td></tr><tr class="valign-top"><td class="align-left">DANet (<a name="bb0070" href="#b0070" class="workspace-trigger">Fu et al., 2019</a>)</td><td class="align-left">ResNet18</td><td class="align-char">91.0</td><td class="align-char">95.6</td><td class="align-char">86.1</td><td class="align-char">87.6</td><td class="align-char">84.3</td><td class="align-char">88.9</td><td class="align-char">89.1</td><td class="align-char">80.3</td></tr><tr class="valign-top"><td class="align-left">SwiftNet (<a name="bb0225" href="#b0225" class="workspace-trigger">Oršić and Šegvić, 2021</a>)</td><td class="align-left">ResNet18</td><td class="align-char">91.8</td><td class="align-char">95.9</td><td class="align-char">85.7</td><td class="align-char">86.8</td><td class="align-char">94.5</td><td class="align-char">91.0</td><td class="align-char">89.3</td><td class="align-char">83.8</td></tr><tr class="valign-top"><td class="align-left">FANet (<a name="bb9005" href="#b9005" class="workspace-trigger">Hu et al., 2020</a>)</td><td class="align-left">ResNet18</td><td class="align-char">92.0</td><td class="align-char">96.1</td><td class="align-char">86.0</td><td class="align-char">87.8</td><td class="align-char">94.5</td><td class="align-char">91.3</td><td class="align-char">89.8</td><td class="align-char">84.2</td></tr><tr class="valign-top"><td class="align-left">ShelfNet (<a name="bb0390" href="#b0390" class="workspace-trigger">Zhuang et al., 2019</a>)</td><td class="align-left">ResNet18</td><td class="align-char">92.5</td><td class="align-char">95.8</td><td class="align-char">86.6</td><td class="align-char">87.1</td><td class="align-char">94.6</td><td class="align-char">91.3</td><td class="align-char">89.9</td><td class="align-char">84.4</td></tr><tr class="valign-top"><td class="align-left">ABCNet</td><td class="align-left">ResNet18</td><td class="align-char"><strong>93.5</strong></td><td class="align-char"><strong>96.9</strong></td><td class="align-char"><strong>87.9</strong></td><td class="align-char"><strong>89.1</strong></td><td class="align-char"><strong>95.8</strong></td><td class="align-char"><strong>92.7</strong></td><td class="align-char"><strong>91.3</strong></td><td class="align-char"><strong>86.5</strong></td></tr></tbody></table></div></div><div class="tables frame-topbot rowsep-0 colsep-0" id="t0030"><span class="captions"><span id="cn0080"><p id="sp0100"><span class="label">Table 6</span>. <a href="/topics/computer-science/quantitative-comparison" title="Learn more about Quantitative comparison from ScienceDirect's AI-generated Topic Pages" class="topic-link">Quantitative comparison</a> results on the Potsdam test set with state-of-the-art networks.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" class="align-left">Method</th><th scope="col" class="align-left">Backbone</th><th scope="col" class="align-char">Imp. surf.</th><th scope="col" class="align-char">Building</th><th scope="col" class="align-char">Low veg.</th><th scope="col" class="align-char">Tree</th><th scope="col" class="align-char">Car</th><th scope="col" class="align-char">Mean F1</th><th scope="col" class="align-char">OA (%)</th><th scope="col" class="align-char">mIoU (%)</th><th scope="col" class="align-char">Speed</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">DeepLabV3+ (<a name="bb0035" href="#b0035" class="workspace-trigger">Chen et al., 2018a</a>)</td><td class="align-left">ResNet101</td><td class="align-char">93.0</td><td class="align-char">95.9</td><td class="align-char">87.6</td><td class="align-char">88.2</td><td class="align-char">96.0</td><td class="align-char">92.1</td><td class="align-char">90.9</td><td class="align-char">84.3</td><td class="align-char">13.27</td></tr><tr class="valign-top"><td class="align-left">PSPNet (<a name="bb0370" href="#b0370" class="workspace-trigger">Zhao et al., 2017</a>)</td><td class="align-left">ResNet101</td><td class="align-char">93.4</td><td class="align-char">97.0</td><td class="align-char">87.8</td><td class="align-char">88.5</td><td class="align-char">95.4</td><td class="align-char">92.4</td><td class="align-char">91.1</td><td class="align-char">84.9</td><td class="align-char">22.03</td></tr><tr class="valign-top"><td class="align-left">DDCM-Net (<a name="bb0185" href="#b0185" class="workspace-trigger">Liu et al., 2020</a>)</td><td class="align-left">ResNet50</td><td class="align-char">92.9</td><td class="align-char">96.9</td><td class="align-char">87.7</td><td class="align-char"><strong>89.4</strong></td><td class="align-char">94.9</td><td class="align-char">92.3</td><td class="align-char">90.8</td><td class="align-char">–</td><td class="align-char">37.28</td></tr><tr class="valign-top"><td class="align-left">CCNet (Huang et al., 2020)</td><td class="align-left">ResNet101</td><td class="align-char">93.6</td><td class="align-char">96.8</td><td class="align-char">86.9</td><td class="align-char">88.6</td><td class="align-char"><strong>96.2</strong></td><td class="align-char">92.4</td><td class="align-char">91.5</td><td class="align-char">85.7</td><td class="align-char">5.56</td></tr><tr class="valign-top"><td class="align-left">AMA_1</td><td class="align-left">–</td><td class="align-char">93.4</td><td class="align-char">96.8</td><td class="align-char">87.7</td><td class="align-char">88.8</td><td class="align-char">96.0</td><td class="align-char">92.5</td><td class="align-char">91.2</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">SWJ_2</td><td class="align-left">ResNet101</td><td class="align-char"><strong>94.4</strong></td><td class="align-char">97.4</td><td class="align-char">87.8</td><td class="align-char">87.6</td><td class="align-char">94.7</td><td class="align-char">92.4</td><td class="align-char"><strong>91.7</strong></td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">HUSTW4 (<a name="bb0260" href="#b0260" class="workspace-trigger">Sun et al., 2019</a>)</td><td class="align-left">ResegNets</td><td class="align-char">93.6</td><td class="align-char"><strong>97.6</strong></td><td class="align-char"><strong>88.5</strong></td><td class="align-char">88.8</td><td class="align-char">94.6</td><td class="align-char">92.6</td><td class="align-char">91.6</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">V-FuseNet# (<a name="bb0005" href="#b0005" class="workspace-trigger">Audebert et al., 2018</a>)</td><td class="align-left">FuseNet</td><td class="align-char">92.7</td><td class="align-char">96.3</td><td class="align-char">87.3</td><td class="align-char">88.5</td><td class="align-char">95.4</td><td class="align-char">92.0</td><td class="align-char">90.6</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">DST_5# (<a name="bb0255" href="#b0255" class="workspace-trigger">Sherrah, 2016</a>)</td><td class="align-left">FCN</td><td class="align-char">92.5</td><td class="align-char">96.4</td><td class="align-char">86.7</td><td class="align-char">88.0</td><td class="align-char">94.7</td><td class="align-char">91.7</td><td class="align-char">90.3</td><td class="align-char">–</td><td class="align-char">–</td></tr><tr class="valign-top"><td class="align-left">ABCNet</td><td class="align-left">ResNet18</td><td class="align-char">93.5</td><td class="align-char">96.9</td><td class="align-char">87.9</td><td class="align-char">89.1</td><td class="align-char">95.8</td><td class="align-char"><strong>92.7</strong></td><td class="align-char">91.3</td><td class="align-char"><strong>86.5</strong></td><td class="align-char"><strong>72.13</strong></td></tr></tbody></table></div><p class="legend"><p id="sp0105">- means the results are not reported in the original paper.</p><p id="sp0110"># means the DSM or NDSM are used in the network.</p></p></div></div></section></section><section id="s0090"><h2 id="st100" class="u-h3 u-margin-l-top u-margin-xs-bottom">5. Discussion</h2><div><p id="p0320"><span>The comprehensive experiments undertaken demonstrate the superiority of ABCNet, not only for segmentation accuracy but also efficiency. There are three important factors that guarantee accuracy without drastically increasing computational consumption. First, the bilateral architecture resolves the contradiction between sufficient contextual information and fine-grained <a href="/topics/computer-science/spatial-detail" title="Learn more about spatial detail from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial detail</a>. The channel pruning or input cropping operations are commonly used in the encoder-decoder structure to boost inference speed, leading to the loss of low-level and spatial details which cannot be recovered easily. In contrast, the proposed ABCNet adopts a bilateral architecture, where a spatial path extracts low-level features and a contextual path exploits high-level features. To demonstrate the difference between the contextual path (Cp) and spatial path (Sp) visually, we visualize the feature maps generated by the Cp and Sp in </span><a name="bf0050" href="#f0050" class="workspace-trigger">Fig. 10</a><span>. Please note that the features maps of are upsampled to restore the shape. As can be seen in the figure, the information provided by the contextual path and spatial has indeed differences. Specifically, in feature maps of the contextual path, objects have a more consistent character with those pixels in the same class. By contrast, more detailed information is preserved in the spatial path. Meanwhile, the relatively efficient design of the spatial path (three stacked identical layers) and contextual path (the ResNet-18 backbone) avoids large computational requirements. Second, the attention enhancement module balances the trade-off between global contextual information and huge calculation complexity. Conventionally, the dot-product attention mechanism employed to capture long-range dependencies is accompanied by quadratic increases in time and memory consumption with input size. Instead, we harness the linear attention mechanism, developed in our previous research, to provide a calculation-friendly scheme for global contextual information extraction. Third, the feature aggregation module merges the spatial features and contextual features in an appropriate fashion. The spatial features generated by the spatial path are low-level and detailed, while the contextual features generated by the contextual path are high-level and semantically rich. In other words, the features have entirely different semantic meanings. Hence, although a degree of improvement in accuracy can be brought, the simple summation or <a href="/topics/computer-science/concatenation-operation" title="Learn more about concatenation operations from ScienceDirect's AI-generated Topic Pages" class="topic-link">concatenation operations</a> are not the optimal feature fusion scheme. The elaborate feature aggregation module developed here ensures reasonable fusion and full utilization of both sets of features.</span></p><figure class="figure text-xs" id="f0050"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr10.jpg" height="666" alt="" aria-describedby="cn0050"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr10_lrg.jpg" target="_blank" download="" title="Download high-res image (640KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (640KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S0924271621002379-gr10.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cn0050"><p id="sp0055"><span class="label">Fig. 10</span>. Illustration of feature mapsgenerated by Cp and Sp, where the input size of the image in the top part is 512&nbsp;×&nbsp;512 and 2048&nbsp;×&nbsp;2048 in the bottom.</p></span></span></figure></div></section><section id="s0095"><h2 id="st105" class="u-h3 u-margin-l-top u-margin-xs-bottom">6. Conclusion</h2><p id="p0325"><span>In this paper, we propose a novel lightweight framework for efficient semantic segmentation in the field of <a href="/topics/earth-and-planetary-sciences/remote-sensing" title="Learn more about remote sensing from ScienceDirect's AI-generated Topic Pages" class="topic-link">remote sensing</a>, namely the Attentive Bilateral Contextual Network (ABCNet). As both sufficient contextual information and fine-grained </span><a href="/topics/computer-science/spatial-detail" title="Learn more about spatial detail from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial detail</a> are crucial for the accuracy of segmentation, we design the ABCNet based on the bilateral architecture which captures simultaneously and adaptively the abundant spatial details in fine-resolution remotely sensed imagery via a spatial path and the global contextual information via a contextual path. Extensive experiments on the ISPRS Vaihingen and Potsdam datasets demonstrate the effectiveness and efficiency of the proposed ABCNet, with huge potential for practical real-time applications. Although achieving a relatively fine balance between effectiveness and efficiency, the speed of the proposed ABCNet has a certain room for improvement, especially when compared with those single-branch lightweight networks. As the contextual path occupies the majority of parameters and complexities, our future work will focus on further optimizing the contextual path of the ABCNet, especially to design an efficient Transformer backbone using our linear attention mechanism, thereby replacing the original ResNet backbone with this novel structure.</p></section></div><section id="coi005"><h2 id="st115" class="u-h3 u-margin-l-top u-margin-xs-bottom">Declaration of Competing Interest</h2><p id="p0335">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></section><section id="ak005"><h2 id="st120" class="u-h3 u-margin-l-top u-margin-xs-bottom">Acknowledgments</h2><p id="p0340">This research was funded by the <span id="gp005">National Natural Science Foundation of China</span>, Grant No. <a href="#gp005">41671452</a>.</p></section></div>