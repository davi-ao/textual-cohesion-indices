<div class="Body u-font-serif" id="body"><div><section id="sec0001"><h2 id="sectt0004" class="u-h3 u-margin-l-top u-margin-xs-bottom">1. Introduction</h2><p id="para0007"><span><span>Recent research has shown the ability of <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about convolutional neural networks from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolutional neural networks</a> (CNN) to deal with complex machine vision problems: unprecedented results were achieved in tasks such as </span><a href="/topics/computer-science/classification" title="Learn more about classification from ScienceDirect's AI-generated Topic Pages" class="topic-link">classification</a> (</span><a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky, Sutskever, Hinton, 2012</a>, <a name="bbib0045" href="#bib0045" class="workspace-trigger">Szegedy, Liu, Jia, Sermanet, Reed, Anguelov, Erhan, Vanhoucke, Rabinovich, 2015</a>), segmentation, and object detection (<a name="bbib0041" href="#bib0041" class="workspace-trigger">Sermanet, Eigen, Zhang, Mathieu, Fergus, LeCun, 2013</a>, <a name="bbib0046" href="#bib0046" class="workspace-trigger">Szegedy, Toshev, Erhan, 2013</a>), often outperforming human accuracy (<a name="bbib0017" href="#bib0017" class="workspace-trigger">He et&nbsp;al., 2015</a>). CNNs have the ability of learning a hierarchical representation of the input data without requiring any effort to design handcrafted features (<a name="bbib0023" href="#bib0023" class="workspace-trigger">LeCun et&nbsp;al., 2015</a>). Different layers of the network are capable of different levels of abstraction and capture different amount of structure from the patterns present in the image (<a name="bbib0050" href="#bib0050" class="workspace-trigger">Zeiler and Fergus, 2013</a>). Due to the complexity of the tasks and the very large number of network parameters that need to be learned during training, CNNs require a massive amount of annotated training images in order to deliver competitive results. As a consequence, significant performance increase can be achieved as soon as faster hardware and higher amount of training data become available (<a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky et&nbsp;al., 2012</a>).</p><div><p id="para0008"><span><span>In this work we investigate the applicability of convolutional neural networks to medical image analysis. Our goal is to perform segmentation of single and multiple anatomic regions in <a href="/topics/engineering/volumetrics" title="Learn more about volumetric from ScienceDirect's AI-generated Topic Pages" class="topic-link">volumetric</a> clinical images from various modalities. To this end, we perform a large study on parameter variations and </span><a href="/topics/computer-science/network-architecture" title="Learn more about network architectures from ScienceDirect's AI-generated Topic Pages" class="topic-link">network architectures</a>, while proposing a novel segmentation framework based on Hough voting and patch-wise back-projection of a multi-atlas. We demonstrate the performance of our approach on brain MRI scans and 3D freehand ultrasound (US) volumes of the deep brain regions (</span><a name="bfig0001" href="#fig0001" class="workspace-trigger">Fig.&nbsp;1</a>).</p><figure class="figure text-xs" id="fig0001"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr1.jpg" height="360" alt="Fig. 1" aria-describedby="cap0001"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr1_lrg.jpg" target="_blank" download="" title="Download high-res image (376KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (376KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr1.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0001"><p id="spara0005"><span class="label">Fig. 1</span>. Example of MRI and ultrasound slices (left) and their respective segmentations (right) as estimated by Hough-CNN. Anatomies shown include midbrain in US (red) and in MRI (yellow). Further, in upper half of MRI slice: hippocampus (pink), thalamus (green), red nucleus (red), substantia nigra (green/red stripes within midbrain) and amygdala (cyan). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></span></span></figure></div><p id="para0009">The paradigm-shifting results delivered by CNNs in <a href="/topics/engineering/computervision" title="Learn more about computer vision from ScienceDirect's AI-generated Topic Pages" class="topic-link">computer vision</a><span> were in part accomplished with the help of extremely large <a href="/topics/computer-science/training-dataset" title="Learn more about training datasets from ScienceDirect's AI-generated Topic Pages" class="topic-link">training datasets</a> and significant computational resources. Both of which may be often unrealistic in clinical environments, due to the absence of large annotated dataset and to data protection policies which often do not allow computation outsourcing. Therefore, in this study, we perform all training and testing of CNN networks on clinically realistic dataset sizes, using a high-performance, but stand-alone PC workstation.</span></p><p id="para0010">Segmentation of brain structures in US and MRI has widespread clinical relevance, but it is challenging in both modalities.</p><p id="para0011"><span>In MRI, the segmentation of basal ganglia is a relevant task for diagnosis, treatment and clinical research. A concrete application is pre-operative planning of Deep Brain Stimulation (DBS) <a href="/topics/engineering/neurosurgery" title="Learn more about neurosurgery from ScienceDirect's AI-generated Topic Pages" class="topic-link">neurosurgery</a> in which basal ganglia, like the sub-thalamic nucleus (STN) and globus pallidus internal (GPi), are targeted for treatment of symptoms of Parkinson’s disease (PD) and dystonia, respectively (</span><a name="bbib0009" href="#bib0009" class="workspace-trigger">D’Haese et&nbsp;al., 2012</a><span>). Accurate <a href="/topics/engineering/localisation" title="Learn more about localisation from ScienceDirect's AI-generated Topic Pages" class="topic-link">localisation</a> and outlining of these nuclei can be challenging, even when performed manually, due to their weak contrast in MRI data. Moreover, fully manual labelling of individual MRIs into multiple regions in 3D is extremely time-consuming and therefore prohibitive. For this reason, both in research (</span><a name="bbib0009" href="#bib0009" class="workspace-trigger">D’Haese, Pallavaram, Li, Remple, Kao, Neimat, Konrad, Dawant, 2012</a>, <a name="bbib0011" href="#bib0011" class="workspace-trigger">DAlbis, Haegelen, Essert, Fernndez-Vidal, Lalys, Jannin, 2015</a>) and in clinical practice (<a name="bbib0003" href="#bib0003" class="workspace-trigger">Barbe et&nbsp;al., 2014</a>), segmentation through atlas-based approaches is widely used.</p><p id="para0012">Transcranial ultrasound (TCUS) can be used to scan deep brain regions non-invasively through the temporal bone window. Using TCUS, hyper-echogenicities of the Substantia Nigra (SN) can be analysed, gaining valuable information to perform differential (<a name="bbib0048" href="#bib0048" class="workspace-trigger">Walter et&nbsp;al., 2007</a>) and early (<a name="bbib0005" href="#bib0005" class="workspace-trigger">Berg et&nbsp;al., 2011</a>) diagnosis of Parkinson’s Disease (PD). A crucial step towards computer assisted diagnosis of PD is midbrain segmentation (<a name="bbib0001" href="#bib0001" class="workspace-trigger">Ahmadi, Baust, Karamalis, Plate, Bötzel, Klein, Navab, 2011</a>, <a name="bbib0030" href="#bib0030" class="workspace-trigger">Milletari, Ahmadi, Kroll, Hennersperger, Tombari, Shah, Plate, Boetzel, Navab, 2015</a>). This task is reportedly challenging even for human observers (<a name="bbib0036" href="#bib0036" class="workspace-trigger">Plate et&nbsp;al., 2012</a><span>). In order to penetrate the skull, low frequencies need to be applied resulting in an overall reduction of the resolution and in the presence of large incoherent speckle patterns. Scanning through the bone, moreover, attenuates a large part of the ultrasound energy, leading to overall reduction of the signal-to-noise ratio, as well as low contrast and largely missing contours at anatomic boundaries. Additionally, the higher speed of sound in the bone leads to <a href="/topics/engineering/phase-aberration" title="Learn more about phase aberration from ScienceDirect's AI-generated Topic Pages" class="topic-link">phase aberration</a> (</span><a name="bbib0019" href="#bib0019" class="workspace-trigger">Ivancevich et&nbsp;al., 2006</a>) and de-focussing of the ultrasound beam which causes further lowering of the image quality. A variety of image TCUS quality, anatomical visibility and 3D ultrasound fan geometry can be seen in <a name="bfig0003" href="#fig0003" class="workspace-trigger">Fig.&nbsp;3</a><span>. Registration methods, in particular non-linear registration, are very difficult under these conditions. Therefore, atlas-building and atlas-based <a href="/topics/computer-science/segmentation-method" title="Learn more about segmentation methods from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation methods</a> tend to fail in ultrasound.</span></p><p id="para0013">In this work we evaluate the performance of our approach using an ultrasound dataset of manually annotated TCUS volumes depicting the midbrain, and an MRI dataset, depicting 26 regions including basal ganglia, annotated in a computer-assisted manner. Our method is fully automatic, registration-free and highly robust towards the presence of <a href="/topics/engineering/artefact" title="Learn more about artefacts from ScienceDirect's AI-generated Topic Pages" class="topic-link">artefacts</a><span>. Through our patch-based <a href="/topics/computer-science/voting-strategy" title="Learn more about voting strategy from ScienceDirect's AI-generated Topic Pages" class="topic-link">voting strategy</a>, our approach can localise and segment structures that are only partially visible or whose appearances are corrupted by artefacts. To the best of our knowledge, this is the first work employing CNNs to perform ultrasound segmentation.</span></p><p id="para0014">Our work features several contributions:<dl class="list"><dt class="list-label">•</dt><dd class="list-description"><p id="para0015"><span>We propose Hough-CNN, a novel <a href="/topics/computer-science/segmentation-approach" title="Learn more about segmentation approach from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation approach</a> based on a voting strategy similar to </span><a name="bbib0030" href="#bib0030" class="workspace-trigger">Milletari et&nbsp;al. (2015)</a>. We show that the method is multi-modal, multi-region, robust and implicitly encoding priors on anatomical shape and appearance. Hough-CNN delivers results comparable or superior to other state-of-the-art approaches while being entirely registration-free. In particular, it outperforms methods based on voxel-wise classification.</p></dd><dt class="list-label">•</dt><dd class="list-description"><p id="para0016">We propose and evaluate several different CNN architectures, with varying numbers of layers and convolutional kernels per layer. In this way we acquire insights on how different network architectures cope with the amount of variability present in medical volumes and image modalities.</p></dd><dt class="list-label">•</dt><dd class="list-description"><p id="para0017">Each network is trained with different amounts of data in order to evaluate the impact of the number of annotated training examples on the final segmentation result. In particular, we show how complex networks with higher parameter number cope with relatively small training datasets.</p></dd><dt class="list-label">•</dt><dd class="list-description"><p id="para0018">We adapted the <em>Caffe</em> framework (<a name="bbib0020" href="#bib0020" class="workspace-trigger">Jia et&nbsp;al., 2014</a><span>) to perform convolutions of <a href="/topics/computer-science/volumetric-data" title="Learn more about volumetric data from ScienceDirect's AI-generated Topic Pages" class="topic-link">volumetric data</a>, preserving its third dimension across the whole network. We compare CNN performance using 3D convolution to the more common 2D convolution, as well as to a recent 2.5D approach (</span><a name="bbib0040" href="#bib0040" class="workspace-trigger">Roth et&nbsp;al., 2014</a>).</p></dd></dl></p></section><section id="sec0002"><h2 id="sectt0005" class="u-h3 u-margin-l-top u-margin-xs-bottom">2. Related works</h2><p id="para0019"><span><span>In this section we give an overview of existing approaches that employ <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNNs from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNNs</a> to solve problems from both </span><a href="/topics/engineering/computervision" title="Learn more about computer vision from ScienceDirect's AI-generated Topic Pages" class="topic-link">computer vision</a> and </span><a href="/topics/computer-science/medical-imaging" title="Learn more about medical imaging from ScienceDirect's AI-generated Topic Pages" class="topic-link">medical imaging</a> domain.</p><p id="para0020">In the last few years CNNs became very popular tools among the computer vision community. Classification problems such as image categorisation (<a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky, Sutskever, Hinton, 2012</a>, <a name="bbib0045" href="#bib0045" class="workspace-trigger">Szegedy, Liu, Jia, Sermanet, Reed, Anguelov, Erhan, Vanhoucke, Rabinovich, 2015</a>), object detection (<a name="bbib0014" href="#bib0014" class="workspace-trigger">Girshick et&nbsp;al., 2014</a>) and face recognition (<a name="bbib0013" href="#bib0013" class="workspace-trigger">Farfade et&nbsp;al., 2015</a><span>) as well as <a href="/topics/computer-science/regression-problem" title="Learn more about regression problems from ScienceDirect's AI-generated Topic Pages" class="topic-link">regression problems</a> such as human pose estimation (</span><a name="bbib0004" href="#bib0004" class="workspace-trigger">Belagiannis et&nbsp;al., 2015</a>), and depth prediction from RGB data (<a name="bbib0012" href="#bib0012" class="workspace-trigger">Eigen et&nbsp;al., 2014</a><span>) have been addressed using CNNs and unprecedented results have been reported. In order to cope with the challenges present in natural images, such as scale changes, occlusions, deformations different illumination settings and viewpoint changes, these methods needed to be trained on very large annotated datasets and required several weeks to be built even when powerful <a href="/topics/engineering/graphics-processing-unit" title="Learn more about GPUs from ScienceDirect's AI-generated Topic Pages" class="topic-link">GPUs</a> were employed. In medical imaging, however, it is difficult to obtain even a fraction of this amount of resources, both in terms of computational means and amount of annotated training data.</span></p><p id="para0021">Many works applying deep learning to medical problems relayed only on a few dozen of training images (e.g. <a name="bbib0006" href="#bib0006" class="workspace-trigger">de Brébisson, Montana, 2015</a>, <a name="bbib0007" href="#bib0007" class="workspace-trigger">Ciresan, Giusti, Gambardella, Schmidhuber, 2012</a>, <a name="bbib0008" href="#bib0008" class="workspace-trigger">Cirean, Giusti, Gambardella, Schmidhuber, 2013</a>, <a name="bbib0016" href="#bib0016" class="workspace-trigger">Havaei, Davy, Warde-Farley, Biard, Courville, Bengio, Pal, Jodoin, Larochelle, 2015</a>, <a name="bbib0033" href="#bib0033" class="workspace-trigger">Ngo, Carneiro, 2013</a>, <a name="bbib0037" href="#bib0037" class="workspace-trigger">Prasoon, Petersen, Igel, Lauze, Dam, Nielsen, 2013</a>). Most networks were applied to tasks that could be solved by interpreting the images patch-wise in a sliding window fashion. In this case, several thousands of annotated training examples could be obtained from just a few images. Dataset augmentation techniques, such as random patch rotation and mirroring, were also applied if the objects of interest were invariant to these transformations (<a name="bbib0007" href="#bib0007" class="workspace-trigger">Ciresan, Giusti, Gambardella, Schmidhuber, 2012</a>, <a name="bbib0008" href="#bib0008" class="workspace-trigger">Cirean, Giusti, Gambardella, Schmidhuber, 2013</a>, <a name="bbib0016" href="#bib0016" class="workspace-trigger">Havaei, Davy, Warde-Farley, Biard, Courville, Bengio, Pal, Jodoin, Larochelle, 2015</a>, <a name="bbib0040" href="#bib0040" class="workspace-trigger">Roth, Lu, Seff, Cherry, Hoffman, Wang, Liu, Turkbey, Summers, 2014</a>). This is the case for cell nuclei, lymph nodes and tumor regions, but not for anatomic structures with regular size and local context, such as regions of the brain or abdomen. Another way to deal with little training data is to embed CNNs as core components into previously successful methods from the community. A deep variational model is proposed in <a name="bbib0038" href="#bib0038" class="workspace-trigger">Ranftl and Pock (2014)</a>. Their CNN is embedded into a global inference model, i.e. the CNN outputs are treated as unary potentials on a graph and the segmentation is solved via minimum s-t cuts on the predicted graph. In <a name="bbib0047" href="#bib0047" class="workspace-trigger">Turaga et&nbsp;al. (2010)</a> the CNN performs 3D regression to predict an affinity graph, which can be solved via graph partitioning techniques or connected components in order to segment neuron boundaries. Active shape models are realised with CNNs in <a name="bbib0028" href="#bib0028" class="workspace-trigger">Liang et&nbsp;al. (2015)</a> via regression of multi-template contributions and object location. Variational Deep Learning was realised in <a name="bbib0033" href="#bib0033" class="workspace-trigger">Ngo and Carneiro (2013)</a><span> by combining shape-regularised levelset methods with <a href="/topics/engineering/deep-belief-network" title="Learn more about Deep Belief Networks from ScienceDirect's AI-generated Topic Pages" class="topic-link">Deep Belief Networks</a> (DBN) for left ventricle segmentation in cardiac MRI.</span></p><p id="para0022"><span>In this work, we propose a novel Hough-CNN detection and <a href="/topics/computer-science/segmentation-approach" title="Learn more about segmentation approach from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation approach</a><span>. Our method utilises CNNs at its core to efficiently process medical volumes in a patch-wise fashion. It obtains voxel-wise <a href="/topics/computer-science/classification" title="Learn more about classifications from ScienceDirect's AI-generated Topic Pages" class="topic-link">classifications</a> along with high level features – used to retrieve votes – that are descriptive of the object of interest. Generalised Hough voting has been proposed in the past to address problems related with object detection (</span></span><a name="bbib0026" href="#bib0026" class="workspace-trigger">Leibe et&nbsp;al., 2004</a>) and tracking (<a name="bbib0015" href="#bib0015" class="workspace-trigger">Godec et&nbsp;al., 2013</a>). A notable extension to generalized Hough voting was extended by introducing implicit shape models (ISM) (<a name="bbib0026" href="#bib0026" class="workspace-trigger">Leibe, Leonardis, Schiele, 2004</a>, <a name="bbib0027" href="#bib0027" class="workspace-trigger">Leibe, Leonardis, Schiele, 2008</a><span><span>), which combined recognition and segmentation into a <a href="/topics/computer-science/probabilistic-framework" title="Learn more about probabilistic framework from ScienceDirect's AI-generated Topic Pages" class="topic-link">probabilistic framework</a>. The concept of additional object segmentation in ISM by back-projection of codebook patches can be considered as a precursor for our proposed work. The ISM recognition was further refined with weighted voting for optimized object center </span><a href="/topics/engineering/localisation" title="Learn more about localization from ScienceDirect's AI-generated Topic Pages" class="topic-link">localization</a> (</span><a name="bbib0029" href="#bib0029" class="workspace-trigger">Maji and Malik, 2009</a>). Later, principled implicit shape models (PRISM) (<a name="bbib0025" href="#bib0025" class="workspace-trigger">Lehmann et&nbsp;al., 2009</a>) demonstrated the ability to perform fast nearest-neighbor searches of test patches to trained codebook patches for object detection at recognition time. More recent works such as <a name="bbib0039" href="#bib0039" class="workspace-trigger">Riegler et&nbsp;al. (2013)</a> and <a name="bbib0049" href="#bib0049" class="workspace-trigger">Xie et&nbsp;al. (2015)</a><span> performed Hough voting using a CNN. Their respective aim is to obtain head poses and cell locations in 2D by using the network to perform simultaneous classification and vote regression. In this work we propose a more flexible voting mechanism based on neighborhood relationships in feature space. On the one hand, this allows us to cast a variable amount of votes for each patch, which can be associated with information such as segmentation patches. Additionally, therapeutic indications or <a href="/topics/computer-science/diagnostic-information" title="Learn more about diagnostic information from ScienceDirect's AI-generated Topic Pages" class="topic-link">diagnostic information</a> can be added or modified at any time without requiring re-training. On the other hand, instead of relying on regression, our method uses votes collected from annotated training images. Thus, it does not experience unpredictable behaviour of the votes when the network is presented with unusual data that produces unexpected feature values and mis-classifications.</span></p><p id="para0023">Compared to computer vision which performs Deep Learning mostly on 2D images, medical images often deal with volumes acquired through scanners such as MRI or CT. In our literature review, most approaches have continued working in 2D by approaching 3D scans in a slice-by-slice fashion (e.g. <a name="bbib0006" href="#bib0006" class="workspace-trigger">de Brébisson, Montana, 2015</a>, <a name="bbib0007" href="#bib0007" class="workspace-trigger">Ciresan, Giusti, Gambardella, Schmidhuber, 2012</a>, <a name="bbib0008" href="#bib0008" class="workspace-trigger">Cirean, Giusti, Gambardella, Schmidhuber, 2013</a>, <a name="bbib0016" href="#bib0016" class="workspace-trigger">Havaei, Davy, Warde-Farley, Biard, Courville, Bengio, Pal, Jodoin, Larochelle, 2015</a>, <a name="bbib0021" href="#bib0021" class="workspace-trigger">Kim, Wu, Shen, 2013</a>, <a name="bbib0024" href="#bib0024" class="workspace-trigger">Lee, Laine, Klein, 2011</a>, <a name="bbib0033" href="#bib0033" class="workspace-trigger">Ngo, Carneiro, 2013</a>, <a name="bbib0037" href="#bib0037" class="workspace-trigger">Prasoon, Petersen, Igel, Lauze, Dam, Nielsen, 2013</a>, <a name="bbib0044" href="#bib0044" class="workspace-trigger">Song, Zhang, Chen, Ni, Lei, Wang, 2015</a>). The advantage is high speed, low memory consumption and the ability to utilise pre-trained nets such as AlexNet (<a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky et&nbsp;al., 2012</a>), either directly or via transfer learning. The obvious disadvantage is that anatomic context in the directions orthogonal to the image plane are entirely discarded. Some groups who employed 3D convolutions found that computational tractability was an issue, and classification was either impossible (<a name="bbib0040" href="#bib0040" class="workspace-trigger">Roth et&nbsp;al., 2014</a>) or suffered in accuracy since compromises on patch-size had to be made (<a name="bbib0037" href="#bib0037" class="workspace-trigger">Prasoon et&nbsp;al., 2013</a>). Other groups have applied 3D convolution successfully for Alzheimer’s disease detection from whole-MRI (<a name="bbib0035" href="#bib0035" class="workspace-trigger">Payan and Montana, 2015</a>) or regression of affinity graphs from 3D convolution (<a name="bbib0047" href="#bib0047" class="workspace-trigger">Turaga et&nbsp;al., 2010</a>). A different approach that was applied to full-brain segmentation from MRI in <a name="bbib0006" href="#bib0006" class="workspace-trigger">de&nbsp;Brébisson and Montana (2015)</a> combined small 3D patches with larger 2.5D ones that include more context. The 2.5D patches, in particular, consisted of a stack of three 2D patches extracted respectively from the sagittal, coronal and transversal planes. All patches were assembled into eight parallel CNN pathways in order to achieve high-quality segmentation of 134 brain regions from whole brain MRI. In <a name="bbib0031" href="#bib0031" class="workspace-trigger">Milletari et&nbsp;al. (2016)</a> a fully convolutional model (FCNN) making use of both short and long skip connections and residual learning was employed to perform prostate segmentation in MRI. A novel loss function based on Dice coefficient and particularly tailored to solve segmentation problems was also proposed.</p><p id="para0024">In this work, we evaluate the performance of our network when 2D, 2.5D and 3D patches are employed. In particular, we supply rather long-range 3D patches which retain a large amount of anatomical context.</p><p id="para0025"><span>Another important issue in CNN-related research is the search for optimal CNN <a href="/topics/computer-science/network-architecture" title="Learn more about network architecture from ScienceDirect's AI-generated Topic Pages" class="topic-link">network architecture</a>: we have found very little literature that addresses this issue systematically. Although several networks architectures were analysed in </span><a name="bbib0007" href="#bib0007" class="workspace-trigger">Ciresan et&nbsp;al. (2012)</a> and <a name="bbib0008" href="#bib0008" class="workspace-trigger">Cirean et&nbsp;al. (2013)</a>, we have found only one study on “very deep CNN” (<a name="bbib0043" href="#bib0043" class="workspace-trigger">Simonyan and Zisserman, 2014</a><span>), in which the number of <a href="/topics/computer-science/convolutional-layer" title="Learn more about convolutional layers from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolutional layers</a> was varied systematically (8–16) while keeping kernel sizes fixed. The study concluded that small kernel sizes in combination with deep architectures can outperform CNNs with few layers and large kernel sizes.</span></p><div><p id="para0026">In this work we propose and benchmark six network architectures, including one very deep network having 8 convolutional layers as shown in <a name="btbl0001" href="#tbl0001" class="workspace-trigger">Table&nbsp;1</a>.</p><div class="tables rowsep-0 colsep-0 frame-topbot" id="tbl0001"><span class="captions"><span id="cap0009"><p id="spara0013"><span class="label">Table 1</span>. <span>Six <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNNs from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNNs</a> were designed and employed to process squared or cubic patches having size 31 pixels. Notation for architecture and CNN layers given in </span><a name="bsec0004" href="#sec0004" class="workspace-trigger">Section&nbsp;3.1</a><span>. <a href="/topics/computer-science/activation-function" title="Learn more about Activation functions from ScienceDirect's AI-generated Topic Pages" class="topic-link">Activation functions</a> follow all layers.</span></p></span></span><div class="groups"><table><thead><tr class="rowsep-1"><th scope="row" class="align-left valign-top">Name</th><th scope="row" class="align-left valign-top">Network architecture</th><th scope="row" class="align-left valign-top">Act. function</th><th scope="row" class="align-left valign-top">Init.</th><th scope="row" class="align-left valign-top">Remarks</th></tr></thead><tbody><tr><th class="align-left valign-top" scope="row">3-3-3-3-3</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mn is=&quot;true&quot;>31</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>P</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>2</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>g</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.415ex" height="10.115ex" viewBox="0 -953.8 9220.4 4354.9" role="img" focusable="false" style="vertical-align: -7.899ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g is="true" transform="translate(1470,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1971,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(4276,0)"><g is="true"><use xlink:href="#MJMATHI-50"></use></g><g is="true" transform="translate(784,345)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g><g is="true" transform="translate(642,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(5736,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(6237,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g transform="translate(0,-1594)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(4609,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5110,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(6914,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(7415,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g></g><g transform="translate(0,-3028)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g><g is="true" transform="translate(2528,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(3028,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(908,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1238,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-67"></use></g><g is="true" transform="translate(1578,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1822,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2165,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2590,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">2</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-1"><math><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">2</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></script></span></td><td class="align-left valign-top">PReLU</td><td class="align-left valign-top">MSRA</td><td class="align-left valign-top"><em>F</em> use drop-out (ratio 0.5)</td></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3-3-3-3</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mn is=&quot;true&quot;>31</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>g</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.896ex" height="13.904ex" viewBox="0 -953.8 8997 5986.4" role="img" focusable="false" style="vertical-align: -11.689ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g is="true" transform="translate(1470,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1971,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(4276,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(6080,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(6580,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g transform="translate(0,-1594)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(4609,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5110,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(6914,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(7415,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g></g><g transform="translate(0,-3187)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g><g is="true" transform="translate(4832,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5333,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g></g><g transform="translate(0,-4622)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(908,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1238,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-67"></use></g><g is="true" transform="translate(1578,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1822,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2165,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2590,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-2"><math><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></script></span></td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">5-5-5-5-5</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mn is=&quot;true&quot;>31</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>g</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.934ex" height="10.115ex" viewBox="0 -953.8 9443.7 4354.9" role="img" focusable="false" style="vertical-align: -7.899ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g is="true" transform="translate(1470,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1971,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(4276,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g is="true" transform="translate(6080,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(6580,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g transform="translate(0,-1595)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g is="true" transform="translate(4609,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5110,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g><g is="true" transform="translate(7137,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(7638,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g></g><g transform="translate(0,-3030)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(908,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1238,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-67"></use></g><g is="true" transform="translate(1578,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1822,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2165,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2590,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-3"><math><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></script></span></td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">7-5-3</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mn is=&quot;true&quot;>31</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>7</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>P</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>2</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>g</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="20.903ex" height="6.957ex" viewBox="0 -953.8 8999.7 2995.2" role="img" focusable="false" style="vertical-align: -4.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g is="true" transform="translate(1470,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1971,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-315)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use></g></g></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(4276,0)"><g is="true"><use xlink:href="#MJMATHI-50"></use></g><g is="true" transform="translate(784,345)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g><g is="true" transform="translate(642,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(5736,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(6237,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g transform="translate(0,-1602)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g><g is="true" transform="translate(4832,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5333,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(908,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1238,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-67"></use></g><g is="true" transform="translate(1578,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1822,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2165,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2590,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">7</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">2</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-4"><math><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">7</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">2</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></script></span></td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">9-7-5-3-3</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mn is=&quot;true&quot;>31</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>9</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>7</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>g</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="21.934ex" height="10.272ex" viewBox="0 -953.8 9443.7 4422.8" role="img" focusable="false" style="vertical-align: -8.057ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g is="true" transform="translate(1470,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1971,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-39"></use></g></g></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(4276,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-315)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-37"></use></g></g></g><g is="true" transform="translate(6080,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(6580,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g transform="translate(0,-1602)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(4609,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5110,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g><g is="true" transform="translate(7137,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(7638,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g></g><g transform="translate(0,-3036)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(908,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1238,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-67"></use></g><g is="true" transform="translate(1578,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1822,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2165,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2590,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">9</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">7</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-5"><math><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">9</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">7</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></script></span></td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">Small Alex</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mn is=&quot;true&quot;>31</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>11</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>P</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>2</mn></mrow><mn is=&quot;true&quot;>1</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>P</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>2</mn></mrow><mn is=&quot;true&quot;>1</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow><mn is=&quot;true&quot;>64</mn></msubsup><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mn is=&quot;true&quot;>128</mn></msub><mo is=&quot;true&quot;>&amp;#xB7;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>g</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.715ex" height="10.115ex" viewBox="0 -953.8 9780.1 4354.9" role="img" focusable="false" style="vertical-align: -7.899ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(440,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g><g is="true" transform="translate(1470,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1971,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-31" x="500" y="0"></use></g></g></g><g is="true" transform="translate(3775,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(4276,0)"><g is="true"><use xlink:href="#MJMATHI-50"></use></g><g is="true" transform="translate(784,345)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(642,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g><g is="true" transform="translate(5736,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(6237,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-35"></use></g></g></g><g is="true" transform="translate(8041,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(8541,0)"><g is="true"><use xlink:href="#MJMATHI-50"></use></g><g is="true" transform="translate(784,345)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(642,-308)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g><g transform="translate(0,-1595)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(2304,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(2805,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(4609,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(5110,0)"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,360)"><use transform="scale(0.707)" xlink:href="#MJMAIN-36"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-34" x="500" y="0"></use></g><g is="true" transform="translate(715,-307)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g><g is="true" transform="translate(6914,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(7415,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g></g><g transform="translate(0,-3029)"><g is="true"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-32" x="500" y="0"></use><use transform="scale(0.707)" xlink:href="#MJMAIN-38" x="1001" y="0"></use></g></g><g is="true" transform="translate(2528,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(3028,0)"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(908,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1238,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-67"></use></g><g is="true" transform="translate(1578,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1822,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2165,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2590,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">11</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">2</mn></mrow><mn is="true">1</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">2</mn></mrow><mn is="true">1</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-6"><math><mrow is="true"><msub is="true"><mi is="true">I</mi><mn is="true">31</mn></msub><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">11</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">2</mn></mrow><mn is="true">1</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">5</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mn is="true">2</mn></mrow><mn is="true">1</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msubsup is="true"><mi is="true">C</mi><mrow is="true"><mn is="true">3</mn></mrow><mn is="true">64</mn></msubsup><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mn is="true">128</mn></msub><mo is="true">·</mo><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">r</mi><mi is="true">e</mi><mi is="true">g</mi><mi is="true">i</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></mrow></math></script></span></td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr></tbody></table></div></div></div></section><section id="sec0003"><h2 id="sectt0006" class="u-h3 u-margin-l-top u-margin-xs-bottom">3. Method</h2><p id="para0027"><span><span>We propose six different <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about convolutional neural network from ScienceDirect's AI-generated Topic Pages" class="topic-link">convolutional neural network</a> architectures trained with patches extracted from annotated medical volumes. We optimise our models to correctly categorise data-points into different classes. The volumes were acquired in two different modalities, US and MRI, and depict deep structures of the human brain. Accurate segmentation of the desired regions has been achieved through a Hough </span><a href="/topics/computer-science/voting-strategy" title="Learn more about voting strategy from ScienceDirect's AI-generated Topic Pages" class="topic-link">voting strategy</a>, inspired by </span><a name="bbib0030" href="#bib0030" class="workspace-trigger">Milletari et&nbsp;al. (2015)</a>, which was employed to simultaneously localise and segment the structures of interest.</p><section id="sec0004"><h3 id="sectt0007" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.1. Convolutional neural networks</h3><p id="para0028">A CNN consists of a succession of layers which perform operations on the input data. <span><em><a href="/topics/computer-science/convolutional-layer" title="Learn more about Convolutional layers from ScienceDirect's AI-generated Topic Pages" class="topic-link">Convolutional layers</a></em></span> (symbol <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi><mi is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.887ex" height="2.586ex" viewBox="0 -900.1 1242.8 1113.4" role="img" focusable="false" style="vertical-align: -0.495ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-43"></use></g><g is="true" transform="translate(774,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(715,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi is="true">C</mi><mi is="true">s</mi><mi is="true">k</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-7"><math><msubsup is="true"><mi is="true">C</mi><mi is="true">s</mi><mi is="true">k</mi></msubsup></math></script></span>) convolve the images <em>I<sub>size</sub></em> presented to their inputs with a predefined number (<em>k</em>) of kernels, having a certain size <em>s</em>, and are usually followed by <em>activation units</em> which rescale the results of the convolution in a non linear manner. <em>Pooling layers</em> (symbol <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>P</mi><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>z</mi><mi is=&quot;true&quot;>e</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>t</mi><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>d</mi><mi is=&quot;true&quot;>e</mi></mrow></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.353ex" height="2.954ex" viewBox="0 -900.1 2735.5 1271.9" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-50"></use></g><g is="true" transform="translate(784,352)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g><g is="true" transform="translate(331,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-74"></use></g><g is="true" transform="translate(587,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(906,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(1151,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(1521,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g></g><g is="true" transform="translate(642,-304)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g><g is="true" transform="translate(331,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(576,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-7A"></use></g><g is="true" transform="translate(907,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mi is="true">s</mi><mi is="true">i</mi><mi is="true">z</mi><mi is="true">e</mi></mrow><mrow is="true"><mi is="true">s</mi><mi is="true">t</mi><mi is="true">r</mi><mi is="true">i</mi><mi is="true">d</mi><mi is="true">e</mi></mrow></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-8"><math><msubsup is="true"><mi is="true">P</mi><mrow is="true"><mi is="true">s</mi><mi is="true">i</mi><mi is="true">z</mi><mi is="true">e</mi></mrow><mrow is="true"><mi is="true">s</mi><mi is="true">t</mi><mi is="true">r</mi><mi is="true">i</mi><mi is="true">d</mi><mi is="true">e</mi></mrow></msubsup></math></script></span>) reduce the dimensionality of the responses produced by the convolutional layers through downsampling, using different strategies such as average-pooling or max-pooling. Finally, <em>fully connected layers</em> (symbol <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>#</mo><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>u</mi><mi is=&quot;true&quot;>r</mi><mi is=&quot;true&quot;>o</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>s</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.084ex" height="2.586ex" viewBox="0 -741.6 3911.3 1113.4" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(643,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-23"></use></g><g is="true" transform="translate(589,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(1013,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1343,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-75"></use></g><g is="true" transform="translate(1748,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(2067,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6F"></use></g><g is="true" transform="translate(2411,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(2835,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-73"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">n</mi><mi is="true">e</mi><mi is="true">u</mi><mi is="true">r</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></math></span></span><script type="math/mml" id="MathJax-Element-9"><math><msub is="true"><mi is="true">F</mi><mrow is="true"><mo is="true">#</mo><mi is="true">n</mi><mi is="true">e</mi><mi is="true">u</mi><mi is="true">r</mi><mi is="true">o</mi><mi is="true">n</mi><mi is="true">s</mi></mrow></msub></math></script></span><span>) extract compact, high level features from the data. The kernels belonging to convolutional layers as well as the weights of the neural connections of the fully connected layers are optimised during training through back-propagation. The <a href="/topics/computer-science/network-architecture" title="Learn more about network architecture from ScienceDirect's AI-generated Topic Pages" class="topic-link">network architecture</a> is specified by the user, by defining the number of layers, their kind, and the type of activation unit. Other relevant parameters are: the number and size of the kernels employed during convolution, the amount of neurons in the fully connected part and the downsampling ratio applied by the pooling layers. We propose six network architectures that are described in </span><a name="btbl0001" href="#tbl0001" class="workspace-trigger">Table&nbsp;1</a>.</p><p id="para0029"><span>CNNs perform <a href="/topics/computer-science/machine-learning" title="Learn more about machine learning from ScienceDirect's AI-generated Topic Pages" class="topic-link">machine learning</a> tasks without requiring any handcrafted feature to be engineered and supplied by the user. That is, discovering optimal features describing the data at hand is part of the learning process. During training the network parameters are first initialised and then the data is processed through the layers in a feed-forward manner. The output of the network is compared with the ground-truth through a loss function and the error is back-propagated (</span><a name="bbib0023" href="#bib0023" class="workspace-trigger">LeCun et&nbsp;al., 2015</a>) in order to update the filters and weights of all the layers, up to the inputs. This process is repeated until it converges. Once the network is trained, predictions can be made by using it in a feed-forward manner and reading out the outputs of the last layer.</p><p id="para0030">In our approach we made use of parametric rectified linear units (<a name="bbib0017" href="#bib0017" class="workspace-trigger">He et&nbsp;al., 2015</a><span>) (PReLU) as our <a href="/topics/computer-science/activation-function" title="Learn more about activation functions from ScienceDirect's AI-generated Topic Pages" class="topic-link">activation functions</a>.</span><span class="display"><span id="eq0001" class="formula"><span class="label">(1)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>P</mi><mi is=&quot;true&quot;>R</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>L</mi><mi is=&quot;true&quot;>U</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><mi is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>=</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><mtable is=&quot;true&quot;><mtr is=&quot;true&quot;><mtd columnalign=&quot;left&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mtext is=&quot;true&quot;>if</mtext><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mi is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>&amp;#x2265;</mo><mn is=&quot;true&quot;>0</mn></mrow></mtd></mtr><mtr is=&quot;true&quot;><mtd columnalign=&quot;left&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3B1;</mi><mi is=&quot;true&quot;>x</mi><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mtext is=&quot;true&quot;>if</mtext><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mi is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>&amp;lt;</mo><mn is=&quot;true&quot;>0</mn></mrow></mtd></mtr></mtable></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="28.693ex" height="6.022ex" viewBox="0 -1534 12354.1 2592.6" role="img" focusable="false" style="vertical-align: -2.459ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-50"></use></g><g is="true" transform="translate(751,0)"><use xlink:href="#MJMATHI-52"></use></g><g is="true" transform="translate(1511,0)"><use xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(1977,0)"><use xlink:href="#MJMATHI-4C"></use></g><g is="true" transform="translate(2659,0)"><use xlink:href="#MJMATHI-55"></use></g><g is="true" transform="translate(3593,0)"><g is="true"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(389,0)"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(962,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(5222,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(6278,0)"><use xlink:href="#MJSZ3-7B" is="true"></use><g is="true" transform="translate(917,0)"><g transform="translate(-15,0)"><g is="true" transform="translate(0,665)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-78"></use></g><g is="true"></g><g is="true" transform="translate(972,0)"><use xlink:href="#MJMAIN-69"></use><use xlink:href="#MJMAIN-66" x="278" y="0"></use></g><g is="true"></g><g is="true" transform="translate(1957,0)"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(2807,0)"><use xlink:href="#MJMAIN-2265"></use></g><g is="true" transform="translate(3864,0)"><use xlink:href="#MJMAIN-30"></use></g></g></g><g is="true" transform="translate(0,-766)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3B1"></use></g><g is="true" transform="translate(640,0)"><use xlink:href="#MJMATHI-78"></use></g><g is="true"></g><g is="true" transform="translate(1613,0)"><use xlink:href="#MJMAIN-69"></use><use xlink:href="#MJMAIN-66" x="278" y="0"></use></g><g is="true"></g><g is="true" transform="translate(2598,0)"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(3448,0)"><use xlink:href="#MJMAIN-3C"></use></g><g is="true" transform="translate(4504,0)"><use xlink:href="#MJMAIN-30"></use></g></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">P</mi><mi is="true">R</mi><mi is="true">e</mi><mi is="true">L</mi><mi is="true">U</mi><mrow is="true"><mo is="true">(</mo><mi is="true">x</mi><mo is="true">)</mo></mrow><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mtable is="true"><mtr is="true"><mtd columnalign="left" is="true"><mrow is="true"><mi is="true">x</mi><mspace width="4.pt" is="true"></mspace><mtext is="true">if</mtext><mspace width="4.pt" is="true"></mspace><mi is="true">x</mi><mo is="true">≥</mo><mn is="true">0</mn></mrow></mtd></mtr><mtr is="true"><mtd columnalign="left" is="true"><mrow is="true"><mi is="true">α</mi><mi is="true">x</mi><mspace width="4.pt" is="true"></mspace><mtext is="true">if</mtext><mspace width="4.pt" is="true"></mspace><mi is="true">x</mi><mo is="true">&lt;</mo><mn is="true">0</mn></mrow></mtd></mtr></mtable></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-10"><math><mrow is="true"><mi is="true">P</mi><mi is="true">R</mi><mi is="true">e</mi><mi is="true">L</mi><mi is="true">U</mi><mrow is="true"><mo is="true">(</mo><mi is="true">x</mi><mo is="true">)</mo></mrow><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mtable is="true"><mtr is="true"><mtd columnalign="left" is="true"><mrow is="true"><mi is="true">x</mi><mspace width="4.pt" is="true"></mspace><mtext is="true">if</mtext><mspace width="4.pt" is="true"></mspace><mi is="true">x</mi><mo is="true">≥</mo><mn is="true">0</mn></mrow></mtd></mtr><mtr is="true"><mtd columnalign="left" is="true"><mrow is="true"><mi is="true">α</mi><mi is="true">x</mi><mspace width="4.pt" is="true"></mspace><mtext is="true">if</mtext><mspace width="4.pt" is="true"></mspace><mi is="true">x</mi><mo is="true">&lt;</mo><mn is="true">0</mn></mrow></mtd></mtr></mtable></mrow></mrow></math></script></span></span></span>The parameter <em>α</em> in the PReLU activation function is learnt during training, along with other network weights. In this context we initialise the network parameters using MSRA (<a name="bbib0017" href="#bib0017" class="workspace-trigger">He et&nbsp;al., 2015</a>) as it is an appropriate choice when employing PReLU activation units.</p><p id="para0031">Many authors (<a name="bbib0018" href="#bib0018" class="workspace-trigger">Hinton, Srivastava, Krizhevsky, Sutskever, Salakhutdinov</a>, <a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky, Sutskever, Hinton, 2012</a>) reported that the tendency of the network to overfit can be decreased by using a technique called “drop-out” during training which inhibits the outputs of a random fraction of the neurons of the fully connected layers in each iteration. In this way it is possible to limit their excessive specialisation to specific tasks, which is believed to be at the origin of overfitting in CNNs.</p><p id="para0032">Finally, we employ max-pooling layers to reduce the dimensionality of the data as it traverses the network. The input of the pooling layer is exhaustively subdivided into sub-patches having fixed size and overlapping by an amount controlled by the “stride” parameter. Only the maximal value in each sub-patch is forwarded to the next layer. This procedure is known to incorporate a spatial <a href="/topics/engineering/invariance" title="Learn more about invariance from ScienceDirect's AI-generated Topic Pages" class="topic-link">invariance</a><span> to the network which contradicts the desired <a href="/topics/engineering/localisation" title="Learn more about localisation from ScienceDirect's AI-generated Topic Pages" class="topic-link">localisation</a> accuracy required for segmentation. For this reason we limit the usage of pooling layers to the minimum amount required to meet the existing hardware constraints.</span></p></section><section id="sec0005"><h3 id="sectt0008" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.2. Voxel-wise classification</h3><div><p id="para0033">A set <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>T</mi><mo is=&quot;true&quot;>=</mo><mo is=&quot;true&quot;>{</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>p</mi><mn is=&quot;true&quot;>1</mn></msub><mo is=&quot;true&quot;>,</mo><mo is=&quot;true&quot;>&amp;#x2026;</mo><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>p</mi><mi is=&quot;true&quot;>N</mi></msub><mo is=&quot;true&quot;>}</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="18.177ex" height="2.709ex" viewBox="0 -847.3 7826.2 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-54"></use></g><g is="true" transform="translate(1078,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2134,0)"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(2635,0)"><g is="true"><use xlink:href="#MJMAINB-70"></use></g><g is="true" transform="translate(639,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(3728,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(4173,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(5512,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(5957,0)"><g is="true"><use xlink:href="#MJMAINB-70"></use></g><g is="true" transform="translate(639,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(7325,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="bold" is="true">T</mi><mo is="true">=</mo><mo is="true">{</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mn is="true">1</mn></msub><mo is="true">,</mo><mo is="true">…</mo><mo is="true">,</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">N</mi></msub><mo is="true">}</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-11"><math><mrow is="true"><mi mathvariant="bold" is="true">T</mi><mo is="true">=</mo><mo is="true">{</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mn is="true">1</mn></msub><mo is="true">,</mo><mo is="true">…</mo><mo is="true">,</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">N</mi></msub><mo is="true">}</mo></mrow></math></script></span> of square (or cubic) patches having size <em>p</em> pixels is extracted from <em>J</em> annotated volumes <em>V<sub>j</sub></em> with <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>J</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>}</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.184ex" height="2.709ex" viewBox="0 -847.3 5676.4 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"></g><g is="true" transform="translate(400,0)"><use xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(1090,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2035,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(1167,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(2506,0)"><use xlink:href="#MJMATHI-4A"></use></g><g is="true" transform="translate(3140,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mspace width="4.pt" is="true"></mspace><mi is="true">j</mi><mo is="true">∈</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi><mo stretchy="true" is="true">}</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-12"><math><mrow is="true"><mspace width="4.pt" is="true"></mspace><mi is="true">j</mi><mo is="true">∈</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi><mo stretchy="true" is="true">}</mo></mrow></mrow></math></script></span> along with the corresponding ground truth labels <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>Y</mi><mo is=&quot;true&quot;>=</mo><mo is=&quot;true&quot;>{</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mn is=&quot;true&quot;>1</mn></msub><mo is=&quot;true&quot;>,</mo><mo is=&quot;true&quot;>&amp;#x2026;</mo><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi><mi is=&quot;true&quot;>N</mi></msub><mo is=&quot;true&quot;>}</mo><mo is=&quot;true&quot;>&amp;#x2208;</mo><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="22.164ex" height="2.709ex" viewBox="0 -847.3 9542.8 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-59"></use></g><g is="true" transform="translate(1147,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2203,0)"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(2704,0)"><g is="true"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(3648,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(4093,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(5432,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(5877,0)"><g is="true"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(7096,0)"><use xlink:href="#MJMAIN-7D"></use></g><g is="true" transform="translate(7875,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(8820,0)"><use xlink:href="#MJAMS-52"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="bold" is="true">Y</mi><mo is="true">=</mo><mo is="true">{</mo><msub is="true"><mi is="true">y</mi><mn is="true">1</mn></msub><mo is="true">,</mo><mo is="true">…</mo><mo is="true">,</mo><msub is="true"><mi is="true">y</mi><mi is="true">N</mi></msub><mo is="true">}</mo><mo is="true">∈</mo><mi mathvariant="double-struck" is="true">R</mi></mrow></math></span></span><script type="math/mml" id="MathJax-Element-13"><math><mrow is="true"><mi mathvariant="bold" is="true">Y</mi><mo is="true">=</mo><mo is="true">{</mo><msub is="true"><mi is="true">y</mi><mn is="true">1</mn></msub><mo is="true">,</mo><mo is="true">…</mo><mo is="true">,</mo><msub is="true"><mi is="true">y</mi><mi is="true">N</mi></msub><mo is="true">}</mo><mo is="true">∈</mo><mi mathvariant="double-struck" is="true">R</mi></mrow></math></script></span><span><span>. Based on this training set CNNs are optimised to categorise the patches correctly. The resulting trained networks are capable of performing voxel-wise <a href="/topics/computer-science/classification" title="Learn more about classification from ScienceDirect's AI-generated Topic Pages" class="topic-link">classification</a>, also called semantic segmentation, of volumes by interpreting them in a patch-wise fashion. However, due to the lack of </span><a href="/topics/computer-science/regularization" title="Learn more about regularisation from ScienceDirect's AI-generated Topic Pages" class="topic-link">regularisation</a> and enforcement of statistical priors this approach delivers sub-optimal results (</span><a name="bfig0007" href="#fig0007" class="workspace-trigger">Fig.&nbsp;7</a><span>). For this reason we introduce a novel <a href="/topics/computer-science/segmentation-method" title="Learn more about segmentation method from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation method</a> that is based on simultaneous localisation of the anatomy of interest and robust contour extraction (</span><a name="bfig0002" href="#fig0002" class="workspace-trigger">Fig.&nbsp;2</a>).</p><figure class="figure text-xs" id="fig0002"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr2.jpg" height="277" alt="Fig. 2" aria-describedby="cap0002"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr2_lrg.jpg" target="_blank" download="" title="Download high-res image (227KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (227KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr2.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0002"><p id="spara0006"><span class="label">Fig. 2</span>. <span>Schematic representation in 2D of the Hough-CNN <a href="/topics/computer-science/segmentation-approach" title="Learn more about segmentation approach from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation approach</a><span>. a) The volume is interpreted patch-wise and classified using the <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNN from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNN</a>. b) Every pixel of the foreground (red) casts one or multiple votes in order to localise the anatomy </span></span><a href="/topics/engineering/centroid" title="Learn more about centroid from ScienceDirect's AI-generated Topic Pages" class="topic-link">centroid</a>. c) The votes accumulate in a vote-map, represented here in jet colormap, and the object centroid is found at the location of maximum vote accumulation. d) All the votes that accumulated close to the detected anatomy centroid contribute to the final contour by projecting a binary segmentation patch (here shown in red and white to indicate foreground and background respectively) at the location they were cast from. e) A contour confidence map is constructed by accumulating all the contributions associated to the votes. f) The resulting contour, depicted in purple, is retrieved by thresholding the confidence map. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></span></span></figure></div></section><section id="sec0006"><h3 id="sectt0009" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.3. Hough voting with CNN</h3><p id="para0034"><span>We introduce a robust <a href="/topics/computer-science/segmentation-approach" title="Learn more about segmentation approach from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation approach</a> that is scalable to multiple regions and implicitly encodes shape priors. This method employs a Hough-voting strategy to perform anatomy localisation and a database containing segmentation patches to retrieve the contour of the anatomy. Instead of relying only on categorical predictions produced by the CNNs we also make use of features extracted from their intermediate layers, in particular from the second-last fully connected one. Several authors (</span><a name="bbib0013" href="#bib0013" class="workspace-trigger">Farfade, Saberian, Li, 2015</a>, <a name="bbib0014" href="#bib0014" class="workspace-trigger">Girshick, Donahue, Darrell, Malik, 2014</a>, <a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky, Sutskever, Hinton, 2012</a><span>) have reported that these features (sometimes also called descriptors) can be used for tasks such as <a href="/topics/computer-science/image-retrieval" title="Learn more about image retrieval from ScienceDirect's AI-generated Topic Pages" class="topic-link">image retrieval</a> by mapping images to the feature space and identifying their neighbours. These findings are employed at the core of our voting strategy.</span></p><p id="para0035">To keep our notation as simple and understandable as possible we describe our approach for single region segmentation in the following.</p><p id="para0036">During <em>training</em>, we make use of the dataset of training volumes <strong>V</strong><sub><em>j</em></sub> with <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>J</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>}</mo></mrow><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.218ex" height="2.703ex" viewBox="0 -845.5 6121.6 1163.9" role="img" focusable="false" style="vertical-align: -0.739ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"></g><g is="true" transform="translate(400,0)"><use xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(1090,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2035,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(1167,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(2506,0)"><use xlink:href="#MJMATHI-4A"></use></g><g is="true" transform="translate(3140,0)"><use xlink:href="#MJMAIN-7D"></use></g></g><g is="true" transform="translate(5843,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mspace width="4.pt" is="true"></mspace><mi is="true">j</mi><mo is="true">∈</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi><mo stretchy="true" is="true">}</mo></mrow><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-14"><math><mrow is="true"><mspace width="4.pt" is="true"></mspace><mi is="true">j</mi><mo is="true">∈</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi><mo stretchy="true" is="true">}</mo></mrow><mo is="true">,</mo></mrow></math></script></span> and respective binary segmentation volumes <strong>S</strong><sub><em>j</em></sub> with <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-15-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mi is=&quot;true&quot;>j</mi><mo is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>J</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>}</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="13.184ex" height="2.703ex" viewBox="0 -845.5 5676.4 1163.9" role="img" focusable="false" style="vertical-align: -0.739ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"></g><g is="true" transform="translate(400,0)"><use xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(1090,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2035,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(1167,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(2506,0)"><use xlink:href="#MJMATHI-4A"></use></g><g is="true" transform="translate(3140,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mspace width="4.pt" is="true"></mspace><mi is="true">j</mi><mo is="true">∈</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi><mo stretchy="true" is="true">}</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-15"><math><mrow is="true"><mspace width="4.pt" is="true"></mspace><mi is="true">j</mi><mo is="true">∈</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi><mo stretchy="true" is="true">}</mo></mrow></mrow></math></script></span>. We collect patches from both foreground and background and train a CNN. As a result, we obtain the parameters <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-16-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3B8;</mi><mo is=&quot;true&quot;>^</mo></mover></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="1.356ex" height="2.703ex" viewBox="0 -1056.4 583.8 1163.9" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true" transform="translate(15,0)"><use xlink:href="#MJMATHI-3B8"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="83" y="255"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mover accent="true" is="true"><mi is="true">θ</mi><mo is="true">^</mo></mover></math></span></span><script type="math/mml" id="MathJax-Element-16"><math><mover accent="true" is="true"><mi is="true">θ</mi><mo is="true">^</mo></mover></math></script></span> that define the network. The CNN not only differentiates patches belonging to foreground and background through classification, but also associates each input to a feature vector obtained from its second-last fully connected layer. The macroscopic effect of the network can be summarised using two functions<span class="display"><span id="ueq0001" class="formula"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-17-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>f</mi><mn is=&quot;true&quot;>1</mn></msub><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>p</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3B8;</mi><mo is=&quot;true&quot;>^</mo></mover><mo is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>l</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>{</mo><mn is=&quot;true&quot;>0</mn><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>}</mo></mrow><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mtext is=&quot;true&quot;>and</mtext><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>f</mi><mn is=&quot;true&quot;>2</mn></msub><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>p</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>,</mo><mover accent=&quot;true&quot; is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3B8;</mi><mo is=&quot;true&quot;>^</mo></mover><mo is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>f</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msup is=&quot;true&quot;><mi mathvariant=&quot;double-struck&quot; is=&quot;true&quot;>R</mi><mi is=&quot;true&quot;>d</mi></msup></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.173ex" height="4.549ex" viewBox="0 -1217.1 21171.5 1958.7" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-66"></use></g><g is="true" transform="translate(490,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1111,0)"><use xlink:href="#MJSZ2-28" is="true"></use><g is="true" transform="translate(597,0)"><g is="true"><use xlink:href="#MJMAINB-70"></use></g><g is="true" transform="translate(639,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1581,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2026,0)"><g is="true" transform="translate(15,0)"><use xlink:href="#MJMATHI-3B8"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="83" y="255"></use></g><use xlink:href="#MJSZ2-29" is="true" x="2610" y="-1"></use></g><g is="true" transform="translate(4596,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(5652,0)"><g is="true"><use xlink:href="#MJMATHI-6C"></use></g><g is="true" transform="translate(298,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(6573,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(7518,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-30"></use></g><g is="true" transform="translate(1001,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1446,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(1946,0)"><use xlink:href="#MJMAIN-7D"></use></g></g><g is="true"></g><g is="true" transform="translate(10532,0)"><use xlink:href="#MJMAIN-61"></use><use xlink:href="#MJMAIN-6E" x="500" y="0"></use><use xlink:href="#MJMAIN-64" x="1057" y="0"></use></g><g is="true"></g><g is="true" transform="translate(12546,0)"><g is="true"><use xlink:href="#MJMAINB-66"></use></g><g is="true" transform="translate(351,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g><g is="true" transform="translate(13518,0)"><use xlink:href="#MJSZ2-28" is="true"></use><g is="true" transform="translate(597,0)"><g is="true"><use xlink:href="#MJMAINB-70"></use></g><g is="true" transform="translate(639,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1581,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2026,0)"><g is="true" transform="translate(15,0)"><use xlink:href="#MJMATHI-3B8"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="83" y="255"></use></g><use xlink:href="#MJSZ2-29" is="true" x="2610" y="-1"></use></g><g is="true" transform="translate(17003,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(18059,0)"><g is="true"><use xlink:href="#MJMAINB-66"></use></g><g is="true" transform="translate(351,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(19033,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(19978,0)"><g is="true"><use xlink:href="#MJAMS-52"></use></g><g is="true" transform="translate(722,362)"><use transform="scale(0.707)" xlink:href="#MJMATHI-64"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">f</mi><mn is="true">1</mn></msub><mrow is="true"><mo is="true">(</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">i</mi></msub><mo is="true">,</mo><mover accent="true" is="true"><mi is="true">θ</mi><mo is="true">^</mo></mover><mo is="true">)</mo></mrow><mo is="true">=</mo><msub is="true"><mi is="true">l</mi><mi is="true">i</mi></msub><mo is="true">∈</mo><mrow is="true"><mo is="true">{</mo><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn><mo is="true">}</mo></mrow><mspace width="4.pt" is="true"></mspace><mtext is="true">and</mtext><mspace width="4.pt" is="true"></mspace><msub is="true"><mi mathvariant="bold" is="true">f</mi><mn is="true">2</mn></msub><mrow is="true"><mo is="true">(</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">i</mi></msub><mo is="true">,</mo><mover accent="true" is="true"><mi is="true">θ</mi><mo is="true">^</mo></mover><mo is="true">)</mo></mrow><mo is="true">=</mo><msub is="true"><mi mathvariant="bold" is="true">f</mi><mi is="true">i</mi></msub><mo is="true">∈</mo><msup is="true"><mi mathvariant="double-struck" is="true">R</mi><mi is="true">d</mi></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-17"><math><mrow is="true"><msub is="true"><mi is="true">f</mi><mn is="true">1</mn></msub><mrow is="true"><mo is="true">(</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">i</mi></msub><mo is="true">,</mo><mover accent="true" is="true"><mi is="true">θ</mi><mo is="true">^</mo></mover><mo is="true">)</mo></mrow><mo is="true">=</mo><msub is="true"><mi is="true">l</mi><mi is="true">i</mi></msub><mo is="true">∈</mo><mrow is="true"><mo is="true">{</mo><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn><mo is="true">}</mo></mrow><mspace width="4.pt" is="true"></mspace><mtext is="true">and</mtext><mspace width="4.pt" is="true"></mspace><msub is="true"><mi mathvariant="bold" is="true">f</mi><mn is="true">2</mn></msub><mrow is="true"><mo is="true">(</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">i</mi></msub><mo is="true">,</mo><mover accent="true" is="true"><mi is="true">θ</mi><mo is="true">^</mo></mover><mo is="true">)</mo></mrow><mo is="true">=</mo><msub is="true"><mi mathvariant="bold" is="true">f</mi><mi is="true">i</mi></msub><mo is="true">∈</mo><msup is="true"><mi mathvariant="double-struck" is="true">R</mi><mi is="true">d</mi></msup></mrow></math></script></span></span></span>respectively mapping each input patch <strong>p</strong><sub><em>i</em></sub> to its label <em>l<sub>i</sub></em> and to the feature <strong>f</strong><sub><em>i</em></sub>, which has as many dimensions <em>d</em> as there are neurons in the fully connected layer it is collected from.</p><p id="para0037">We exhaustively collect a dataset <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-18-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>T</mi><mo is=&quot;true&quot;>=</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>p</mi><mn is=&quot;true&quot;>1</mn></msub><mo is=&quot;true&quot;>&amp;#x2026;</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>p</mi><mi is=&quot;true&quot;>N</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>}</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.496ex" height="2.703ex" viewBox="0 -845.5 7102.6 1163.9" role="img" focusable="false" style="vertical-align: -0.739ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-54"></use></g><g is="true" transform="translate(1078,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2134,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAINB-70"></use></g><g is="true" transform="translate(639,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1760,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(3099,0)"><g is="true"><use xlink:href="#MJMAINB-70"></use></g><g is="true" transform="translate(639,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(4467,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="bold" is="true">T</mi><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mn is="true">1</mn></msub><mo is="true">…</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">N</mi></msub><mo stretchy="true" is="true">}</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-18"><math><mrow is="true"><mi mathvariant="bold" is="true">T</mi><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mn is="true">1</mn></msub><mo is="true">…</mo><msub is="true"><mi mathvariant="bold" is="true">p</mi><mi is="true">N</mi></msub><mo stretchy="true" is="true">}</mo></mrow></mrow></math></script></span> of either 2D, 2.5D or 3D patches from the locations <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-19-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>X</mi><mo is=&quot;true&quot;>=</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mn is=&quot;true&quot;>1</mn></msub><mo is=&quot;true&quot;>&amp;#x2026;</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>N</mi></msub><mo stretchy=&quot;true&quot; is=&quot;true&quot;>}</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="16.508ex" height="2.703ex" viewBox="0 -845.5 7107.6 1163.9" role="img" focusable="false" style="vertical-align: -0.739ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-58"></use></g><g is="true" transform="translate(1147,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2203,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1728,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(3067,0)"><g is="true"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(4403,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi mathvariant="bold" is="true">X</mi><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mn is="true">1</mn></msub><mo is="true">…</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">N</mi></msub><mo stretchy="true" is="true">}</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-19"><math><mrow is="true"><mi mathvariant="bold" is="true">X</mi><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mn is="true">1</mn></msub><mo is="true">…</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">N</mi></msub><mo stretchy="true" is="true">}</mo></mrow></mrow></math></script></span> of the foreground region of each of the training volumes <strong>V</strong><sub><em>j</em></sub>, and we use the CNN to obtain the features <strong>f</strong><sub><em>i</em></sub> introduced before. Our goal is to create a database storing triples consisting of a feature vector <strong>f</strong><sub><em>i</em></sub>, a vote <strong>v</strong><sub><em>i</em></sub> and a segmentation patch <strong>s</strong><sub><em>i</em></sub>.</p><p id="para0038">The vote <strong>v</strong><sub><em>i</em></sub> is a displacement vector joining the voxel <strong>x</strong><sub><em>i</em></sub>, where the <em>i</em><span>th patch was collected from, and the position anatomy <a href="/topics/engineering/centroid" title="Learn more about centroid from ScienceDirect's AI-generated Topic Pages" class="topic-link">centroid</a> </span><strong>c</strong><sub><em>j</em></sub> in the training volume <strong>V</strong><sub><em>j</em></sub>:<span class="display"><span id="ueq0002" class="formula"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-20-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>v</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>c</mi><mi is=&quot;true&quot;>j</mi></msub><mo is=&quot;true&quot;>;</mo><mspace width=&quot;0.28em&quot; is=&quot;true&quot; /><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>c</mi><mi is=&quot;true&quot;>j</mi></msub><mo is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>|</mo></mrow><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mi is=&quot;true&quot;>g</mi></msub><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>|</mo></mrow></mrow></mfrac><munder is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>&amp;#x2208;</mo><msub is=&quot;true&quot;><mi is=&quot;true&quot;>F</mi><mi is=&quot;true&quot;>g</mi></msub></mrow></munder><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>i</mi></msub></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.978ex" height="3.936ex" viewBox="0 -952.9 14198.7 1694.5" role="img" focusable="false" style="vertical-align: -1.722ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAINB-76"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(1229,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2285,0)"><g is="true"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(3459,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(4460,0)"><g is="true"><use xlink:href="#MJMAINB-63"></use></g><g is="true" transform="translate(511,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(5363,0)"><use xlink:href="#MJMAIN-3B"></use></g><g is="true"></g><g is="true" transform="translate(6088,0)"><g is="true"><use xlink:href="#MJMAINB-63"></use></g><g is="true" transform="translate(511,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g><g is="true" transform="translate(7269,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(8048,0)"><g transform="translate(397,0)"><rect stroke="none" width="1279" height="60" x="0" y="220"></rect><g is="true" transform="translate(462,409)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(60,-440)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-7C" is="true"></use></g><g is="true" transform="translate(196,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(455,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-67"></use></g></g><g is="true" transform="translate(962,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-7C" is="true"></use></g></g></g></g><g is="true" transform="translate(10012,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(429,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(673,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(1145,0)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-46"></use></g><g is="true" transform="translate(455,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-67"></use></g></g></g></g><g is="true" transform="translate(13246,0)"><g is="true"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi mathvariant="bold" is="true">v</mi><mi is="true">i</mi></msub><mo is="true">=</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">−</mo><msub is="true"><mi mathvariant="bold" is="true">c</mi><mi is="true">j</mi></msub><mo is="true">;</mo><mspace width="0.28em" is="true"></mspace><msub is="true"><mi mathvariant="bold" is="true">c</mi><mi is="true">j</mi></msub><mo is="true">=</mo><mfrac is="true"><mn is="true">1</mn><mrow is="true"><mrow is="true"><mo is="true">|</mo></mrow><msub is="true"><mi is="true">F</mi><mi is="true">g</mi></msub><mrow is="true"><mo is="true">|</mo></mrow></mrow></mfrac><munder is="true"><mo is="true">∑</mo><mrow is="true"><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">∈</mo><msub is="true"><mi is="true">F</mi><mi is="true">g</mi></msub></mrow></munder><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub></mrow></math></span></span><script type="math/mml" id="MathJax-Element-20"><math><mrow is="true"><msub is="true"><mi mathvariant="bold" is="true">v</mi><mi is="true">i</mi></msub><mo is="true">=</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">−</mo><msub is="true"><mi mathvariant="bold" is="true">c</mi><mi is="true">j</mi></msub><mo is="true">;</mo><mspace width="0.28em" is="true"></mspace><msub is="true"><mi mathvariant="bold" is="true">c</mi><mi is="true">j</mi></msub><mo is="true">=</mo><mfrac is="true"><mn is="true">1</mn><mrow is="true"><mrow is="true"><mo is="true">|</mo></mrow><msub is="true"><mi is="true">F</mi><mi is="true">g</mi></msub><mrow is="true"><mo is="true">|</mo></mrow></mrow></mfrac><munder is="true"><mo is="true">∑</mo><mrow is="true"><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">∈</mo><msub is="true"><mi is="true">F</mi><mi is="true">g</mi></msub></mrow></munder><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub></mrow></math></script></span></span></span>where <em>F<sub>g</sub></em> is the set of all the voxels belonging to foreground. The binary segmentation patches assume values 1 or 0 respectively for foreground and background area since they are collected from the positions <strong>x</strong><sub><em>i</em></sub> of the binary annotation volumes <strong>S</strong><sub><em>j</em></sub>.</p><p id="para0039">During <em>testing</em>, in order to segment a previously unseen volume <em>I</em>, we make use of both the trained CNN and the database established before. We first obtain the classification label for each voxel <strong>x</strong><sub><em>i</em></sub> by processing the relative patch <strong>p</strong><sub><em>i</em></sub> through the CNN, which delivers also the features <strong>f</strong><sub><em>i</em></sub> for all the patches being classified as foreground. Each of such features is compared to those contained in the database in order to retrieve the <em>K</em><span> closest entries using <a href="/topics/computer-science/euclidean-distance" title="Learn more about Euclidean distance from ScienceDirect's AI-generated Topic Pages" class="topic-link">Euclidean distance</a> as criterion. This </span><em>K</em>-nearest neighbour search (<em>K</em>-nn) (<a name="bbib0032" href="#bib0032" class="workspace-trigger">Muja and Lowe, 2014</a>) is performed computing Euclidean distances <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-21-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>d</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>K</mi></mrow><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.65ex" height="3.071ex" viewBox="0 -898.3 2432.5 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(524,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(520,-320)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(1182,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi is="true">d</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-21"><math><msubsup is="true"><mi is="true">d</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></math></script></span> between features, as previously done in <a name="bbib0022" href="#bib0022" class="workspace-trigger">Krizhevsky et&nbsp;al. (2012)</a> for image retrieval.</p><p id="para0040">Once the neighbours are identified, their votes <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-22-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>v</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>K</mi></mrow><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.852ex" height="3.071ex" viewBox="0 -898.3 2519.5 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-76"></use></g><g is="true" transform="translate(607,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(607,-320)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(1182,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">v</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-22"><math><msubsup is="true"><mi mathvariant="bold" is="true">v</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></math></script></span> and associated segmentation patches <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-23-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>s</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>K</mi></mrow><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.496ex" height="3.071ex" viewBox="0 -898.3 2366.5 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-73"></use></g><g is="true" transform="translate(454,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(454,-320)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(1182,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-23"><math><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></math></script></span> from the database, are employed to respectively perform localisation and segmentation. The votes are weighted by the reciprocal of the Euclidean distance computed during <em>K</em>-nn search <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-24-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mi is=&quot;true&quot;>w</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>K</mi></mrow></msub><mo is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>d</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>K</mi></mrow><mi is=&quot;true&quot;>i</mi></msubsup></mfrac></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="14.034ex" height="4.05ex" viewBox="0 -951 6042.5 1743.8" role="img" focusable="false" style="vertical-align: -1.841ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-77"></use></g><g is="true" transform="translate(716,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(1182,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g></g></g><g is="true" transform="translate(2906,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(3684,0)"><g transform="translate(397,0)"><rect stroke="none" width="1840" height="60" x="0" y="220"></rect><g is="true" transform="translate(743,409)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(60,-539)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(370,298)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(368,-177)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(250,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(836,0)"><use transform="scale(0.5)" xlink:href="#MJMATHI-4B"></use></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msub is="true"><mi is="true">w</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow></msub><mo is="true">=</mo><mfrac is="true"><mn is="true">1</mn><msubsup is="true"><mi is="true">d</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></mfrac></mrow></math></span></span><script type="math/mml" id="MathJax-Element-24"><math><mrow is="true"><msub is="true"><mi is="true">w</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow></msub><mo is="true">=</mo><mfrac is="true"><mn is="true">1</mn><msubsup is="true"><mi is="true">d</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi></mrow><mi is="true">i</mi></msubsup></mfrac></mrow></math></script></span> and contribute to a vote-map at positions<span class="display"><span id="ueq0003" class="formula"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-25-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>v</mi><mo is=&quot;true&quot;>^</mo></mover><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup><mo is=&quot;true&quot;>=</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>+</mo><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>v</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup><mo is=&quot;true&quot;>;</mo><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><mo is=&quot;true&quot;>&amp;#x2200;</mo><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>{</mo><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>K</mi><mo is=&quot;true&quot;>}</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="29.507ex" height="3.322ex" viewBox="0 -1005.7 12704.4 1430.4" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAINB-76"></use></g><use xlink:href="#MJSZ1-2C6" is="true" x="25" y="-26"></use></g><g is="true" transform="translate(607,446)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(607,-248)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1354,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2410,0)"><g is="true"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(3584,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(4585,0)"><g is="true"><use xlink:href="#MJMAINB-76"></use></g><g is="true" transform="translate(607,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(607,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(5661,0)"><use xlink:href="#MJMAIN-3B"></use></g><g is="true"></g><g is="true" transform="translate(6506,0)"><use xlink:href="#MJMAIN-2200"></use></g><g is="true" transform="translate(7062,0)"><use xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(7862,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(8807,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(1167,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(2506,0)"><use xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(3396,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msubsup is="true"><mover accent="true" is="true"><mi mathvariant="bold" is="true">v</mi><mo is="true">^</mo></mover><mi is="true">k</mi><mi is="true">i</mi></msubsup><mo is="true">=</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">+</mo><msubsup is="true"><mi mathvariant="bold" is="true">v</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup><mo is="true">;</mo><mspace width="4.pt" is="true"></mspace><mo is="true">∀</mo><mi is="true">k</mi><mo is="true">∈</mo><mrow is="true"><mo is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi><mo is="true">}</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-25"><math><mrow is="true"><msubsup is="true"><mover accent="true" is="true"><mi mathvariant="bold" is="true">v</mi><mo is="true">^</mo></mover><mi is="true">k</mi><mi is="true">i</mi></msubsup><mo is="true">=</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">+</mo><msubsup is="true"><mi mathvariant="bold" is="true">v</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup><mo is="true">;</mo><mspace width="4.pt" is="true"></mspace><mo is="true">∀</mo><mi is="true">k</mi><mo is="true">∈</mo><mrow is="true"><mo is="true">{</mo><mn is="true">1</mn><mo is="true">…</mo><mi is="true">K</mi><mo is="true">}</mo></mrow></mrow></math></script></span></span></span>We repeat the steps described above for each of the patches that were classified as foreground (<a name="bfig0002" href="#fig0002" class="workspace-trigger">Fig.&nbsp;2</a>b). Since the region of interest occurs only once in each volume, we smooth the final vote map and retrieve the region centroid by finding the location <strong>c</strong> where the maximal value of the vote map is reached (<a name="bfig0002" href="#fig0002" class="workspace-trigger">Fig.&nbsp;2</a>c). Smoothing reduces the possibility of small localisation mistakes due to “noise” in the vote map around the position where its maximum occurs.</p><p id="para0041">The region of interest can now be segmented by re-projecting the votes <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-26-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>v</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.5ex" height="3.071ex" viewBox="0 -898.3 1076.3 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-76"></use></g><g is="true" transform="translate(607,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(607,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">v</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-26"><math><msubsup is="true"><mi mathvariant="bold" is="true">v</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></script></span> to the locations <strong>x</strong><sub><em>i</em></sub> where they have been originated from. However, not all the votes should be re-projected, since a relevant portion of them is erroneous, i.e. did not contribute to the vote-map anywhere close to the estimated anatomy location. Thus, only those that contributed to the vote-map within a certain range <em>r</em> from the predicted centroid are taken into consideration and are actually allowed to contribute to the final segmentation contour with their own segmentation patch <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-27-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.144ex" height="3.071ex" viewBox="0 -898.3 923.3 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-73"></use></g><g is="true" transform="translate(454,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(454,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-27"><math><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></script></span>. The segmentation patches <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-28-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.144ex" height="3.071ex" viewBox="0 -898.3 923.3 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-73"></use></g><g is="true" transform="translate(454,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(454,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-28"><math><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></script></span> are centred at the location <strong>x</strong><sub><em>i</em></sub>, weighted by <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-29-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>w</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.753ex" height="3.071ex" viewBox="0 -898.3 1185.3 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-77"></use></g><g is="true" transform="translate(716,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(716,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi is="true">w</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-29"><math><msubsup is="true"><mi is="true">w</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></script></span><span> and accumulated in the <a href="/topics/computer-science/segmentation-map" title="Learn more about segmentation map from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation map</a> </span><strong>S</strong> (<a name="bfig0002" href="#fig0002" class="workspace-trigger">Fig.&nbsp;2</a>d). Assuming that the segmentation patches <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-30-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.144ex" height="3.071ex" viewBox="0 -898.3 923.3 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-73"></use></g><g is="true" transform="translate(454,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(454,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-30"><math><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></script></span><span> have been extended to an infinite <a href="/topics/computer-science/spatial-extent" title="Learn more about spatial extent from ScienceDirect's AI-generated Topic Pages" class="topic-link">spatial extent</a> by zero-padding, we can write:</span><span class="display"><span id="ueq0004" class="formula"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-31-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>S</mi><mo is=&quot;true&quot;>^</mo></mover><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>=</mo><munder is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>i</mi></msub></munder><munderover is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mi is=&quot;true&quot;>K</mi></munderover><mi is=&quot;true&quot;>I</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>d</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><msubsup is=&quot;true&quot;><mover accent=&quot;true&quot; is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>v</mi><mo is=&quot;true&quot;>^</mo></mover><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>i</mi></msubsup><mo is=&quot;true&quot;>,</mo><mover accent=&quot;true&quot; is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>c</mi><mo is=&quot;true&quot;>^</mo></mover><mo is=&quot;true&quot;>)</mo></mrow><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>w</mi><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>k</mi></mrow><mi is=&quot;true&quot;>i</mi></msubsup><mspace width=&quot;4.pt&quot; is=&quot;true&quot; /><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mi is=&quot;true&quot;>i</mi></msub><mo is=&quot;true&quot;>)</mo></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="45.714ex" height="3.568ex" viewBox="0 -1058.6 19682.4 1536" role="img" focusable="false" style="vertical-align: -1.109ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAINB-53"></use></g><use xlink:href="#MJSZ1-2C6" is="true" x="41" y="228"></use></g><g is="true" transform="translate(806,0)"><g is="true"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(389,0)"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(997,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(2470,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(3526,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(429,-107)"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(5522,0)"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g><g is="true" transform="translate(1056,477)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g><g is="true" transform="translate(368,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(919,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(8119,0)"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(8623,0)"><use xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(9224,0)"><use xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(9914,0)"><use xlink:href="#MJSZ1-28" is="true"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-76"></use></g><use xlink:href="#MJSZ1-2C6" is="true" x="25" y="-26"></use></g><g is="true" transform="translate(607,446)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(607,-248)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g><g is="true" transform="translate(1534,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1979,0)"><g is="true"><use xlink:href="#MJMAINB-63"></use></g><use xlink:href="#MJMAIN-2C6" is="true" x="5" y="3"></use></g><use xlink:href="#MJSZ1-29" is="true" x="2491" y="-1"></use></g><g is="true"></g><g is="true" transform="translate(13430,0)"><g is="true"><use xlink:href="#MJMATHI-77"></use></g><g is="true" transform="translate(716,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(716,-327)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g><g is="true"></g><g is="true" transform="translate(15016,0)"><g is="true"><use xlink:href="#MJMATHI-73"></use></g><g is="true" transform="translate(469,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(469,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(16121,0)"><g is="true"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(389,0)"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(1219,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(2219,0)"><g is="true"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(607,-150)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g><g is="true" transform="translate(3171,0)"><use xlink:href="#MJMAIN-29"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mover accent="true" is="true"><mi mathvariant="bold" is="true">S</mi><mo is="true">^</mo></mover><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">x</mi><mo is="true">)</mo></mrow><mo is="true">=</mo><munder is="true"><mo is="true">∑</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub></munder><munderover is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></munderover><mi is="true">I</mi><mi is="true">n</mi><mi is="true">d</mi><mrow is="true"><mo is="true">(</mo><msubsup is="true"><mover accent="true" is="true"><mi mathvariant="bold" is="true">v</mi><mo is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mi is="true">i</mi></msubsup><mo is="true">,</mo><mover accent="true" is="true"><mi mathvariant="bold" is="true">c</mi><mo is="true">^</mo></mover><mo is="true">)</mo></mrow><mspace width="4.pt" is="true"></mspace><msubsup is="true"><mi is="true">w</mi><mrow is="true"><mi is="true">k</mi></mrow><mi is="true">i</mi></msubsup><mspace width="4.pt" is="true"></mspace><msubsup is="true"><mi is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">x</mi><mo is="true">−</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">)</mo></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-31"><math><mrow is="true"><mover accent="true" is="true"><mi mathvariant="bold" is="true">S</mi><mo is="true">^</mo></mover><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">x</mi><mo is="true">)</mo></mrow><mo is="true">=</mo><munder is="true"><mo is="true">∑</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub></munder><munderover is="true"><mo is="true">∑</mo><mrow is="true"><mi is="true">k</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mi is="true">K</mi></munderover><mi is="true">I</mi><mi is="true">n</mi><mi is="true">d</mi><mrow is="true"><mo is="true">(</mo><msubsup is="true"><mover accent="true" is="true"><mi mathvariant="bold" is="true">v</mi><mo is="true">^</mo></mover><mrow is="true"><mi is="true">k</mi></mrow><mi is="true">i</mi></msubsup><mo is="true">,</mo><mover accent="true" is="true"><mi mathvariant="bold" is="true">c</mi><mo is="true">^</mo></mover><mo is="true">)</mo></mrow><mspace width="4.pt" is="true"></mspace><msubsup is="true"><mi is="true">w</mi><mrow is="true"><mi is="true">k</mi></mrow><mi is="true">i</mi></msubsup><mspace width="4.pt" is="true"></mspace><msubsup is="true"><mi is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">x</mi><mo is="true">−</mo><msub is="true"><mi mathvariant="bold" is="true">x</mi><mi is="true">i</mi></msub><mo is="true">)</mo></mrow></mrow></math></script></span></span></span><span class="display"><span id="ueq0005" class="formula"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-32-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>I</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>d</mi><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>a</mi><mo is=&quot;true&quot;>,</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>b</mi><mo is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>=</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>{</mo><mtable is=&quot;true&quot;><mtr is=&quot;true&quot;><mtd columnalign=&quot;left&quot; is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mtd><mtd columnalign=&quot;left&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2225;</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>a</mi><mo is=&quot;true&quot;>&amp;#x2212;</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>b</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2225;</mo></mrow><mo is=&quot;true&quot;>&amp;lt;</mo><mi is=&quot;true&quot;>r</mi></mrow></mtd></mtr><mtr is=&quot;true&quot;><mtd columnalign=&quot;left&quot; is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn></mtd><mtd columnalign=&quot;left&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2225;</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>a</mi><mo is=&quot;true&quot;>&amp;#x2212;</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>b</mi><mo stretchy=&quot;true&quot; is=&quot;true&quot;>&amp;#x2225;</mo></mrow><mo is=&quot;true&quot;>&amp;#x2265;</mo><mi is=&quot;true&quot;>r</mi></mrow></mtd></mtr></mtable></mrow></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="30.5ex" height="6.267ex" viewBox="0 -1586.9 13131.7 2698.3" role="img" focusable="false" style="vertical-align: -2.581ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-49"></use></g><g is="true" transform="translate(504,0)"><use xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(1105,0)"><use xlink:href="#MJMATHI-64"></use></g><g is="true" transform="translate(1795,0)"><g is="true"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(389,0)"><use xlink:href="#MJMAINB-61"></use></g><g is="true" transform="translate(949,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1394,0)"><use xlink:href="#MJMAINB-62"></use></g><g is="true" transform="translate(2033,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(4496,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(5552,0)"><use xlink:href="#MJSZ3-7B" is="true"></use><g is="true" transform="translate(917,0)"><g transform="translate(-15,0)"><g is="true" transform="translate(0,716)"><g is="true"><use xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(0,-766)"><g is="true"><use xlink:href="#MJMAIN-30"></use></g></g></g><g transform="translate(1286,0)"><g is="true" transform="translate(0,716)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAIN-2225"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAINB-61"></use></g><g is="true" transform="translate(1282,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(2282,0)"><use xlink:href="#MJMAINB-62"></use></g><g is="true" transform="translate(2922,0)"><use xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(3700,0)"><use xlink:href="#MJMAIN-3C"></use></g><g is="true" transform="translate(4757,0)"><use xlink:href="#MJMATHI-72"></use></g></g></g><g is="true" transform="translate(0,-766)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMAIN-2225"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAINB-61"></use></g><g is="true" transform="translate(1282,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(2282,0)"><use xlink:href="#MJMAINB-62"></use></g><g is="true" transform="translate(2922,0)"><use xlink:href="#MJMAIN-2225"></use></g></g><g is="true" transform="translate(3700,0)"><use xlink:href="#MJMAIN-2265"></use></g><g is="true" transform="translate(4757,0)"><use xlink:href="#MJMATHI-72"></use></g></g></g></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">I</mi><mi is="true">n</mi><mi is="true">d</mi><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">a</mi><mo is="true">,</mo><mi mathvariant="bold" is="true">b</mi><mo is="true">)</mo></mrow><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mtable is="true"><mtr is="true"><mtd columnalign="left" is="true"><mn is="true">1</mn></mtd><mtd columnalign="left" is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">∥</mo><mi mathvariant="bold" is="true">a</mi><mo is="true">−</mo><mi mathvariant="bold" is="true">b</mi><mo stretchy="true" is="true">∥</mo></mrow><mo is="true">&lt;</mo><mi is="true">r</mi></mrow></mtd></mtr><mtr is="true"><mtd columnalign="left" is="true"><mn is="true">0</mn></mtd><mtd columnalign="left" is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">∥</mo><mi mathvariant="bold" is="true">a</mi><mo is="true">−</mo><mi mathvariant="bold" is="true">b</mi><mo stretchy="true" is="true">∥</mo></mrow><mo is="true">≥</mo><mi is="true">r</mi></mrow></mtd></mtr></mtable></mrow></mrow></math></span></span><script type="math/mml" id="MathJax-Element-32"><math><mrow is="true"><mi is="true">I</mi><mi is="true">n</mi><mi is="true">d</mi><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">a</mi><mo is="true">,</mo><mi mathvariant="bold" is="true">b</mi><mo is="true">)</mo></mrow><mo is="true">=</mo><mrow is="true"><mo stretchy="true" is="true">{</mo><mtable is="true"><mtr is="true"><mtd columnalign="left" is="true"><mn is="true">1</mn></mtd><mtd columnalign="left" is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">∥</mo><mi mathvariant="bold" is="true">a</mi><mo is="true">−</mo><mi mathvariant="bold" is="true">b</mi><mo stretchy="true" is="true">∥</mo></mrow><mo is="true">&lt;</mo><mi is="true">r</mi></mrow></mtd></mtr><mtr is="true"><mtd columnalign="left" is="true"><mn is="true">0</mn></mtd><mtd columnalign="left" is="true"><mrow is="true"><mrow is="true"><mo stretchy="true" is="true">∥</mo><mi mathvariant="bold" is="true">a</mi><mo is="true">−</mo><mi mathvariant="bold" is="true">b</mi><mo stretchy="true" is="true">∥</mo></mrow><mo is="true">≥</mo><mi is="true">r</mi></mrow></mtd></mtr></mtable></mrow></mrow></math></script></span></span></span>In this sense, the segmentation patches <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-33-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="2.144ex" height="3.071ex" viewBox="0 -898.3 923.3 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-73"></use></g><g is="true" transform="translate(454,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(454,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></span></span><script type="math/mml" id="MathJax-Element-33"><math><msubsup is="true"><mi mathvariant="bold" is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup></math></script></span> can be seen as basis functions <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-34-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><msubsup is=&quot;true&quot;><mi is=&quot;true&quot;>s</mi><mi is=&quot;true&quot;>k</mi><mi is=&quot;true&quot;>i</mi></msubsup><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>(</mo><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>,</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.82ex" height="3.071ex" viewBox="0 -898.3 2936.6 1322" role="img" focusable="false" style="vertical-align: -0.984ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-73"></use></g><g is="true" transform="translate(469,352)"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(469,-327)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6B"></use></g></g><g is="true" transform="translate(1104,0)"><g is="true"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(389,0)"><use xlink:href="#MJMAINB-78"></use></g><g is="true" transform="translate(997,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(2658,0)"><use xlink:href="#MJMAIN-2C"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><msubsup is="true"><mi is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">x</mi><mo is="true">)</mo></mrow><mo is="true">,</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-34"><math><mrow is="true"><msubsup is="true"><mi is="true">s</mi><mi is="true">k</mi><mi is="true">i</mi></msubsup><mrow is="true"><mo is="true">(</mo><mi mathvariant="bold" is="true">x</mi><mo is="true">)</mo></mrow><mo is="true">,</mo></mrow></math></script></span> which take binary values, that need to be scaled and re-centered at appropriate locations in order to produce the desired effect in the segmentation map. Once the segmentation map <strong>S</strong> is normalised to take only values comprised between 0 and 1, it is thresholded and the final contour is obtained.</p><p id="para0042">The approach is summarised schematically in <a name="bfig0002" href="#fig0002" class="workspace-trigger">Fig.&nbsp;2</a>. Extending this method to multiple regions requires little effort. In our implementation, we treated each region independently by creating region-specific databases as well as dedicated vote-maps and segmentations. The memory requirements of this approach can be decreased by retrieving the segmentation patches directly from the volumes <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-35-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>S</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>J</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.506ex" height="2.458ex" viewBox="0 -792.8 2370.4 1058.4" role="img" focusable="false" style="vertical-align: -0.617ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-53"></use></g><g is="true" transform="translate(639,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(1182,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4A"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mi mathvariant="bold" is="true">S</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi></mrow></msub></math></span></span><script type="math/mml" id="MathJax-Element-35"><math><msub is="true"><mi mathvariant="bold" is="true">S</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi></mrow></msub></math></script></span> instead of storing them in the database. In this case, the database contains coordinates that are used to fetch contour portions from the <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-36-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mi mathvariant=&quot;bold&quot; is=&quot;true&quot;>S</mi><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>&amp;#x2026;</mo><mi is=&quot;true&quot;>J</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.506ex" height="2.458ex" viewBox="0 -792.8 2370.4 1058.4" role="img" focusable="false" style="vertical-align: -0.617ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAINB-53"></use></g><g is="true" transform="translate(639,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(353,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(1182,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-4A"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mi mathvariant="bold" is="true">S</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi></mrow></msub></math></span></span><script type="math/mml" id="MathJax-Element-36"><math><msub is="true"><mi mathvariant="bold" is="true">S</mi><mrow is="true"><mn is="true">1</mn><mo is="true">…</mo><mi is="true">J</mi></mrow></msub></math></script></span>.</p></section><section id="sec0007"><h3 id="sectt0010" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.4. Efficient patch-wise evaluation through CNN</h3><p id="para0043">When dealing with images or volumes, patches are extracted in a sliding-window fashion and processed through a CNN. This approach is inefficient due to the high amount of redundant computations that need to be performed for neighbouring patches. In case no padding is used within the convolutional layers, the whole volume can be convolved with the respective kernels in one pass, instead of treating each patch separately, while achieving the same result. The same holds true for pooling layers whose pooling windows can be arranged to process the whole volume at once. However, as soon as fully connected layers are employed, the volume can no longer be processed in one pass due to the fact that the connections of this layer are limited to the size of the input patch.</p><p id="para0044"><span>To solve this issue we modify the <a href="/topics/computer-science/network-structure" title="Learn more about network structure from ScienceDirect's AI-generated Topic Pages" class="topic-link">network structure</a> as proposed by </span><a name="bbib0042" href="#bib0042" class="workspace-trigger">Sermanet et&nbsp;al. (2013b</a>) in order to be able to process the whole volume at once, yet retrieving the same results that we would obtain if the data would be processed patch-wise.</p></section></section><section id="sec0008"><h2 id="sectt0011" class="u-h3 u-margin-l-top u-margin-xs-bottom">4. Experiments and results</h2><div><p id="para0045"><span>In this section we show that <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNNs from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNNs</a> not only can be used to robustly segment medical volumes (</span><a name="bfig0003" href="#fig0003" class="workspace-trigger">Fig. 3</a>, <a name="bfig0004" href="#fig0004" class="workspace-trigger">Fig. 4</a><span>), but they also posses the ability of learning extremely effective features (outputs of upper layers) from the data. Even in ultrasound, where the structures of interest are often not clearly visible or the images are affected by <a href="/topics/engineering/artefact" title="Learn more about artefacts from ScienceDirect's AI-generated Topic Pages" class="topic-link">artefacts</a>, CNNs are able to focus on salient information and therefore recognise patterns. We demonstrate the superior performances of our Hough-voting-based segmentation algorithm by evaluating our method on two datasets of US and MRI volumes depicting the human brain. The two modalities provide complementary information, but are inherently different both from the point of view of the challenges they offer and the range of anatomy they can image.</span></p><figure class="figure text-xs" id="fig0003"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr3.jpg" height="217" alt="Fig. 3" aria-describedby="cap0003"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr3_lrg.jpg" target="_blank" download="" title="Download high-res image (116KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (116KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr3.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0003"><p id="spara0007"><span class="label">Fig. 3</span>. <span>Visual comparison of semantic segmentation results (top) and Hough-CNN results (bottom) on the same <a href="/topics/computer-science/ultrasound-data" title="Learn more about ultrasound data from ScienceDirect's AI-generated Topic Pages" class="topic-link">ultrasound data</a> using the best-performing </span><a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNN from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNN</a>. Red areas represent ground truth annotation. Red contours represent segmentation outputs. Best viewed in digital format.</p></span></span></figure><figure class="figure text-xs" id="fig0004"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr4.jpg" height="390" alt="Fig. 4" aria-describedby="cap0004"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr4_lrg.jpg" target="_blank" download="" title="Download high-res image (415KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (415KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr4.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0004"><p id="spara0008"><span class="label">Fig. 4</span>. Visual comparison of semantic segmentation results (top two rows) and Hough-CNN results (bottom two rows) on same MRI volumes using the same trained <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNN from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNN</a>. Coloured areas represent ground truth annotation. Coloured contours represent segmentation outputs. Best viewed in digital format.</p></span></span></figure></div><section id="sec0009"><h3 id="sectt0012" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.1. Datasets and ground-truth definition</h3><p id="para0046">Our MRI dataset is composed of MRI volumes of 55 subjects, which were acquired using 3D gradient-echo imaging (magnitude and phase) with an isotropic spatial resolution of 1x1x1 mm. The sequence (<a name="bbib0010" href="#bib0010" class="workspace-trigger">Dietrich et&nbsp;al., 2015</a><span>) is designed for quantitative susceptibility mapping (QSM) and sensitivity towards <a href="/topics/engineering/iron-deposits" title="Learn more about iron deposits from ScienceDirect's AI-generated Topic Pages" class="topic-link">iron deposits</a><span>. These are biomarkers for movement disorders like Parkinson’s Disease and create visible contrast in relevant basal ganglia like SN and <a href="/topics/engineering/subthalamic-nucleus" title="Learn more about STN from ScienceDirect's AI-generated Topic Pages" class="topic-link">STN</a>. For our study, basal ganglia and other deep-brain structures were annotated in an atlas volume in two ways. One set of bi-lateral atlas labels (brainstem, n. accumbens, amygdala, caudate, thalamus, hippocampus, pallidum, putamen) were annotated semi-automatically via a shape- and appearance-model segmentation (FSL FIRST (</span></span><a name="bbib0034" href="#bib0034" class="workspace-trigger">Patenaude et&nbsp;al., 2011</a>)) plus manual correction of generated labels (one neuroimage technician, verified by one expert neurologist). Another set of bi-lateral labels (separation of pallidus into GPi and GPe, midbrain, red nucleus, substantia nigra pars compacta and substantia nigra pars reticulata) was annotated in a fully manual manner (neuroimage technician, verified by expert neurologist) based on visible contrast. The atlas labels were transferred using a state-of-the-art atlas approach (<a name="bbib0002" href="#bib0002" class="workspace-trigger">Avants et&nbsp;al., 2010</a>). As a summary, the list of structures of interest is also visible in <a name="bfig0006" href="#fig0006" class="workspace-trigger">Fig.&nbsp;6</a>.</p><p id="para0047">The US dataset was acquired transcranially on 34 subjects, with several freehand 3D sweeps recorded through the left and right temporal bone window each. Altogether, 162 volumes were acquired with slight variations in bone window positioning, and reconstructed at 1–mm isotropic resolution. For all 162 TCUS volumes, midbrain outlines were annotated in 3D by a single human expert. Inter-rater agreement of the midbrain annotations, in terms of Dice coefficient, has been reported in <a name="bbib0036" href="#bib0036" class="workspace-trigger">Plate et&nbsp;al. (2012)</a><span> to be 0.85. CNN training was performed on data from 8 subjects (40 sweeps), and testing on data from 24 previously unseen subjects (114 sweeps), while validation data was performed on 8 sweeps from 2 subjects. Performing segmentation on more than 100 test volumes is a good indicator of actual clinical applicability of (Hough-)CNN-based segmentation. The experiments show that the method generalises very well on previously unseen data, which is a highly <a href="/topics/computer-science/desirable-property" title="Learn more about desirable property from ScienceDirect's AI-generated Topic Pages" class="topic-link">desirable property</a> in clinical settings.</span></p><p id="para0048"><span>In order to test our approach and to benchmark the capabilities of the proposed CNNs when they are trained with a variable amount of data, we establish, for each dimensionality (2D, 2.5D and 3D) two differently sized training sets in US and three in MRI respectively. For each of the 40 training volumes in US we collect either 2K or 10K patches per volume such that half of the training set depicts the background and the other half the foreground. The resulting training sets have respective sizes of 80K and 400K patches. A validation set containing 5K patches has been established for US using images of subjects that have not been used for training or testing and employed to assess the <a href="/topics/computer-science/generalization" title="Learn more about generalisation from ScienceDirect's AI-generated Topic Pages" class="topic-link">generalisation</a> capabilities of the models. From the 45 MRI training volumes, we extract either circa 100, 1K or 10K patches per volume </span><em>per region</em> (including background). The resulting training sets have respective sizes of 135K, 1.35M and 13.5M patches.</p></section><section id="sec0010"><h3 id="sectt0013" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.2. CNN parameters</h3><p id="para0049"><span>We analyse six different <a href="/topics/computer-science/network-architecture" title="Learn more about network architectures from ScienceDirect's AI-generated Topic Pages" class="topic-link">network architectures</a>, presented in </span><a name="btbl0001" href="#tbl0001" class="workspace-trigger">Table&nbsp;1</a><span>, by training each of them for 15 epochs using Stochastic <a href="/topics/computer-science/gradient-descent" title="Learn more about Gradient Descent from ScienceDirect's AI-generated Topic Pages" class="topic-link">Gradient Descent</a> (SGD) with mini-batches of 64 or 124 samples, learning rate varying between </span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-37-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mn is=&quot;true&quot;>10</mn><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2212;</mo><mn is=&quot;true&quot;>2</mn></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="4.658ex" height="2.463ex" viewBox="0 -952.9 2005.4 1060.6" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-30" x="500" y="0"></use></g><g is="true" transform="translate(1001,393)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mn is="true">10</mn><mrow is="true"><mo is="true">−</mo><mn is="true">2</mn></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-37"><math><msup is="true"><mn is="true">10</mn><mrow is="true"><mo is="true">−</mo><mn is="true">2</mn></mrow></msup></math></script></span> and <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-38-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn><mo is=&quot;true&quot;>&amp;#xB7;</mo><msup is=&quot;true&quot;><mn is=&quot;true&quot;>10</mn><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2212;</mo><mn is=&quot;true&quot;>3</mn></mrow></msup></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.499ex" height="2.463ex" viewBox="0 -952.9 3228.8 1060.6" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-35"></use></g><g is="true" transform="translate(722,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1223,0)"><g is="true"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-30" x="500" y="0"></use></g><g is="true" transform="translate(1001,393)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mn is="true">5</mn><mo is="true">·</mo><msup is="true"><mn is="true">10</mn><mrow is="true"><mo is="true">−</mo><mn is="true">3</mn></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-38"><math><mrow is="true"><mn is="true">5</mn><mo is="true">·</mo><msup is="true"><mn is="true">10</mn><mrow is="true"><mo is="true">−</mo><mn is="true">3</mn></mrow></msup></mrow></math></script></span> depending on the individual network architecture, momentum 0.9 and weight decay <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-39-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>5</mn><mo is=&quot;true&quot;>&amp;#xB7;</mo><msup is=&quot;true&quot;><mn is=&quot;true&quot;>10</mn><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2212;</mo><mn is=&quot;true&quot;>4</mn></mrow></msup></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.499ex" height="2.463ex" viewBox="0 -952.9 3228.8 1060.6" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-35"></use></g><g is="true" transform="translate(722,0)"><use xlink:href="#MJMAIN-22C5"></use></g><g is="true" transform="translate(1223,0)"><g is="true"><use xlink:href="#MJMAIN-31"></use><use xlink:href="#MJMAIN-30" x="500" y="0"></use></g><g is="true" transform="translate(1001,393)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-34"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mn is="true">5</mn><mo is="true">·</mo><msup is="true"><mn is="true">10</mn><mrow is="true"><mo is="true">−</mo><mn is="true">4</mn></mrow></msup></mrow></math></span></span><script type="math/mml" id="MathJax-Element-39"><math><mrow is="true"><mn is="true">5</mn><mo is="true">·</mo><msup is="true"><mn is="true">10</mn><mrow is="true"><mo is="true">−</mo><mn is="true">4</mn></mrow></msup></mrow></math></script></span>. All our models converged after a few epochs, and often before the seventh epoch.</p><p id="para0050">Each network is analysed three times, with patches capturing the same amount of context from the neighbourhood, but having different dimensionality. That is, our networks process 2D data, 2.5D data and 3D data in order to investigate how the networks respond to the higher amount of information carried by patches in 2.5D and 3D patches compared to 2D. During training, we randomly sample patches from annotated volumes and we feed them to the networks along with their ground truth labels. The patches of the 2<em>D</em> dataset are all square and have a size of 31 × 31 pixels; the 2.5D dataset is composed of patches having the same size and three channels consisting of 2D patches from the sagittal, coronal and transversal plane centred at the same location; the 3D dataset contains cubic patches having size 31 × 31 × 31 voxels.</p><div><p id="para0051">Some of the parameters supplied to our Hough-CNN algorithm are empirically chosen. Parameters names and respective values are reported in <a name="btbl0002" href="#tbl0002" class="workspace-trigger">Table&nbsp;2</a>. These parameters remained constant throughout all experiments, both in ultrasound and MRI. All the trainings were performed on Intel i7 quad-core workstations with 32GB of ram and graphic cards from Nvidia, specifically “Tesla k40” or “Titan X” (12GB VRAM). All tests were made on a similar workstation equipped with a Nvidia GTX 980 (4GB VRAM).</p><div class="tables rowsep-0 colsep-0 frame-topbot" id="tbl0002"><span class="captions"><span id="cap0010"><p id="spara0014"><span class="label">Table 2</span>. Parameters of the model utilised during the experiments.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1"><th scope="row" class="align-left valign-top">Parameter name</th><th scope="row" class="align-left valign-top">Value</th></tr></thead><tbody><tr><th class="align-left valign-top" scope="row">Tolerance radius <em>r</em> for reprojection</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-40-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>r</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>3</mn></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.31ex" height="2.057ex" viewBox="0 -747.8 2286.1 885.4" role="img" focusable="false" style="vertical-align: -0.32ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-72"></use></g><g is="true" transform="translate(729,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1785,0)"><use xlink:href="#MJMAIN-33"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">r</mi><mo is="true">=</mo><mn is="true">3</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-40"><math><mrow is="true"><mi is="true">r</mi><mo is="true">=</mo><mn is="true">3</mn></mrow></math></script></span> voxels</td></tr><tr><th class="align-left valign-top" scope="row">Amount of smoothing for vote-maps</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-41-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3C3;</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="5.591ex" height="2.057ex" viewBox="0 -747.8 2407.1 885.4" role="img" focusable="false" style="vertical-align: -0.32ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3C3"></use></g><g is="true" transform="translate(850,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1906,0)"><use xlink:href="#MJMAIN-31"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">σ</mi><mo is="true">=</mo><mn is="true">1</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-41"><math><mrow is="true"><mi is="true">σ</mi><mo is="true">=</mo><mn is="true">1</mn></mrow></math></script></span></td></tr><tr><th class="align-left valign-top" scope="row">Maximum number of neighbours K-NN</th><td class="align-left valign-top"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-42-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>K</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>20</mn></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="7.489ex" height="2.214ex" viewBox="0 -815.6 3224.6 953.3" role="img" focusable="false" style="vertical-align: -0.32ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4B"></use></g><g is="true" transform="translate(1167,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2223,0)"><use xlink:href="#MJMAIN-32"></use><use xlink:href="#MJMAIN-30" x="500" y="0"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mrow is="true"><mi is="true">K</mi><mo is="true">=</mo><mn is="true">20</mn></mrow></math></span></span><script type="math/mml" id="MathJax-Element-42"><math><mrow is="true"><mi is="true">K</mi><mo is="true">=</mo><mn is="true">20</mn></mrow></math></script></span></td></tr><tr><th class="align-left valign-top" scope="row">Maximal distance of K-NN neighbours (US)</th><td class="align-left valign-top">2.5</td></tr><tr><th class="align-left valign-top" scope="row">Maximal distance of K-NN neighbours (MRI)</th><td class="align-left valign-top">6.0</td></tr><tr><th class="align-left valign-top" scope="row">Size of segmentation patch</th><td class="align-left valign-top">9 × 9 × 9</td></tr></tbody></table></div></div></div></section><section id="sec0011"><h3 id="sectt0014" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.3. Experiments and results in ultrasound</h3><p id="para0052">We train our CNNs with different amount of data having different dimensionality, as explained in <a name="bsec0009" href="#sec0009" class="workspace-trigger">Section&nbsp;4.1</a>. Each of the six proposed architectures is trained six times (five for 3D) in order to cover all the possible combinations of dimensionalities (2D, 2.5D, 3D patches) and amount of data (training set sizes 80K, 400K). We test each CNN on 114 ultrasound volumes acquired from subjects whose scans have never been used during training or validation.</p><div><p id="para0053"><a name="btbl0003" href="#tbl0003" class="workspace-trigger">Table&nbsp;3</a><span> shows the average performance in terms of Dice coefficients, mean distances of the estimated contours to the ground truth annotations and failure rates of the proposed Hough-CNN <a href="/topics/computer-science/segmentation-approach" title="Learn more about segmentation approach from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation approach</a><span> when different CNNs are employed. Since we segment one region per volume, the failure rate represents the percentage of volumes where the region of interest could not be segmented due to wrong <a href="/topics/engineering/localisation" title="Learn more about localisation from ScienceDirect's AI-generated Topic Pages" class="topic-link">localisation</a> (Dice 0). In </span></span><a name="bfig0005" href="#fig0005" class="workspace-trigger">Fig.&nbsp;5</a> we provide summary of the performances of each network, when various amounts of training data are used and patches of different dimensionality are supplied. Better networks produce Dice histograms whose higher values are occurring far away from the origin.</p><div class="tables rowsep-0 colsep-0 frame-topbot" id="tbl0003"><span class="captions"><span id="cap0011"><p id="spara0015"><span class="label">Table 3</span>. Midbrain segmentation results in 114 previously unseen TCUS volumes, using Hough-CNN with variations of architectures (single rows), patch dimensionalities (column blocks) and training set sizes (row blocks). The best result for each architecture (across the data dimensionalities) are highlighted by using bold typeface. The best results for each dimensionality (across the architectures) are underlined.</p></span></span><div class="groups"><table><thead><tr><th scope="row" class="align-left valign-top">Dimensionality →</th><th scope="row" class="align-left rowsep-1" colspan="3">2D</th><th scope="row" class="align-left rowsep-1" colspan="3">2.5D</th><th scope="row" class="align-left rowsep-1" colspan="3">3D</th></tr><tr class="rowsep-1"><th scope="row" class="align-left valign-top">Averages →</th><th scope="row" class="align-left valign-top">Dice [0, 1]</th><th scope="row" class="align-left valign-top">Distance (mm)</th><th scope="row" class="align-left valign-top">Failures</th><th scope="row" class="align-left valign-top">Dice [0, 1]</th><th scope="row" class="align-left valign-top">Distance (mm)</th><th scope="row" class="align-left valign-top">Failures</th><th scope="row" class="align-left valign-top">Dice [0, 1]</th><th scope="row" class="align-left valign-top">Distance (mm)</th><th scope="row" class="align-left valign-top">Failures</th></tr></thead><tbody><tr><th class="align-left valign-top" scope="row" colspan="10">Training set size 80K patches</th></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3</th><td class="align-left valign-top"><strong>0.83</strong></td><td class="align-left valign-top">0.92</td><td class="align-left valign-top">3%</td><td class="align-left valign-top"><u>0.82</u></td><td class="align-left valign-top">0.91</td><td class="align-left valign-top">5%</td><td class="align-left valign-top">0.79</td><td class="align-left valign-top">0.95</td><td class="align-left valign-top">6%</td></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3-3-3-3</th><td class="align-left valign-top">0.80</td><td class="align-left valign-top">0.93</td><td class="align-left valign-top">5%</td><td class="align-left valign-top">0.80</td><td class="align-left valign-top">0.94</td><td class="align-left valign-top">4%</td><td class="align-left valign-top"><u><strong>0.82</strong></u></td><td class="align-left valign-top">0.99</td><td class="align-left valign-top">5%</td></tr><tr><th class="align-left valign-top" scope="row">5-5-5-5-5</th><td class="align-left valign-top">0.77</td><td class="align-left valign-top">1.07</td><td class="align-left valign-top">9%</td><td class="align-left valign-top">0.74</td><td class="align-left valign-top">1.11</td><td class="align-left valign-top">14%</td><td class="align-left valign-top"><strong>0.80</strong></td><td class="align-left valign-top">1.02</td><td class="align-left valign-top">6%</td></tr><tr><th class="align-left valign-top" scope="row">7-5-3</th><td class="align-left valign-top">0.80</td><td class="align-left valign-top">0.96</td><td class="align-left valign-top">5%</td><td class="align-left valign-top"><strong>0.81</strong></td><td class="align-left valign-top">1.00</td><td class="align-left valign-top">5%</td><td class="align-left valign-top">0.80</td><td class="align-left valign-top">1.02</td><td class="align-left valign-top">7%</td></tr><tr><th class="align-left valign-top" scope="row">9-7-5-3-3</th><td class="align-left valign-top">0.79</td><td class="align-left valign-top">0.96</td><td class="align-left valign-top">7%</td><td class="align-left valign-top">0.81</td><td class="align-left valign-top">0.93</td><td class="align-left valign-top">5%</td><td class="align-left valign-top"><u><strong>0.82</strong></u></td><td class="align-left valign-top">0.99</td><td class="align-left valign-top">7%</td></tr><tr><th class="align-left valign-top" scope="row">SmallAlex</th><td class="align-left valign-top"><u><strong>0.85</strong></u></td><td class="align-left valign-top">0.81</td><td class="align-left valign-top">1%</td><td class="align-left valign-top">0.81</td><td class="align-left valign-top">0.98</td><td class="align-left valign-top">5%</td><td class="align-left valign-top">0.80</td><td class="align-left valign-top">0.98</td><td class="align-left valign-top">3%</td></tr><tr><th class="align-left valign-top" scope="row" colspan="10">Training set size: 400K patches</th></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3</th><td class="align-left valign-top"><strong>0.84</strong></td><td class="align-left valign-top">0.90</td><td class="align-left valign-top">1%</td><td class="align-left valign-top"><u>0.83</u></td><td class="align-left valign-top">0.95</td><td class="align-left valign-top">3%</td><td class="align-left valign-top">–</td><td class="align-left valign-top">–</td><td class="align-left valign-top">–</td></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3-3-3-3</th><td class="align-left valign-top"><u><strong>0.85</strong></u></td><td class="align-left valign-top">0.90</td><td class="align-left valign-top">0%</td><td class="align-left valign-top"><u>0.83</u></td><td class="align-left valign-top">0.99</td><td class="align-left valign-top">3%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">5-5-5-5-5</th><td class="align-left valign-top"><strong>0.83</strong></td><td class="align-left valign-top">0.94</td><td class="align-left valign-top">2%</td><td class="align-left valign-top">0.81</td><td class="align-left valign-top">1.03</td><td class="align-left valign-top">5%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">7-5-3</th><td class="align-left valign-top"><strong>0.83</strong></td><td class="align-left valign-top">0.94</td><td class="align-left valign-top">2%</td><td class="align-left valign-top">0.81</td><td class="align-left valign-top">0.99</td><td class="align-left valign-top">5%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">9-7-5-3-3</th><td class="align-left valign-top"><strong>0.82</strong></td><td class="align-left valign-top">1.01</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><strong>0.82</strong></td><td class="align-left valign-top">0.96</td><td class="align-left valign-top">5%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">SmallAlex</th><td class="align-left valign-top"><strong>0.83</strong></td><td class="align-left valign-top">0.91</td><td class="align-left valign-top">3%</td><td class="align-left valign-top">0.81</td><td class="align-left valign-top">0.94</td><td class="align-left valign-top">4%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr></tbody></table></div></div><figure class="figure text-xs" id="fig0005"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr5.jpg" height="739" alt="Fig. 5" aria-describedby="cap0005"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr5_lrg.jpg" target="_blank" download="" title="Download high-res image (532KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (532KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr5.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0005"><p id="spara0009"><span class="label">Fig. 5</span>. <span>The midbrain <a href="/topics/computer-science/segmentation-performance" title="Learn more about segmentation performance from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation performance</a> of each network on 114 TCUS test volumes, under different training conditions, is summarised through histograms. The horizontal axis is subdivided in Dice bins having a width of 0.05 Dice. The vertical axis represents the number of volumes falling in each Dice bin. Each </span><a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNN from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNN</a> architecture is depicted with its own colour.</p></span></span></figure></div><p id="para0054">Visual examples of ultrasound segmentation results are visible in <a name="bfig0003" href="#fig0003" class="workspace-trigger">Fig.&nbsp;3</a>. It is notable that the Hough-CNN segmentation is able to localise and segment the midbrain accurately, regardless of whether the scan was acquired through the left or right bone window. It is also robust to bone window quality and overall visibility of structures, as well as signal-drop regions and blurring.</p></section><section id="sec0012"><h3 id="sectt0015" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.4. Experiments and results in MRI</h3><p id="para0055">We train each of our networks nine times (eight for 3D) in order to explore all the possible combination of different data dimensionality and size of the training set as explained in <a name="bsec0009" href="#sec0009" class="workspace-trigger">Section&nbsp;4.1</a>. We test each of the models on 10 volumes, using their respective atlas-based annotations for evaluation. We verified, through visual inspection performed by a technician and an expert neurologist, that the annotation appropriately delineate the regions of interest.</p><p id="para0056"><a name="btbl0005" href="#tbl0005" class="workspace-trigger">Table&nbsp;5</a><span> reports the average performance in terms of Dice coefficients, mean distances of the estimated contours to the ground truth annotations and failure rates of the proposed Hough-CNN segmentation approach when different CNNs are employed at its core. The failure rate, in particular, refers to the percentage of regions of the whole training set (total number: 26 × 10 regions), that were not segmented correctly by Hough-CNN due to the fact that they could not be correctly localised. The results are clustered by the size of the training set employed to train the model to improve <a href="/topics/engineering/readability" title="Learn more about readability from ScienceDirect's AI-generated Topic Pages" class="topic-link">readability</a> and the possibility of making comparisons between CNNs employing data having different dimensionality (2D, 2.5D and 3D). From these results we observe that the best performing architecture is “7-5-3”.</span></p><p id="para0057">In <a name="bfig0006" href="#fig0006" class="workspace-trigger">Fig.&nbsp;6</a> we compare the results achieved by the architecture “7-5-3”, on each of the 26 brain region of interest separately, when different data dimensionalities are used. The bar plot shows the results in terms of Dice coefficient, while the dashed line plot conveys the results in terms of average distance of the estimated contour to ground-truth delineation. We observe that Hough-CNN yields better Dice coefficients when bigger regions and high contrast area are segmented. Small and low contrast regions could be correctly localised but they were in general harder to segment.</p><p id="para0058">Visual examples of MRI segmentation results are visible in <a name="bfig0004" href="#fig0004" class="workspace-trigger">Fig.&nbsp;4</a><span>. It is notable that the Hough-CNN segmentation is able to correctly localise and segment multiple structures, despite large <a href="/topics/engineering/anatomical-variability" title="Learn more about anatomical variability from ScienceDirect's AI-generated Topic Pages" class="topic-link">anatomical variability</a><span>, such as cortical atrophy and enlarged <a href="/topics/engineering/lateral-ventricle" title="Learn more about lateral ventricles from ScienceDirect's AI-generated Topic Pages" class="topic-link">lateral ventricles</a>.</span></span></p></section><section id="sec0013"><h3 id="sectt0016" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.5. Comparison with fully convolutional models</h3><div><p id="para0059"><span>In order to put our results into prospective and compare our approach with other <a href="/topics/engineering/state-of-the-art-method" title="Learn more about state of the art methods from ScienceDirect's AI-generated Topic Pages" class="topic-link">state of the art methods</a>, we compared the results achieved by our Hough-CNN with the results achieved by V-Net (</span><a name="bbib0031" href="#bib0031" class="workspace-trigger">Milletari et&nbsp;al., 2016</a><span>). V-Net is a fully convolutional (FCNN) approach trained end to end, which makes use of short and long skip connection and residual blocks in its architecture. One of the particularities of V-Net is the use of a loss function based on Dice coefficient which is specifically tailored and has proved useful in binary <a href="/topics/computer-science/segmentation-task" title="Learn more about segmentation tasks from ScienceDirect's AI-generated Topic Pages" class="topic-link">segmentation tasks</a>. In our comparison we kept all the hyper-parameters of the model fixed to what the authors of </span><a name="bbib0031" href="#bib0031" class="workspace-trigger">Milletari et&nbsp;al. (2016)</a> used and trained the model for 20 thousand iterations, until convergence, on the same training set we employed to train Hough-CNN. When we evaluated the method on our training set we noticed that although the rate of failure (cases with Dice equal 0) was slightly lower, the contours were often leaking into regions that didn’t belong to the midbrain and in some cases their shape was not resembling any of the training shapes. As a result, the performance of V-Net on this dataset was much inferior to the one of Hough-CNN. This can be observed in <a name="bfig0008" href="#fig0008" class="workspace-trigger">Fig.&nbsp;8</a> and <a name="btbl0004" href="#tbl0004" class="workspace-trigger">Table&nbsp;4</a> where the distribution of dice coefficients across the test set and quantitative results and respectively shown. In particular, the results obtained on the ultrasound dataset by the best and the worst architectures employed in this study have been compared to V-Net and have clearly shown superior performances.</p><figure class="figure text-xs" id="fig0006"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr6.jpg" height="282" alt="Fig. 6" aria-describedby="cap0006"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr6_lrg.jpg" target="_blank" download="" title="Download high-res image (521KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (521KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr6.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0006"><p id="spara0010"><span class="label">Fig. 6</span>. Average Dice coefficients (bar-plot) and distances to ground-truth delineation (dashed-lines plot), obtained segmenting the MRI test volumes using the best-performing <a href="/topics/computer-science/network-architecture" title="Learn more about network architecture from ScienceDirect's AI-generated Topic Pages" class="topic-link">network architecture</a> “7-5-3”. Dice coefficients are shown for each of the 26 target regions. Results obtained considering 2D, 2.5D and 3D data are represented in grey, blue and orange respectively. Best segmentation were delivered when 3D data was fed into the network, although the model was trained with only 1.35 millions 3D patches instead of the 13.5 million patches that were employed to train the models dealing with 2D and 2.5D data. (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></span></span></figure><figure class="figure text-xs" id="fig0007"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr7.jpg" height="257" alt="Fig. 7" aria-describedby="cap0007"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr7_lrg.jpg" target="_blank" download="" title="Download high-res image (145KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (145KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr7.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0007"><p id="spara0011"><span class="label">Fig. 7</span>. Comparison of mean Dice coefficients obtained in 2<em>D</em>, 2.5<em>D</em> and 3<em>D</em> on US and MRI data using Hough-CNN and semantic segmentation.</p></span></span></figure><figure class="figure text-xs" id="fig0008"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr8.jpg" height="182" alt="Fig. 8" aria-describedby="cap0008"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr8_lrg.jpg" target="_blank" download="" title="Download high-res image (116KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (116KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1077314217300620-gr8.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0008"><p id="spara0012"><span class="label">Fig. 8</span>. Comparison Dice coefficient distribution obtained by running our experiments on the ultrasound dataset using our best Hough <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNN from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNN</a> model (blue), our worst Hough CNN model (green), and V-Net (orange). (For interpretation of the references to colour in this figure legend, the reader is referred to the web version of this article.)</p></span></span></figure><div class="tables rowsep-0 colsep-0 frame-topbot" id="tbl0004"><span class="captions"><span id="cap0012"><p id="spara0016"><span class="label">Table 4</span>. Comparison between Hough-CNN and V-Net on the ultrasound dataset.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1"><th scope="row" class="align-left valign-top">Method</th><th scope="row" class="align-left valign-top">Dice [0,1]</th><th scope="row" class="align-left valign-top">Failures</th></tr></thead><tbody><tr><th class="align-left valign-top" scope="row">Best Hough-CNN</th><td class="align-left valign-top">0.85</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">Worst Hough-CNN</th><td class="align-left valign-top">0.74</td><td class="align-left valign-top">14%</td></tr><tr><th class="align-left valign-top" scope="row">V-Net (FCNN)</th><td class="align-left valign-top">0.71</td><td class="align-left valign-top">1%</td></tr></tbody></table></div></div><div class="tables rowsep-0 colsep-0 frame-topbot" id="tbl0005"><span class="captions"><span id="cap0013"><p id="spara0017"><span class="label">Table 5</span>. Average segmentation results of 26 structures in 10 MRI test volumes, using Hough-CNN with variations of architectures (single rows), patch dimensionalities (column blocks) and training set sizes (row blocks). The best result for each architecture (across the data dimensionalities) are highlighted by using bold typeface. The best results for each dimensionality (across the architectures) are underlined. The best result is obtained using the architecture “7-5-3” and 3D data.</p></span></span><div class="groups"><table><thead><tr><th scope="row" class="align-left valign-top">Dimensionality →</th><th scope="row" class="align-left rowsep-1" colspan="3">2D</th><th scope="row" class="align-left rowsep-1" colspan="3">2.5D</th><th scope="row" class="align-left rowsep-1" colspan="3">3D</th></tr><tr class="rowsep-1"><th scope="row" class="align-left valign-top">Averages →</th><th scope="row" class="align-left valign-top">Dice [0, 1]</th><th scope="row" class="align-left valign-top">Distance (mm)</th><th scope="row" class="align-left valign-top">Failures</th><th scope="row" class="align-left valign-top">Dice [0, 1]</th><th scope="row" class="align-left valign-top">Distance (mm)</th><th scope="row" class="align-left valign-top">Failures</th><th scope="row" class="align-left valign-top">Dice [0, 1]</th><th scope="row" class="align-left valign-top">Distance (mm)</th><th scope="row" class="align-left valign-top">Failures</th></tr></thead><tbody><tr><th class="align-left valign-top" scope="row" colspan="10">Training set size: 135K patches</th></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3</th><td class="align-left valign-top">0.61</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">6%</td><td class="align-left valign-top">0.62</td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">3%</td><td class="align-left valign-top"><strong>0.70</strong></td><td class="align-left valign-top">0.46</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3-3-3-3</th><td class="align-left valign-top">0.61</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">8%</td><td class="align-left valign-top">0.61</td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">5%</td><td class="align-left valign-top"><strong>0.70</strong></td><td class="align-left valign-top">0.45</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">5-5-5-5-5</th><td class="align-left valign-top">0.64</td><td class="align-left valign-top">0.49</td><td class="align-left valign-top">6%</td><td class="align-left valign-top">0.63</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">1%</td><td class="align-left valign-top"><strong>0.71</strong></td><td class="align-left valign-top">0.44</td><td class="align-left valign-top">1%</td></tr><tr><th class="align-left valign-top" scope="row">7-5-3</th><td class="align-left valign-top"><u>0.67</u></td><td class="align-left valign-top">0.48</td><td class="align-left valign-top">4%</td><td class="align-left valign-top"><u>0.68</u></td><td class="align-left valign-top">0.48</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><u><strong>0.76</strong></u></td><td class="align-left valign-top">0.45</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">9-7-5-3-3</th><td class="align-left valign-top">0.60</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">8%</td><td class="align-left valign-top">0.61</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">3%</td><td class="align-left valign-top"><strong>0.68</strong></td><td class="align-left valign-top">0.49</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">SmallAlex</th><td class="align-left valign-top">0.61</td><td class="align-left valign-top">0.53</td><td class="align-left valign-top">5%</td><td class="align-left valign-top">0.62</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">5%</td><td class="align-left valign-top"><strong>0.71</strong></td><td class="align-left valign-top">0.46</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row" colspan="10">Training set size: 1.35M patches</th></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3</th><td class="align-left valign-top">0.63</td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">3%</td><td class="align-left valign-top">0.62</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">5%</td><td class="align-left valign-top"><strong>0.72</strong></td><td class="align-left valign-top">0.45</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3-3-3-3</th><td class="align-left valign-top">0.63</td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">3%</td><td class="align-left valign-top">0.62</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><strong>0.70</strong></td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">5-5-5-5-5</th><td class="align-left valign-top">0.64</td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">3%</td><td class="align-left valign-top">0.61</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">3%</td><td class="align-left valign-top"><strong>0.71</strong></td><td class="align-left valign-top">0.44</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">7-5-3</th><td class="align-left valign-top"><u>0.68</u></td><td class="align-left valign-top">0.47</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><u>0.68</u></td><td class="align-left valign-top">0.47</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><u><strong>0.77</strong></u></td><td class="align-left valign-top">0.45</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row">9-7-5-3-3</th><td class="align-left valign-top">0.63</td><td class="align-left valign-top">0.53</td><td class="align-left valign-top">4%</td><td class="align-left valign-top">0.62</td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><strong>0.68</strong></td><td class="align-left valign-top">0.47</td><td class="align-left valign-top">1%</td></tr><tr><th class="align-left valign-top" scope="row">SmallAlex</th><td class="align-left valign-top">0.64</td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">4%</td><td class="align-left valign-top">0.62</td><td class="align-left valign-top">0.53</td><td class="align-left valign-top">6%</td><td class="align-left valign-top"><strong>0.72</strong></td><td class="align-left valign-top">0.46</td><td class="align-left valign-top">0%</td></tr><tr><th class="align-left valign-top" scope="row" colspan="10">Training set size: 13.5M patches</th></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3</th><td class="align-left valign-top"><strong>0.64</strong></td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">3%</td><td class="align-left valign-top"><strong>0.64</strong></td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">3%</td><td class="align-left valign-top">–</td><td class="align-left valign-top">–</td><td class="align-left valign-top">–</td></tr><tr><th class="align-left valign-top" scope="row">3-3-3-3-3-3-3-3</th><td class="align-left valign-top"><strong>0.65</strong></td><td class="align-left valign-top">0.56</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><strong>0.65</strong></td><td class="align-left valign-top">0.54</td><td class="align-left valign-top">0%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">5-5-5-5-5</th><td class="align-left valign-top"><strong>0.64</strong></td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">2%</td><td class="align-left valign-top"><strong>0.64</strong></td><td class="align-left valign-top">0.51</td><td class="align-left valign-top">2%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">7-5-3</th><td class="align-left valign-top"><u><strong>0.68</strong></u></td><td class="align-left valign-top">0.49</td><td class="align-left valign-top">3%</td><td class="align-left valign-top"><u>0.67</u></td><td class="align-left valign-top">0.48</td><td class="align-left valign-top">3%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">9-7-5-3-3</th><td class="align-left valign-top"><strong>0.63</strong></td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">5%</td><td class="align-left valign-top"><strong>0.63</strong></td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">5%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr><tr><th class="align-left valign-top" scope="row">SmallAlex</th><td class="align-left valign-top"><strong>0.65</strong></td><td class="align-left valign-top">0.52</td><td class="align-left valign-top">4%</td><td class="align-left valign-top">0.63</td><td class="align-left valign-top">0.53</td><td class="align-left valign-top">5%</td><td class="align-left"></td><td class="align-left"></td><td class="align-left"></td></tr></tbody></table></div></div></div><p id="para0060">Unfortunately the same study could not be run on the MRI dataset due to the fact that V-Net does not support multiple regions and that other works from recent literature do not provide a readily working implementation or require too much memory to be tested on the hardware that is currently available to us. The limiting factor is in the latter case the memory which is required by the high resolution prediction layer that need to have as many high resolution channels as regions to be segmented.</p></section></section><section id="sec0014"><h2 id="sectt0017" class="u-h3 u-margin-l-top u-margin-xs-bottom">5. Discussion</h2><p id="para0061"><span><span>Training of <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNNs from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNNs</a> requires a large amount of data in order to achieve satisfactory voxel-wise </span><a href="/topics/computer-science/classification" title="Learn more about classification from ScienceDirect's AI-generated Topic Pages" class="topic-link">classification</a><span> results and perform semantic segmentation. However, as described in the introduction, obtaining such large annotated datasets is rarely possible in clinical settings. By using a voting-based strategy, it is possible to localise the anatomy of interest with high precision, even when the rate of mis-classified voxels is very high. Additionally, our Hough-CNN approach implicitly enforces shape priors which facilitate segmentations in images where the anatomy of interest is poorly visible. Furthermore, when using 3D patches, only 1.35M <a href="/topics/computer-science/training-patch" title="Learn more about training patches from ScienceDirect's AI-generated Topic Pages" class="topic-link">training patches</a> were required to surpass the performance obtained with datasets of 13.5 millions 2D and 2.5D patches. This marks a 90% reduction of required training data. In all three dimensionalities, 2D, 2.5D and 3D, Hough-CNN outperforms voxel-wise segmentation (cf. </span></span><a name="bfig0007" href="#fig0007" class="workspace-trigger">Fig.&nbsp;7</a>). Similar to related works (<a name="bbib0028" href="#bib0028" class="workspace-trigger">Liang, Liu, Shen, Yang, Liu, Dong, Lin, Yan, 2015</a>, <a name="bbib0033" href="#bib0033" class="workspace-trigger">Ngo, Carneiro, 2013</a>, <a name="bbib0038" href="#bib0038" class="workspace-trigger">Ranftl, Pock, 2014</a>, <a name="bbib0047" href="#bib0047" class="workspace-trigger">Turaga, Murray, Jain, Roth, Helmstaedter, Briggman, Denk, Seung, 2010</a><span>), we thus demonstrate that it may be beneficial to embed CNNs as powerful <a href="/topics/computer-science/classification-machine-learning" title="Learn more about classifiers from ScienceDirect's AI-generated Topic Pages" class="topic-link">classifiers</a> into higher-level methods which encode anatomic shape- and appearance priors.</span></p><p id="para0062"><span>The experiments performed on MRI highlight important aspects of both our CNNs and the modality itself. Most of the brain regions considered in this study (e.g. midbrain, <a href="/topics/engineering/subthalamic-nucleus" title="Learn more about STN from ScienceDirect's AI-generated Topic Pages" class="topic-link">STN</a>, caudate) can be recognised by a human rater by clearly visible contrasts, while the position and boundaries of difficult regions with less contrast (e.g. GPi, GPe, SNpc, SNpr) can be inferred through anatomical knowledge and neighborhood context. Ultrasound volumes are much more challenging from this point of view. Human midbrain in TCUS can be difficult to discern and human observers can be mislead by </span><a href="/topics/engineering/artefact" title="Learn more about artefacts from ScienceDirect's AI-generated Topic Pages" class="topic-link">artefacts</a> and signal-loss areas having similar shape. The CNNs employed in this study had various architectures and therefore different pattern recognition capabilities. In MRI, where the most part of regions of interest have good contrast while the position of the others can be inferred by the context, the best performing network was “7-5-3”. Although this architecture is the simplest, it delivered best results in all the MRI experiments. In US, which is a challenging modality, the networks that delivered best results were among the most complex. “SmallAlex” and “3-3-3-3-3-3-3-3” are deeper and therefore recognise more complex visual content than “7-5-3”.</p><p id="para0063">While we observed a strong performance advantage when segmenting MRI volumes considering 3D data (<a name="btbl0005" href="#tbl0005" class="workspace-trigger">Table&nbsp;5</a>), we observed the opposite effect when segmenting ultrasound as shown in the bottom left of <a name="btbl0003" href="#tbl0003" class="workspace-trigger">Table&nbsp;3</a><span>. In MRI, processing data in 3D brings additional useful information which improves the performance of both automated methods and human raters, who refer simultaneously to sagittal, coronal and axial views when establishing the ground truth. In US, we observed that experts segmenting the ground truth used only the <a href="/topics/engineering/axial-plane" title="Learn more about axial plane from ScienceDirect's AI-generated Topic Pages" class="topic-link">axial plane</a>, since it is the only plane in which the characteristic shape of the midbrain can be recognised. Similarly, CNNs produce best results when they are not supplied with misleading information from sagittal and coronal planes.</span></p><p id="para0064">Altogether, using Hough-CNNs, we segmented 10 previously unseen MRI volumes achieving very high Dice coefficients for large and high-contrasted regions, while some of the smallest and most challenging regions were almost always localised accurately and segmented with sub-voxel mean surface distance. Additionally, we achieved very robust midbrain segmentation in 3D-TCUS, in a <a href="/topics/engineering/test-dataset" title="Learn more about test dataset from ScienceDirect's AI-generated Topic Pages" class="topic-link">test dataset</a> of more than 20 subjects and 114 volumes, with a large variation of 3D sweep geometry, bone window qualities, midbrain appearance, location and orientation. Given the size and variety of the 3D-TCUS test set, we are confident to say that the method generalises well to unseen patients.</p><p id="para0065"><span>Compared to atlas-segmentation, Hough-CNN is faster (30&nbsp;s in US, and 3–4&nbsp;min in MRI on the machine employed for testing) and entirely registration-free. This makes our approach applicable to <a href="/topics/computer-science/ultrasound-data" title="Learn more about TCUS data from ScienceDirect's AI-generated Topic Pages" class="topic-link">TCUS data</a>, in which registration-dependent methods like atlas-based segmentation would be extremely difficult, if not impossible, due to largely missing anatomical and structural context. Our approach is flexible since both votes and segmentation patches can be substituted without any need for re-training or augmented to include information from multiple experts. As a future work, we plan to investigate the extendability of the trained CNN classifier to other modalities via transfer learning, e.g. from our QSM sequences to T1 or T2. It is also noteworthy that in this work, we have only used the CNN method for segmentation. However, as other works have demonstrated (</span><a name="bbib0035" href="#bib0035" class="workspace-trigger">Payan and Montana, 2015</a>), the learned data representations in the last layers of the CNN can be directly used for classification or regression of disease parameters. This can be interleaved with segmentation, which goes far beyond the capabilities of purely atlas-based methods.</p></section><section id="sec0015"><h2 id="sectt0018" class="u-h3 u-margin-l-top u-margin-xs-bottom">6. Conclusion</h2><p id="para0066"><span>In this work, we applied <a href="/topics/computer-science/convolutional-neural-networks" title="Learn more about CNNs from ScienceDirect's AI-generated Topic Pages" class="topic-link">CNNs</a> to </span><a href="/topics/engineering/medical-image-segmentation" title="Learn more about medical image segmentation from ScienceDirect's AI-generated Topic Pages" class="topic-link">medical image segmentation</a><span>, under the constraints of limited training data and computational resources. We performed a large study of several CNN parameters, including architectures, patch dimensionality and training set size, highlighting CNN performance given challenges from different modalities. We proposed Hough-CNN, a patch-wise multi-atlas method which implicitly encodes priors on anatomic shape and context. The method outperformed voxel-wise semantic segmentation of CNNs in all parameter settings, while using less training data and delivering smooth segmentation contours without the need for post-processing. The method is modality-independent and scalable to multiple regions and harnesses the impressive <a href="/topics/computer-science/classification" title="Learn more about classification from ScienceDirect's AI-generated Topic Pages" class="topic-link">classification</a> power of CNNs and Deep Learning for application in clinical settings.</span></p></section></div><section id="ack0001"><h2 id="sectt0019" class="u-h3 u-margin-l-top u-margin-xs-bottom">Acknowledgement</h2><p id="para0067">This study was funded by the Lüneburg Heritage and Deutsche Forschungsgesellschaft (<span id="GS501100001659">DFG</span>) Grant <a href="#GS501100001659">BO 1895/4-1</a>. We gratefully acknowledge the support of <span id="GS100007065">NVIDIA</span> Corporation in donating a “Tesla K40” GPU for this study.</p></section></div>