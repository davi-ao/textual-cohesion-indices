<div class="Body u-font-serif" id="body"><div><section id="sec1"><h2 id="sectitle0020" class="u-h3 u-margin-l-top u-margin-xs-bottom">1. Introduction</h2><p id="p0010">With the development of information technology, people at present enjoy the convenience of network. While the number and scale of security threats is growing rapidly, which has caused great damage to network resources and privacy leaks. Methods and features of network intrusion are constantly changing and developing. Thus intrusion detection is still an important research issue at present.</p><p id="p0015">Intrusion detection technology has been continuously studied by researchers (<a name="bbib18" href="#bib18" class="workspace-trigger">Moustafa et al., 2019</a>; <a name="bbib3" href="#bib3" class="workspace-trigger">Bhuyan et al., 2013</a>; <a name="bbib13" href="#bib13" class="workspace-trigger">Jaiganesh et al., 2013</a>; <a name="bbib1" href="#bib1" class="workspace-trigger">Aburomman and Reaz, 2017</a>; <a name="bbib14" href="#bib14" class="workspace-trigger">Kabir et al., 2018</a>). In general, intrusion detection can be taken as a classification problem, classifying the incoming network into normal and attack one. Existing intrusion detection models mainly combine various existing machine learning methods with intrusion detection data sets. The intrusion detection data set is a general big data set, which is directly input into the existing various machine learning models to train the intrusion detection classifier. And various current learning methods can be broadly classified into three types: traditional machine learning based method, deep learning based method, and hybrid method.</p><p id="p0020">The traditional machine-learning methods include Support vector machine (SVM), k-Nearest Neighbor (kNN), Decision Trees, and so on. As collected data sets become larger and larger, deep learning-based approaches are gaining much attention since they can learn computational process in depth and may lead to better generalization capabilities. There are methods like Deep belief network (DBN), Convolutional neural network (CNN), Recurrent neural network (RNN), AutoEncoder, and so on. In order to further improve the accuracy of recognition, the method of combining various data classification methods to form a hybrid classifier has been studied. A large number of experiments shown that hybrid-based techniques display a better detection performance for specific data sets. Because of a specific classifier and merge method, they can achieve higher precision and detection rate than a single method.</p><p id="p0025">Through continuous efforts, researchers now are able to design high accuracy detectors for fixed intrusion data sets. However, due to the continuous dynamic changes of network intrusion traffic, high accuracy for only fixed data sets cannot guarantee the excellent detection performance in the face of dynamic traffic. Our work conducts to analyze the detectability of dynamic intrusion traffic, and we then propose an effective intrusion detection algorithm based on semantic re-encoding and deep learning. Semantic re-encoding technology attempts to re-express the semantic space of intrusion traffic to achieve the purpose of increasing the distinguishability of abnormal traffic. On the basis of semantic re-encoding, deep learning technology is used to enhance the generalization ability of the intrusion detection model. The main contributions of this work are as follows:<dl class="list"><dt class="list-label">1.</dt><dd class="list-description"><p id="p0030">We find that the semantics of network traffic are different. Normal network traffic and attack network traffic often have significant differences in narrative semantics. Based on this, a semantic re-encoding method for intrusion network flow is designed, which can effectively increase the distinguish ability of abnormal network traffic.</p></dd><dt class="list-label">2.</dt><dd class="list-description"><p id="p0035">We design a deep learning-based detection model for intrusion traffic, which enhances the generalization capabilities of intrusion detection models.</p></dd></dl></p><p id="p0040">Experimental results show that our approach get competitive performance.</p><p id="p0045">The rest of this paper is organized as follows: Section <a name="bsec2" href="#sec2" class="workspace-trigger">2</a> introduces the related works. Section <a name="bsec3" href="#sec3" class="workspace-trigger">3</a> describes our proposed method in detail. Section <a name="bsec4" href="#sec4" class="workspace-trigger">4</a> shows experimental performances. Finally, the conclusion is presented in Section <a name="bsec5" href="#sec5" class="workspace-trigger">5</a>.</p></section><section id="sec2"><h2 id="sectitle0025" class="u-h3 u-margin-l-top u-margin-xs-bottom">2. Related work</h2><p id="p0050">Previously, many researchers use methods on pure traditional classifiers to the intrusion detection field. There are classifiers like Na√Øve Bayes, SVM, decision trees, kNN and so on (<a name="bbib7" href="#bib7" class="workspace-trigger">Dhanabal and Shantharajah, 2015</a>; <a name="bbib6" href="#bib6" class="workspace-trigger">Deshmukh et al., 2015</a>; <a name="bbib10" href="#bib10" class="workspace-trigger">Heba et al., 2010</a>; <a name="bbib19" href="#bib19" class="workspace-trigger">Naoum and Al-Sultani, 2012</a>).These methods have indeed achieved a lot of achievements, and laid a solid foundation for later research.</p><p id="p0055">Many researches have been conducted since deep-learning. Researches make lots of work on the preprocess of dataset as well as search for good classifiers (<a name="bbib23" href="#bib23" class="workspace-trigger">Vinayakumar et al., 2017</a>; <a name="bbib26" href="#bib26" class="workspace-trigger">Yin et al., 2017</a>; <a name="bbib24" href="#bib24" class="workspace-trigger">Wu et al., 2018</a>; <a name="bbib20" href="#bib20" class="workspace-trigger">Naseer et al., 2018</a>; <a name="bbib11" href="#bib11" class="workspace-trigger">Hsu et al., 2018</a>; <a name="bbib4" href="#bib4" class="workspace-trigger">Blanco et al., 2018</a>). Various methods have been employed to improve the performance of intrusion detection based on the public dataset NSL-KDD. <a name="bbib12" href="#bib12" class="workspace-trigger">Ingre and Yadav (2015)</a> propose a simple Artificial Neural Network method for intrusion detection. And they test the dataset on various layers of classifier and also do feature selection on the dataset. Zhang (<a name="bbib28" href="#bib28" class="workspace-trigger">Zhang et al., 2019</a>) combines genetic algorithm with deep belief network, which effectively improves the detection rate and reduces the complexity of classifier. The genetic algorithm is used to select the appropriate network structure, and then use DBN to classify the samples of the dataset. <a name="bbib2" href="#bib2" class="workspace-trigger">Al-Qatf et al. (2018)</a> develop a new method by using the sparse autoencoder for feature learning and dimensionality reduction. Besides, the learned features are fed into SVM algorithm to get final classification result. The paper uses an unsupervised method to reduce the dimension of feature. However, the effect of unsupervised learning lacks a reliable basis. <a name="bbib15" href="#bib15" class="workspace-trigger">Le et al. (2019)</a> apply a feature selection model to test the performance of various RNN models on the dataset. The feature selection model is to generate the best feature subset from the original feature set. Combined with the LSTM, the model achieved good performance on the IDS test dataset. Chouhan et al. (<a name="bbib5" href="#bib5" class="workspace-trigger">Chouhan Khanet al., 2019</a>) propose a novel Channel Boosted and Residual Learning architecture for deep convolutional neural network. The experiment shows that the method can improve the classification accuracy. The above methods did varies preprocess to the specific dataset of intrusion, but they did not highlight the difference between the normal traffic and the attack one on purpose.</p><p id="p0060">Many researchers apply hybrid approach on the dataset to get good performance (<a name="bbib16" href="#bib16" class="workspace-trigger">Li et al., 2017</a>; <a name="bbib8" href="#bib8" class="workspace-trigger">Gao et al., 2019</a>; <a name="bbib22" href="#bib22" class="workspace-trigger">Shrivas and Dewangan, 2014</a>). Li (<a name="bbib16" href="#bib16" class="workspace-trigger">Li et al., 2017</a>) propose a two-step hybrid approach to solve the problem. Step 1 uses C4.5 algorithm to get most of the exact label of the samples. Step 2 employs kNN to divide the rest uncertain ones. The model showed high accuracy but still lack of generalization ability, and the performance maybe not so good on other intrusion datasets. <a name="bbib8" href="#bib8" class="workspace-trigger">Gao et al. (2019)</a> apply several base classifiers, including decision tree, random forest, kNN, DNN, and design an ensemble adaptive voting algorithm. <a name="bbib27" href="#bib27" class="workspace-trigger">Zhang et al. (2018)</a>, propose an Xgboost based on stacked sparse autoencoder network (SSAE-XGB) method. The SSAE is used to learn the latent representation of original data, and the ensemble binary tree do the classification. This method has weak point on the interpretable of feature.</p><p id="p0065"><a name="bbib25" href="#bib25" class="workspace-trigger">Yang et al. (2019)</a> apply DCGAN to generating new samples and then use the modified LSTM classifier method to classify the datasets. This method showed the augment of dataset is important. However, GAN needs huge compute resources and the generation of new data is lack of interpretable.</p><p id="p0070">Compared with previous works, we propose a combination of algorithm based on Semantic Recoding and Deep Learning. The semantic re-encoding is an effective feature extraction algorithm for intrusion detection with good interpretable on feature, and the Deep Learning is to gain good generalization ability.</p></section><section id="sec3"><h2 id="sectitle0030" class="u-h3 u-margin-l-top u-margin-xs-bottom">3. Proposed methodology</h2><section id="sec3.1"><h3 id="sectitle0035" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.1. Problem formulation</h3><p id="p0075">As people's activities in cyberspace become more frequent, network intrusion traffic presents a trend of continuous dynamic changes, which makes the detection model for fixed dataset design often unsatisfactory. More importantly, dynamically changing network intrusion traffic has a large number of hidden and burst features showing discontinuity, while the current mainstream deep learning model behaves better at characterizing continuously changing data features. Then how to improve the determination of network intrusion detection model as well as the ability to adapt to the dynamic changes of the detection objects, becomes an important research issue. In this study, we attempt to incorporate some knowledge of network intrusion traffic into the intrusion classifier design.</p><p id="p0080">There are two types of IDS data sets. One is the protocol representation string of the original data, and the other is the feature set extracted by the experts from the original data applied to the host. For the original data stream, by observing the attack and defense characteristics of the network application, it can be found that for the network attack acting on a specific application, the normal traffic and the attack traffic are significantly different in the narrative semantics. In other words, the attacker will inevitably change the original logic of a certain level of network application. As long as the logic can be clearly expressed, it can form a specific network traffic characteristic. This suggests that we can effectively differentiate network intrusion traffic with effective semantic transformation. For feature-extracted data streams, such as NSL-KDD datasets, the direct semantic differences between attack and normal traffic are not easily characterized, but semantic differences between attacks and normal traffic can still be expressed through some escaping combinations.</p><p id="p0085">The details of the proposed method based on semantic re-encoding and deep learning (SRDLM) will be described in the next subsections.</p></section><section id="sec3.2"><h3 id="sectitle0040" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.2. Network traffic semantic re-encoding</h3><p id="p0090">In our method, both raw and converted network traffic can be semantically re-encoded, while the specific methods are different. As a result, we first judge whether the dataset is made up of raw data or not, and then re-code them separately. For the characterizable network traffic, such as web traffic, we resequence the network traffic characteristics to a new symbol space by re-encoding.</p><section id="sec3.2.1"><h4 id="sectitle0045" class="u-margin-m-top u-margin-xs-bottom">3.2.1. Semantic re-encoding for raw data</h4><p id="p0095">The existing network traffic raw data can easily be converted into a form of character stream. For example, the network application on the Internet uses the HTTP protocol to express its semantics in the form of the character stream. Furthermore, the network traffic of some non-http protocol can also be analyzed through its protocol format and then be transformed into a character stream.</p><p id="p0100">Thus, the step 1 is ‚ÄúTransform data to character stream‚Äù.</p><p id="p0105">Step 2, Word Segmentation. It means a word table that needs to be extracted from the raw character stream. We use delimiters such as breakpoint punctuation and special characters to split character stream. After that, we split the character stream into word string, and then pick up the words into a word table separately. For example, in the HTTP protocol, ‚Äò&amp;‚Äô, ‚Äò|‚Äô, ‚Äò\‚Äô, ‚Äò?‚Äô, ‚Äò‚Äñ‚Äô are delimiters. As delimiters will vary with the network protocols, it needs to be updated continuously. According to the original word list, all records in the character stream are converted into word array, and the access string is rearranged into a record set composed of words in the word list. Abnormal and normal samples from the access traffic are processed, and a sample record set with words segmented is formed.</p><div><p id="p0110">Step 3, Word Table Reordering. We want to get a new word table to map the origin word table. As shown in <a name="bfig1" href="#fig1" class="workspace-trigger">Fig.&nbsp;1</a>, the new word table is ordered by the difference between positive and negative sample. We then need to calculate the difference between positive and the negative sample, and define it as comprehensive word frequency (CWF). We calculate positive and negative Word Frequency (WF) in the original word table separately and sort word array according to the word frequency. If a word appears multiple times in a row, it is counted as one time. Set threshold T1, T2, we can easily see from <a name="bfig1" href="#fig1" class="workspace-trigger">Fig.&nbsp;1</a> that T1&nbsp;&gt;&nbsp;0 and T2&nbsp;&lt;&nbsp;0. If CWF&nbsp;&gt;&nbsp;T1 or CWF&nbsp;&lt;&nbsp;T2, which means that the WF between positive and negative is enormous, thus we will do One-to-one re-encoding. While CWF&nbsp;&lt;&nbsp;T1 and CWF&nbsp;&gt;&nbsp;T2, do Many-to-one re-encoding. Besides, the multiple words that CWF&nbsp;&lt;&nbsp;T1 and CWF&nbsp;&gt;&nbsp;T2 are combined into word WordM. And unknown words are also encoded as WordM. Sorting the original word table by CWF, we get the new word table, named Word-table-after.</p><figure class="figure text-xs" id="fig1"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr1.jpg" height="345" alt="Fig.&nbsp;1" aria-describedby="cap0025"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr1_lrg.jpg" target="_blank" download="" title="Download high-res image (274KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (274KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr1.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0025"><p id="fspara0010"><span class="label">Fig. 1</span>. The procedure of reordering the word table.</p></span></span></figure></div><div><p id="p0115">Step 4, Word Re-mapping. Positive and negative sample records are remapped to new isometric sample records based on the new word table (Word-table-after). As shown in <a name="bfig2" href="#fig2" class="workspace-trigger">Fig.&nbsp;2</a>, in the whole mapping process, multiple words will be mapped to one word, which is called Word bag mapping. When n words in the sample map to the same word, the value at the corresponding position of the word is added by n. The mapping procedure makes any unequal-length word sequence to the equal-length word sequence. When all the positive and negative samples re-map, we get a set of training samples of equal length.</p><figure class="figure text-xs" id="fig2"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr2.jpg" height="324" alt="Fig.&nbsp;2" aria-describedby="cap0030"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr2_lrg.jpg" target="_blank" download="" title="Download high-res image (181KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (181KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr2.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0030"><p id="fspara0015"><span class="label">Fig. 2</span>. Re-mapping a sample into a word bag.</p></span></span></figure></div><p id="p0120">Step 5, Word Sequence Re-projection. Word sequence re projection can be used as an optional step to make the new word sequence more distinguishable in semantic space. The re-projection function can be as follows:<span class="display"><span id="fd1" class="formula"><span class="label">(1)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-1-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>S</mi><mo is=&quot;true&quot;>=</mo><mfenced close=&quot;}&quot; open=&quot;{&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub></mrow></mfenced></mrow></mfenced><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2264;</mo><mi is=&quot;true&quot;>i</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2264;</mo><mi is=&quot;true&quot;>m</mi><mo is=&quot;true&quot;>,</mo><mi is=&quot;true&quot;>y</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;false&quot; is=&quot;true&quot;>{</mo><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn></mrow><mo stretchy=&quot;false&quot; is=&quot;true&quot;>}</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="35.139ex" height="2.709ex" viewBox="0 -847.3 15129.2 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-53"></use></g><g is="true" transform="translate(923,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1701,0)"><use xlink:href="#MJMAIN-7B" x="0" y="0"></use><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(572,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(916,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1361,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(490,-242)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="2586" y="0"></use></g></g><use xlink:href="#MJMAIN-7D" x="3476" y="0"></use></g><g is="true" transform="translate(5678,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(6123,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(6901,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(7958,0)"><use xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(8581,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(9637,0)"><use xlink:href="#MJMATHI-6D"></use></g><g is="true" transform="translate(10516,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(10961,0)"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(11736,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(12682,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAIN-30"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(945,0)"><use xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1946,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">S</mi><mo is="true">=</mo><mfenced close="}" open="{" is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub></mrow></mfenced></mrow></mfenced><mo is="true">,</mo><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">i</mi><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">m</mi><mo is="true">,</mo><mi is="true">y</mi><mo linebreak="goodbreak" is="true">‚àà</mo><mrow is="true"><mo stretchy="false" is="true">{</mo><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow><mo stretchy="false" is="true">}</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-1"><math><mi is="true">S</mi><mo is="true">=</mo><mfenced close="}" open="{" is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub></mrow></mfenced></mrow></mfenced><mo is="true">,</mo><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">i</mi><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">m</mi><mo is="true">,</mo><mi is="true">y</mi><mo linebreak="goodbreak" is="true">‚àà</mo><mrow is="true"><mo stretchy="false" is="true">{</mo><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow><mo stretchy="false" is="true">}</mo></mrow></math></script></span></span></span></p><p id="p0125"><em>m</em> is the number of training samples, and <em>X</em><sub><em>i</em></sub> means the record (word sequence) in the training set. The length of the word bag is <em>n</em>. <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-2-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>y</mi><mo is=&quot;true&quot;>&amp;#x2208;</mo><mfenced close=&quot;}&quot; open=&quot;{&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn></mrow></mfenced></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.035ex" height="2.709ex" viewBox="0 -847.3 3889.9 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(775,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(1442,0)"><use xlink:href="#MJMAIN-7B" x="0" y="0"></use><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAIN-30"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(945,0)"><use xlink:href="#MJMAIN-31"></use></g></g><use xlink:href="#MJMAIN-7D" x="1946" y="0"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">y</mi><mo is="true">‚àà</mo><mfenced close="}" open="{" is="true"><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow></mfenced></math></span></span><script type="math/mml" id="MathJax-Element-2"><math><mi is="true">y</mi><mo is="true">‚àà</mo><mfenced close="}" open="{" is="true"><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow></mfenced></math></script></span> is the label of sample.</p><p id="p0130">First, calculate the mean of positive and negative samples <em>Œº</em><sub><em>j</em></sub> respectively, <em>j</em> means the class type, positive and negative.<span class="display"><span id="fd2" class="formula"><span class="label">(2)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-3-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi></mrow></msub><mo is=&quot;true&quot;>=</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>m</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>j</mi></mrow></msub></mrow></mfrac><munder is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo></mrow><mrow is=&quot;true&quot;><mrow is=&quot;true&quot;><mo stretchy=&quot;false&quot; is=&quot;true&quot;>(</mo><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub></mrow><mo stretchy=&quot;false&quot; is=&quot;true&quot;>)</mo></mrow><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>&amp;#x2208;</mo><mi is=&quot;true&quot;>S</mi><mi is=&quot;true&quot;>&amp;amp;</mi><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>j</mi></mrow></munder><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub><mo is=&quot;true&quot;>,</mo><mspace width=&quot;1em&quot; is=&quot;true&quot; /><mi is=&quot;true&quot;>j</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;false&quot; is=&quot;true&quot;>{</mo><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn></mrow><mo stretchy=&quot;false&quot; is=&quot;true&quot;>}</mo></mrow><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2264;</mo><mi is=&quot;true&quot;>i</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2264;</mo><mi is=&quot;true&quot;>m</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="49.799ex" height="3.69ex" viewBox="0 -952.9 21441 1588.9" role="img" focusable="false" style="vertical-align: -1.477ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(1272,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2051,0)"><g transform="translate(397,0)"><rect stroke="none" width="1018" height="60" x="0" y="220"></rect><g is="true" transform="translate(332,409)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(60,-345)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D"></use></g></g><g is="true" transform="translate(621,-107)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6A"></use></g></g></g></g></g></g><g is="true" transform="translate(3754,0)"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g></g><g is="true" transform="translate(1056,-287)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(275,0)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(404,-107)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(648,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(845,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(346,-171)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g></g><g is="true" transform="translate(1710,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(1986,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(2458,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-53"></use></g><g is="true" transform="translate(2914,0)"><use transform="scale(0.707)" xlink:href="#MJMAINI-26"></use></g><g is="true" transform="translate(3482,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(346,-171)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(4072,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(4623,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-6A"></use></g></g></g><g is="true" transform="translate(9991,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(572,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(10908,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true"></g><g is="true" transform="translate(12353,0)"><use xlink:href="#MJMATHI-6A"></use></g><g is="true" transform="translate(13044,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(13989,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAIN-30"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(945,0)"><use xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1946,0)"><use xlink:href="#MJMAIN-7D"></use></g></g><g is="true" transform="translate(16603,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(17048,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(17826,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(18882,0)"><use xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(19506,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(20562,0)"><use xlink:href="#MJMATHI-6D"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow></msub><mo is="true">=</mo><mfrac is="true"><mrow is="true"><mn is="true">1</mn></mrow><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">m</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow></msub></mrow></mfrac><munder is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mrow is="true"><mo stretchy="false" is="true">(</mo><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub></mrow><mo stretchy="false" is="true">)</mo></mrow><mo linebreak="badbreak" is="true">‚àà</mo><mi is="true">S</mi><mi is="true">&amp;</mi><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo linebreak="badbreak" is="true">=</mo><mi is="true">j</mi></mrow></munder><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo is="true">,</mo><mspace width="1em" is="true"></mspace><mi is="true">j</mi><mo linebreak="goodbreak" is="true">‚àà</mo><mrow is="true"><mo stretchy="false" is="true">{</mo><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow><mo stretchy="false" is="true">}</mo></mrow><mo is="true">,</mo><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">i</mi><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">m</mi></math></span></span><script type="math/mml" id="MathJax-Element-3"><math><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow></msub><mo is="true">=</mo><mfrac is="true"><mrow is="true"><mn is="true">1</mn></mrow><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">m</mi></mrow><mrow is="true"><mi is="true">j</mi></mrow></msub></mrow></mfrac><munder is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mrow is="true"><mo stretchy="false" is="true">(</mo><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub></mrow><mo stretchy="false" is="true">)</mo></mrow><mo linebreak="badbreak" is="true">‚àà</mo><mi is="true">S</mi><mi is="true">&#x26;</mi><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo linebreak="badbreak" is="true">=</mo><mi is="true">j</mi></mrow></munder><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo is="true">,</mo><mspace width="1em" is="true"></mspace><mi is="true">j</mi><mo linebreak="goodbreak" is="true">‚àà</mo><mrow is="true"><mo stretchy="false" is="true">{</mo><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow><mo stretchy="false" is="true">}</mo></mrow><mo is="true">,</mo><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">i</mi><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">m</mi></math></script></span></span></span></p><p id="p0135">Second, calculate the intra-class dispersion matrix of positive and negative samples <em>S</em><sub><em>w</em></sub>. <em>X</em>0 is the sample in the positive set, and <em>X</em>1 is the sample in the negative one.<span class="display"><span id="fd3" class="formula"><span class="label">(3)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-4-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>S</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>w</mi></mrow></msub><mo is=&quot;true&quot;>=</mo><munder is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>&amp;#x2208;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn></mrow></msub></mrow></munder><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn></mrow></msub></mrow></mfenced><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn></mrow></msub></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>T</mi></mrow></msup><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>+</mo><munder is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>&amp;#x2208;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msub></mrow></munder><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mo is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msub></mrow></mfenced><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msub></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>T</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="58.95ex" height="3.568ex" viewBox="0 -1058.6 25381.1 1536" role="img" focusable="false" style="vertical-align: -1.109ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-53"></use></g></g><g is="true" transform="translate(613,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-77"></use></g></g></g><g is="true" transform="translate(1497,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2554,0)"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(404,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(876,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-58"></use></g></g><g is="true" transform="translate(585,-107)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-30"></use></g></g></g></g></g><g is="true" transform="translate(5494,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(794,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(1795,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-30"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3242" y="0"></use></g><g is="true" transform="translate(9126,0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(794,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(1795,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-30"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3242" y="0"></use></g></g><g is="true" transform="translate(3631,477)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g><g is="true" transform="translate(13578,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(14579,0)"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(404,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(876,0)"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-58"></use></g></g><g is="true" transform="translate(585,-107)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g></g></g><g is="true" transform="translate(17519,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(794,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(1795,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3242" y="0"></use></g><g is="true" transform="translate(21151,0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMATHI-78"></use></g><g is="true" transform="translate(794,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(1795,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3242" y="0"></use></g></g><g is="true" transform="translate(3631,477)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">w</mi></mrow></msub><mo is="true">=</mo><munder is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àà</mo><msub is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub></mrow></munder><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub></mrow></mfenced><msup is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub></mrow></mfenced></mrow><mrow is="true"><mi is="true">T</mi></mrow></msup><mo linebreak="goodbreak" is="true">+</mo><munder is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àà</mo><msub is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></munder><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced><msup is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced></mrow><mrow is="true"><mi is="true">T</mi></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-4"><math><msub is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">w</mi></mrow></msub><mo is="true">=</mo><munder is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àà</mo><msub is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub></mrow></munder><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub></mrow></mfenced><msup is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub></mrow></mfenced></mrow><mrow is="true"><mi is="true">T</mi></mrow></msup><mo linebreak="goodbreak" is="true">+</mo><munder is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àà</mo><msub is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></munder><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced><msup is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><mi is="true">x</mi><mo linebreak="badbreak" is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced></mrow><mrow is="true"><mi is="true">T</mi></mrow></msup></math></script></span></span></span></p><p id="p0140">Third, calculate the inter-class dispersion matrix between positive and negative one.<span class="display"><span id="fd4" class="formula"><span class="label">(4)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-5-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>S</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>d</mi></mrow></msub><mo is=&quot;true&quot;>=</mo><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn></mrow></msub><mo is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msub></mrow></mfenced><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn></mrow></msub><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>&amp;#x2212;</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>&amp;#x3BC;</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msub></mrow></mfenced></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>T</mi></mrow></msup></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="25.483ex" height="3.322ex" viewBox="0 -1058.6 10971.6 1430.4" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-53"></use></g></g><g is="true" transform="translate(613,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-64"></use></g></g></g><g is="true" transform="translate(1361,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2139,0)"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-30"></use></g></g></g><g is="true" transform="translate(1279,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(2280,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3727" y="0"></use></g><g is="true" transform="translate(6256,0)"><g is="true"><g is="true"><use xlink:href="#MJMAIN-28"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-30"></use></g></g></g><g is="true" transform="translate(1279,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(2280,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-3BC"></use></g></g><g is="true" transform="translate(603,-253)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3727" y="0"></use></g></g><g is="true" transform="translate(4116,477)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-54"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msub is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">d</mi></mrow></msub><mo is="true">=</mo><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub><mo is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced><msup is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub><mo linebreak="badbreak" is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced></mrow><mrow is="true"><mi is="true">T</mi></mrow></msup></math></span></span><script type="math/mml" id="MathJax-Element-5"><math><msub is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">d</mi></mrow></msub><mo is="true">=</mo><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub><mo is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced><msup is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">0</mn></mrow></msub><mo linebreak="badbreak" is="true">‚àí</mo><msub is="true"><mrow is="true"><mi is="true">Œº</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msub></mrow></mfenced></mrow><mrow is="true"><mi is="true">T</mi></mrow></msup></math></script></span></span></span></p><p id="p0145">Finally, calculate positive and negative sample space separation projection vectors W. W is the corresponding eigenvector of the largest eigenvalue of the matrix <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-6-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>S</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>w</mi></mrow><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2212;</mo><mn is=&quot;true&quot;>1</mn></mrow></msubsup><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>S</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>d</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="6.371ex" height="3.077ex" viewBox="0 -1005.7 2743.2 1324.7" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-53"></use></g></g><g is="true" transform="translate(655,432)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(550,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(613,-248)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-77"></use></g></g></g><g is="true" transform="translate(1659,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-53"></use></g></g><g is="true" transform="translate(613,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-64"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msubsup is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">w</mi></mrow><mrow is="true"><mo is="true">‚àí</mo><mn is="true">1</mn></mrow></msubsup><msub is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">d</mi></mrow></msub></math></span></span><script type="math/mml" id="MathJax-Element-6"><math><msubsup is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">w</mi></mrow><mrow is="true"><mo is="true">‚àí</mo><mn is="true">1</mn></mrow></msubsup><msub is="true"><mrow is="true"><mi is="true">S</mi></mrow><mrow is="true"><mi is="true">d</mi></mrow></msub></math></script></span>. Then we do the dimensionality reduction operation, and the new feature space is <em>w</em><sup><em>T</em></sup><em>x</em><sub><em>i</em></sub>.<span class="display"><span id="fd5" class="formula"><span class="label">(5)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-7-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>S</mi><mn is=&quot;true&quot;>1</mn><mo is=&quot;true&quot;>=</mo><mfenced close=&quot;}&quot; open=&quot;{&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mn is=&quot;true&quot;>1</mn></mrow></msub><mo is=&quot;true&quot;>,</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mn is=&quot;true&quot;>1</mn></mrow></msub></mrow></mfenced></mrow></mfenced><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2264;</mo><mi is=&quot;true&quot;>i</mi><mn is=&quot;true&quot;>1</mn><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2264;</mo><mi is=&quot;true&quot;>m</mi><mo is=&quot;true&quot;>,</mo><mi is=&quot;true&quot;>y</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2208;</mo><mrow is=&quot;true&quot;><mo stretchy=&quot;false&quot; is=&quot;true&quot;>{</mo><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>0</mn><mo is=&quot;true&quot;>,</mo><mn is=&quot;true&quot;>1</mn></mrow><mo stretchy=&quot;false&quot; is=&quot;true&quot;>}</mo></mrow></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="39.108ex" height="2.709ex" viewBox="0 -847.3 16838 1166.2" role="img" focusable="false" style="vertical-align: -0.741ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-53"></use></g><g is="true" transform="translate(645,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(1423,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2202,0)"><use xlink:href="#MJMAIN-7B" x="0" y="0"></use><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(572,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(244,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1270,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1715,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(490,-242)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(244,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3294" y="0"></use></g></g><use xlink:href="#MJMAIN-7D" x="4184" y="0"></use></g><g is="true" transform="translate(6886,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(7332,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(8110,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(9166,0)"><use xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(9512,0)"><use xlink:href="#MJMAIN-31"></use></g><g is="true" transform="translate(10290,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(11346,0)"><use xlink:href="#MJMATHI-6D"></use></g><g is="true" transform="translate(12225,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(12670,0)"><use xlink:href="#MJMATHI-79"></use></g><g is="true" transform="translate(13445,0)"><use xlink:href="#MJMAIN-2208"></use></g><g is="true" transform="translate(14390,0)"><g is="true"><use xlink:href="#MJMAIN-7B"></use></g><g is="true" transform="translate(500,0)"><g is="true"><use xlink:href="#MJMAIN-30"></use></g><g is="true" transform="translate(500,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(945,0)"><use xlink:href="#MJMAIN-31"></use></g></g><g is="true" transform="translate(1946,0)"><use xlink:href="#MJMAIN-7D"></use></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">S</mi><mn is="true">1</mn><mo is="true">=</mo><mfenced close="}" open="{" is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi><mn is="true">1</mn></mrow></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi><mn is="true">1</mn></mrow></msub></mrow></mfenced></mrow></mfenced><mo is="true">,</mo><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">i</mi><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">m</mi><mo is="true">,</mo><mi is="true">y</mi><mo linebreak="goodbreak" is="true">‚àà</mo><mrow is="true"><mo stretchy="false" is="true">{</mo><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow><mo stretchy="false" is="true">}</mo></mrow></math></span></span><script type="math/mml" id="MathJax-Element-7"><math><mi is="true">S</mi><mn is="true">1</mn><mo is="true">=</mo><mfenced close="}" open="{" is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msub is="true"><mrow is="true"><mi is="true">x</mi></mrow><mrow is="true"><mi is="true">i</mi><mn is="true">1</mn></mrow></msub><mo is="true">,</mo><msub is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">i</mi><mn is="true">1</mn></mrow></msub></mrow></mfenced></mrow></mfenced><mo is="true">,</mo><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">i</mi><mn is="true">1</mn><mo linebreak="goodbreak" is="true">‚â§</mo><mi is="true">m</mi><mo is="true">,</mo><mi is="true">y</mi><mo linebreak="goodbreak" is="true">‚àà</mo><mrow is="true"><mo stretchy="false" is="true">{</mo><mrow is="true"><mn is="true">0</mn><mo is="true">,</mo><mn is="true">1</mn></mrow><mo stretchy="false" is="true">}</mo></mrow></math></script></span></span></span></p><p id="p0150"><em>x</em><sub><em>i</em>1</sub>is the record in the training set. The dimension is <em>n</em>1. If the previous semantic re-encoding can better reflect the difference between normal and attack traffic, then this step can further open the spatial distance of the positive and negative samples. The algorithm is formalized in <a name="bdtbl1" href="#dtbl1" class="workspace-trigger">Algorithm 1</a>.<span class="display"><div class="tables colsep-0 frame-topbot rowsep-0" id="dtbl1"><span class="captions"><span id="cap0010"><p id="tspara0010"><span class="label">Algorithm 1</span>. Network character stream semantic re-encoding algorithm.</p></span></span><div class="groups"><table><tbody><tr class="valign-top"><td class="align-left">1:&nbsp;Transform data to the character stream.</td></tr><tr class="valign-top"><td class="align-left">2:&nbsp;Word segmentation.</td></tr><tr class="valign-top"><td class="align-left">3:&nbsp;Word Table Reordering.</td></tr><tr class="valign-top"><td class="align-left">4:&nbsp;Word Re-mapping.</td></tr><tr class="valign-top"><td class="align-left">5:&nbsp;Word Sequence Re-projection.(Optional)</td></tr></tbody></table></div></div></span></p></section><section id="sec3.2.2"><h4 id="sectitle0050" class="u-margin-m-top u-margin-xs-bottom">3.2.2. Semantic re-encoding for converted network traffic</h4><p id="p0155">For data streams extracted from raw data, a set of <em>m</em> records is used to express the network traffic,</p><p id="p0160"><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-8-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mfenced close=&quot;}&quot; open=&quot;{&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msup><mo is=&quot;true&quot;>,</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>1</mn></mrow></msup></mrow></mfenced><mo is=&quot;true&quot;>,</mo><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>2</mn></mrow></msup><mo is=&quot;true&quot;>,</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>2</mn></mrow></msup></mrow></mfenced><mo is=&quot;true&quot;>&amp;#x2026;</mo><mfenced close=&quot;)&quot; open=&quot;(&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>X</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>m</mi></mrow></msup><mo is=&quot;true&quot;>,</mo><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>y</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>m</mi></mrow></msup></mrow></mfenced></mrow></mfenced></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.29ex" height="3.199ex" viewBox="0 -952.9 13902.7 1377.5" role="img" focusable="false" style="vertical-align: -0.986ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJSZ1-7B" x="0" y="-1"></use><g is="true" transform="translate(583,0)"><g is="true"><use xlink:href="#MJSZ1-28"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-58"></use></g></g><g is="true" transform="translate(859,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(1313,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1758,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(499,362)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g></g><use xlink:href="#MJSZ1-29" x="3170" y="-1"></use></g><g is="true" transform="translate(3629,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(3907,0)"><use xlink:href="#MJSZ1-28"></use><g is="true" transform="translate(458,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-58"></use></g></g><g is="true" transform="translate(859,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g><g is="true" transform="translate(1313,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(1758,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(499,362)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-32"></use></g></g></g></g><use xlink:href="#MJSZ1-29" x="3170" y="-1"></use></g><g is="true" transform="translate(7537,0)"><use xlink:href="#MJMAIN-2026"></use></g><g is="true" transform="translate(8709,0)"><use xlink:href="#MJMAIN-28" x="0" y="0"></use><g is="true" transform="translate(389,0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-58"></use></g></g><g is="true" transform="translate(859,410)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D"></use></g></g></g><g is="true" transform="translate(1580,0)"><use xlink:href="#MJMAIN-2C"></use></g><g is="true" transform="translate(2026,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-79"></use></g></g><g is="true" transform="translate(499,362)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6D"></use></g></g></g></g><use xlink:href="#MJMAIN-29" x="3636" y="0"></use></g></g><use xlink:href="#MJSZ1-7D" x="13319" y="-1"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mfenced close="}" open="{" is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msup><mo is="true">,</mo><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msup></mrow></mfenced><mo is="true">,</mo><mfenced close=")" open="(" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">2</mn></mrow></msup><mo is="true">,</mo><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mn is="true">2</mn></mrow></msup></mrow></mfenced><mo is="true">‚Ä¶</mo><mfenced close=")" open="(" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mi is="true">m</mi></mrow></msup><mo is="true">,</mo><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">m</mi></mrow></msup></mrow></mfenced></mrow></mfenced></math></span></span><script type="math/mml" id="MathJax-Element-8"><math><mfenced close="}" open="{" is="true"><mrow is="true"><mfenced close=")" open="(" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msup><mo is="true">,</mo><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mn is="true">1</mn></mrow></msup></mrow></mfenced><mo is="true">,</mo><mfenced close=")" open="(" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mn is="true">2</mn></mrow></msup><mo is="true">,</mo><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mn is="true">2</mn></mrow></msup></mrow></mfenced><mo is="true">‚Ä¶</mo><mfenced close=")" open="(" is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">X</mi></mrow><mrow is="true"><mi is="true">m</mi></mrow></msup><mo is="true">,</mo><msup is="true"><mrow is="true"><mi is="true">y</mi></mrow><mrow is="true"><mi is="true">m</mi></mrow></msup></mrow></mfenced></mrow></mfenced></math></script></span>. <em>X</em> is the feature vector, <em>y</em> is a label, such as NSL_KDD. Semantic re-encoding can still be used. However, because their original semantics have escaped, the effect of semantic re-encoding is not as good as the raw data stream.</p><p id="p0165">We slightly modify Algorithm 1 and apply it to the NSL_KDD dataset. The NSL_KDD consists of original 41-dimensional features, and we then perform semantic re-encoding on each dimension feature separately. The specific process is as follows:</p><p id="p0170">For symbolic feature, a one-hot encoding is used to transfer the feature space. For example, the protocol type feature has three types: TCP, UDP, ICMP. Then after a one-hot encoding, three types are converted into (0,0,1), (0,1,0),(1,0,0) separately.</p><div><p id="p0175">For continuous numerical type feature <em>i</em>, we first normalize the feature to 0‚Äì1. And then we divide the feature equally to <em>N</em><sub><em>f</em></sub> intervals and count the feature frequency (FF) of normal and attack, or the positive and negative type. We think all <em>N</em><sub><em>f</em></sub> intervals as potential features. And we call the difference of the positive feature frequency and the negative feature frequency as comprehensive feature frequency (CFF). Set a threshold T&nbsp;=&nbsp;[T1,T2] as the standard of either do segment to the feature or not. T1&nbsp;&gt;&nbsp;0,T2&nbsp;&lt;&nbsp;0. According to the threshold, we can segment the feature to discrete type. Here are the specific operation: First, judge the CFF of one interval if CWF&nbsp;&gt;&nbsp;T1 or CWF&nbsp;&lt;&nbsp;T2, then add the upper limit value to <em>interval</em><sub><em>i</em></sub>. In other words, the samples can be classified according to the intervals in <em>interval</em><sub><em>i</em></sub> of feature <em>i</em>. Second, use a one-hot encoding. The transformation function is as follows: <em>x</em><sub><em>i</em></sub> ‚Üí <em>v</em><sub><em>j</em></sub><em>v</em><sub><em>j</em>+1</sub> ‚Ä¶ <em>v</em><sub><em>j</em>+<em>t</em></sub>. For example, <a name="bfig3" href="#fig3" class="workspace-trigger">Fig.&nbsp;3</a> is the distribution of the original data feature 29. We set <em>N</em><sub><em>f</em></sub>&nbsp;=&nbsp;20, so a single interval size is 0.05. Set T&nbsp;=&nbsp;[10000, ‚àí500]. We think normal is a positive type. We can see the intervals (0‚Äì0.05), (0.05‚Äì0.1), (0.1‚Äì0.15), the CFF&nbsp;&lt;&nbsp;‚àí500. And for intervals between 0.15 and 0.95, the CWF is betweenT1 and T2. Then we merge the intervals to a feature. About interval (0.95‚Äì1), CWF&nbsp;&gt;&nbsp;10000. So we can set <em>T</em><sub>29</sub>&nbsp;=&nbsp;[0.05, 0.1, 0.15.0.95]. The result of this step is shown in <a name="btbl1" href="#tbl1" class="workspace-trigger">Table&nbsp;1</a>. This step is almost the same operation as Algorithm 1 step 3. Word Table Reordering.</p><figure class="figure text-xs" id="fig3"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr3.jpg" height="290" alt="Fig.&nbsp;3" aria-describedby="cap0035"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr3_lrg.jpg" target="_blank" download="" title="Download high-res image (122KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (122KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr3.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0035"><p id="fspara0020"><span class="label">Fig. 3</span>. Histogram of scaled feature 29.</p></span></span></figure><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl1"><span class="captions"><span id="cap0100"><p id="tspara0025"><span class="label">Table 1</span>. Transformation of numeric feature.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col">Feature Interval</th><th scope="col">Middle code</th><th scope="col">New feature code</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">0‚Äì0.05</td><td class="align-left">1</td><td class="align-left">00001</td></tr><tr class="valign-top"><td class="align-left">0.05‚Äì0.1</td><td class="align-left">2</td><td class="align-left">00010</td></tr><tr class="valign-top"><td class="align-left">0.1‚Äì0.15</td><td class="align-left">3</td><td class="align-left">00100</td></tr><tr class="valign-top"><td class="align-left">0.15‚Äì0.95</td><td class="align-left">4</td><td class="align-left">01000</td></tr><tr class="valign-top"><td class="align-left">0.95‚Äì1</td><td class="align-left">5</td><td class="align-left">10000</td></tr></tbody></table></div></div></div><div><p id="p0180">For NSL-KDD, after doing the previous Reordering step, the original 41 dimension data changes to 169 dimension data. As shown in <a name="bfig4" href="#fig4" class="workspace-trigger">Fig.&nbsp;4</a>, the t-SNE (<a name="bbib17" href="#bib17" class="workspace-trigger">Maaten and Hinton, 2008</a>) algorithm is used to represent multi-dimensional data in a 3-dimensional space. It can be seen that in contrast with 41 dimension, the 169 dimension data of the normal type and attack type can be separated more easily after Word Table Reordering. In other words, in the 169 dimension feature space, the inter-code space is broadened. However, there are some samples overlapped in 169 dimension. We add some PCA features to make the overlapped samples apart.</p><figure class="figure text-xs" id="fig4"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr4.jpg" height="558" alt="Fig.&nbsp;4" aria-describedby="cap0040"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr4_lrg.jpg" target="_blank" download="" title="Download high-res image (538KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (538KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr4.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0040"><p id="fspara0025"><span class="label">Fig. 4</span>. (a) 41-dimensional data in 3-dimensional representation. (b) 169-dimensional data in 3-dimensional representation.</p></span></span></figure></div><div><p id="p0185">We list some of the symbols in <a name="btbl2" href="#tbl2" class="workspace-trigger">Table&nbsp;2</a> to describe the algorithm. After adding <em>N</em><sub><em>pca</em></sub> features the original <em>n</em> dimension is converted to <em>N</em> dimension. <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-9-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>N</mi><mo is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>n</mi><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>+</mo><msubsup is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mo is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>n</mi></mrow></msubsup><mi is=&quot;true&quot;>l</mi><mi is=&quot;true&quot;>e</mi><mi is=&quot;true&quot;>n</mi><mtext is=&quot;true&quot;>_</mtext><mi is=&quot;true&quot;>i</mi><mi is=&quot;true&quot;>n</mi><mi is=&quot;true&quot;>t</mi><mi is=&quot;true&quot;>e</mi><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>r</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub><mo linebreak=&quot;goodbreak&quot; linebreakstyle=&quot;after&quot; is=&quot;true&quot;>+</mo><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>N</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>p</mi><mi is=&quot;true&quot;>c</mi><mi is=&quot;true&quot;>a</mi></mrow></msub></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="32.788ex" height="2.948ex" viewBox="0 -898.3 14117.1 1269.3" role="img" focusable="false" style="vertical-align: -0.862ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-4E"></use></g><g is="true" transform="translate(1166,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(2222,0)"><use xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(3045,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(4046,0)"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g></g><g is="true" transform="translate(1056,477)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-6E"></use></g></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(244,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(794,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-31"></use></g></g></g><g is="true" transform="translate(6517,0)"><use xlink:href="#MJMATHI-6C"></use></g><g is="true" transform="translate(6816,0)"><use xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(7282,0)"><use xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(7883,0)"><use xlink:href="#MJMAIN-5F"></use></g><g is="true" transform="translate(8383,0)"><use xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(8729,0)"><use xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(9329,0)"><use xlink:href="#MJMATHI-74"></use></g><g is="true" transform="translate(9691,0)"><use xlink:href="#MJMATHI-65"></use></g><g is="true" transform="translate(10157,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-72"></use></g></g><g is="true" transform="translate(451,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(11175,0)"><use xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(12176,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-4E"></use></g></g><g is="true" transform="translate(803,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-70"></use></g><g is="true" transform="translate(356,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-63"></use></g><g is="true" transform="translate(662,0)"><use transform="scale(0.707)" xlink:href="#MJMATHI-61"></use></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">N</mi><mo is="true">=</mo><mi is="true">n</mi><mo linebreak="goodbreak" linebreakstyle="after" is="true">+</mo><msubsup is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">i</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><mi is="true">n</mi></mrow></msubsup><mi is="true">l</mi><mi is="true">e</mi><mi is="true">n</mi><mtext is="true">_</mtext><mi is="true">i</mi><mi is="true">n</mi><mi is="true">t</mi><mi is="true">e</mi><msub is="true"><mrow is="true"><mi is="true">r</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo linebreak="goodbreak" linebreakstyle="after" is="true">+</mo><msub is="true"><mrow is="true"><mi is="true">N</mi></mrow><mrow is="true"><mi is="true">p</mi><mi is="true">c</mi><mi is="true">a</mi></mrow></msub></math></span></span><script type="math/mml" id="MathJax-Element-9"><math><mi is="true">N</mi><mo is="true">=</mo><mi is="true">n</mi><mo linebreak="goodbreak" linebreakstyle="after" is="true">+</mo><msubsup is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">i</mi><mo is="true">=</mo><mn is="true">1</mn></mrow><mrow is="true"><mi is="true">n</mi></mrow></msubsup><mi is="true">l</mi><mi is="true">e</mi><mi is="true">n</mi><mtext is="true">_</mtext><mi is="true">i</mi><mi is="true">n</mi><mi is="true">t</mi><mi is="true">e</mi><msub is="true"><mrow is="true"><mi is="true">r</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mo linebreak="goodbreak" linebreakstyle="after" is="true">+</mo><msub is="true"><mrow is="true"><mi is="true">N</mi></mrow><mrow is="true"><mi is="true">p</mi><mi is="true">c</mi><mi is="true">a</mi></mrow></msub></math></script></span>. Further, the <em>N</em>-dimensional data is extended to 4‚àó<em>N</em> data, which consists of four parts (v, p, n, s). As shown in <a name="bfig5" href="#fig5" class="workspace-trigger">Fig.&nbsp;5</a>, the original n-dimensional vector <em>X</em> is semantically re-encoded to get the <em>N</em>-dimensional vector <em>v</em>. We calculate the mean feature map of positive training data (<em>vp</em>) and the negative training data (<em>vn</em>). Then (<em>p</em>, <em>n</em>, <em>s</em>) is calculated as follows:<span class="display"><span id="fd6" class="formula"><span class="label">(6)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-10-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>p</mi><mo is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>v</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2212;</mo><mi is=&quot;true&quot;>v</mi><mi is=&quot;true&quot;>p</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.622ex" height="2.218ex" viewBox="-38.5 -688.8 4573.5 954.9" role="img" focusable="false" style="vertical-align: -0.618ex; margin-left: -0.089ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-70"></use></g><g is="true" transform="translate(781,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1837,0)"><use xlink:href="#MJMATHI-76"></use></g><g is="true" transform="translate(2545,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(3546,0)"><use xlink:href="#MJMATHI-76"></use></g><g is="true" transform="translate(4031,0)"><use xlink:href="#MJMATHI-70"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">p</mi><mo is="true">=</mo><mi is="true">v</mi><mo linebreak="goodbreak" is="true">‚àí</mo><mi is="true">v</mi><mi is="true">p</mi></math></span></span><script type="math/mml" id="MathJax-Element-10"><math><mi is="true">p</mi><mo is="true">=</mo><mi is="true">v</mi><mo linebreak="goodbreak" is="true">‚àí</mo><mi is="true">v</mi><mi is="true">p</mi></math></script></span></span></span><span class="display"><span id="fd7" class="formula"><span class="label">(7)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-11-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>n</mi><mo is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>v</mi><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>&amp;#x2212;</mo><mi is=&quot;true&quot;>v</mi><mi is=&quot;true&quot;>n</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="10.984ex" height="1.972ex" viewBox="0 -688.8 4729 849.3" role="img" focusable="false" style="vertical-align: -0.373ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(878,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1934,0)"><use xlink:href="#MJMATHI-76"></use></g><g is="true" transform="translate(2642,0)"><use xlink:href="#MJMAIN-2212"></use></g><g is="true" transform="translate(3643,0)"><use xlink:href="#MJMATHI-76"></use></g><g is="true" transform="translate(4128,0)"><use xlink:href="#MJMATHI-6E"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">n</mi><mo is="true">=</mo><mi is="true">v</mi><mo linebreak="goodbreak" is="true">‚àí</mo><mi is="true">v</mi><mi is="true">n</mi></math></span></span><script type="math/mml" id="MathJax-Element-11"><math><mi is="true">n</mi><mo is="true">=</mo><mi is="true">v</mi><mo linebreak="goodbreak" is="true">‚àí</mo><mi is="true">v</mi><mi is="true">n</mi></math></script></span></span></span><span class="display"><span id="fd8" class="formula"><span class="label">(8)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-12-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi is=&quot;true&quot;>s</mi><mo is=&quot;true&quot;>=</mo><mi is=&quot;true&quot;>v</mi><mo is=&quot;true&quot;>&amp;#x2217;</mo><mi is=&quot;true&quot;>v</mi></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="8.639ex" height="1.482ex" viewBox="0 -530.3 3719.5 637.9" role="img" focusable="false" style="vertical-align: -0.25ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><use xlink:href="#MJMATHI-73"></use></g><g is="true" transform="translate(747,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(1803,0)"><use xlink:href="#MJMATHI-76"></use></g><g is="true" transform="translate(2511,0)"><use xlink:href="#MJMAIN-2217"></use></g><g is="true" transform="translate(3234,0)"><use xlink:href="#MJMATHI-76"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi is="true">s</mi><mo is="true">=</mo><mi is="true">v</mi><mo is="true">‚àó</mo><mi is="true">v</mi></math></span></span><script type="math/mml" id="MathJax-Element-12"><math><mi is="true">s</mi><mo is="true">=</mo><mi is="true">v</mi><mo is="true">‚àó</mo><mi is="true">v</mi></math></script></span></span></span></p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl2"><span class="captions"><span id="cap0105"><p id="tspara0030"><span class="label">Table 2</span>. Symbol description.</p></span></span><div class="groups"><table><tbody><tr class="valign-top"><td class="align-left"><em>f</em>_<em>type</em></td><td class="align-left">The format type of feature (0 for discrete, 1 for numeric).</td></tr><tr class="valign-top"><td class="align-left"><em>n</em></td><td class="align-left">The total number of original feature.</td></tr><tr class="valign-top"><td class="align-left"><em>T</em></td><td class="align-left">Threshold of the <em>CFF</em>. <em>T</em>&nbsp;=&nbsp;[<em>T</em>1, <em>T</em>2].</td></tr><tr class="valign-top"><td class="align-left"><em>N</em><sub><em>f</em></sub></td><td class="align-left">Divide feature equally to <em>N</em><sub><em>f</em></sub> Intervals.</td></tr><tr class="valign-top"><td class="align-left"><em>Interval</em><sub><em>i</em></sub></td><td class="align-left">Interval list of feature i.</td></tr><tr class="valign-top"><td class="align-left"><em>len</em>_<em>inter</em><sub><em>i</em></sub></td><td class="align-left">The len of Interval list of feature i.</td></tr><tr class="valign-top"><td class="align-left"><em>N</em><sub><em>pca</em></sub></td><td class="align-left">The number of features after PCA.</td></tr><tr class="valign-top"><td class="align-left"><em>N</em></td><td class="align-left">The total number of output new feature.</td></tr><tr class="valign-top"><td class="align-left"><em>d</em>_<em>num</em><sub><em>i</em></sub></td><td class="align-left">The number of the total feature type of feature i. Only valid for discrete feature.</td></tr></tbody></table></div></div><figure class="figure text-xs" id="fig5"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr5.jpg" height="222" alt="Fig.&nbsp;5" aria-describedby="cap0045"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr5_lrg.jpg" target="_blank" download="" title="Download high-res image (43KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (43KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr5.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0045"><p id="fspara0030"><span class="label">Fig. 5</span>. Convert the original n dimension to a N dimension feature space.</p></span></span></figure></div><p id="p0190">The algorithm is formalized by <a name="bdtbl2" href="#dtbl2" class="workspace-trigger">Algorithm 2</a>.<span class="display"><div class="tables colsep-0 frame-topbot rowsep-0" id="dtbl2"><span class="captions"><span id="cap0015"><p id="tspara0015"><span class="label">Algorithm 2</span>. Semantic dispre-encoding for data extracted from raw data.</p></span></span><div class="groups"><table><tbody><tr class="valign-top"><td class="align-left"><strong>Input:</strong> input parameters <em>code</em><sub><em>i</em></sub>, <em>N</em><sub><em>pca</em></sub></td></tr><tr class="valign-top"><td class="align-left"><strong>Output:</strong> output <em>final</em>_<em>code</em></td></tr><tr class="valign-top"><td class="align-left">1:&nbsp;<strong>Initial:</strong> interval list <em>Interval</em><sub><em>i</em></sub> and <em>len</em>_<em>inter</em><sub><em>i</em></sub></td></tr><tr class="valign-top"><td class="align-left">2:&nbsp;<strong>if</strong> <em>f</em>_<em>type</em>&nbsp;==&nbsp;0 <strong>then</strong></td></tr><tr class="valign-top"><td class="align-left">3:&nbsp;<em>len</em>_<em>inter</em><sub><em>i</em></sub>&nbsp;=&nbsp;<em>d</em>_<em>num</em><sub><em>i</em></sub></td></tr><tr class="valign-top"><td class="align-left">4:&nbsp;<strong>goto</strong>&nbsp; 15</td></tr><tr class="valign-top"><td class="align-left">5:&nbsp;<strong>else</strong></td></tr><tr class="valign-top"><td class="align-left">6:&nbsp;<strong>while</strong> <em>j</em>&nbsp;‚â§&nbsp;<em>N</em><sub><em>f</em></sub> <strong>do</strong></td></tr><tr class="valign-top"><td class="align-left">7:&nbsp;<strong>if</strong> <em>CFF</em><sub><em>j</em></sub>&nbsp;&gt;&nbsp;<em>T</em>1 <strong>or</strong> <em>CFF</em><sub><em>j</em></sub>&nbsp;&lt;&nbsp;<em>T</em>2 <strong>then</strong></td></tr><tr class="valign-top"><td class="align-left">8:&nbsp;<em>Interval</em><sub><em>i</em></sub>.<em>add</em>(<em>j</em>‚àó1/<em>N</em><sub><em>f</em></sub>)</td></tr><tr class="valign-top"><td class="align-left">9:&nbsp;<strong>end if</strong></td></tr><tr class="valign-top"><td class="align-left">10:&nbsp;<strong>end while</strong></td></tr><tr class="valign-top"><td class="align-left">11:&nbsp;<em>len</em>_<em>inter</em><sub><em>i</em></sub>&nbsp;=&nbsp;<em>len</em>(<em>Interval</em><sub><em>i</em></sub>)</td></tr><tr class="valign-top"><td class="align-left">12:&nbsp;<strong>end if</strong></td></tr><tr class="valign-top"><td class="align-left">13:&nbsp;<em>code</em><sub><em>i</em></sub>&nbsp;=&nbsp;<em>norminization</em>(<em>code</em><sub><em>i</em></sub>)</td></tr><tr class="valign-top"><td class="align-left">14:&nbsp;<em>code</em><sub><em>i</em></sub>&nbsp;=&nbsp;<em>threshold</em>_<em>segment</em>(<em>code</em><sub><em>i</em></sub>, <em>Interval</em><sub><em>i</em></sub>)</td></tr><tr class="valign-top"><td class="align-left">15:&nbsp;<em>new</em>_<em>code</em><sub><em>i</em></sub>&nbsp;=&nbsp;<em>one</em>_<em>hot</em>(<em>code</em><sub><em>i</em></sub>, <em>len</em>_<em>inter</em><sub><em>i</em></sub>)</td></tr><tr class="valign-top"><td class="align-left">16:&nbsp;<strong>v</strong>&nbsp;=&nbsp;<em>add</em>_<em>pca</em>_<em>feature</em>(<em>new</em>_<em>code</em><sub><em>i</em></sub>, <em>N</em><sub><em>pca</em></sub>)</td></tr><tr class="valign-top"><td class="align-left">17:&nbsp;<em>final</em>_<em>code</em>&nbsp;=&nbsp;calculate <strong>p</strong>, <strong>n</strong>, <strong>s</strong>, and combine <strong>v</strong>, <strong>p</strong>, <strong>n</strong>, <strong>s</strong></td></tr><tr class="valign-top"><td class="align-left">18:&nbsp;<strong>return</strong> <em>final</em>_<em>code</em></td></tr></tbody></table></div></div></span></p></section><section id="sec3.2.3"><h4 id="sectitle0055" class="u-margin-m-top u-margin-xs-bottom">3.2.3. The effectiveness analysis of the semantic re-encoding and re-mapping</h4><p id="p0195">We think of network traffic as a character stream of words. It is be assumed that all attack traffic and normal traffic can be distinguished by a sequence of finite-length words. We let <em>q</em> be a prime and <em>n</em> a positive integer. A <em>q</em>&nbsp;‚àí&nbsp;<em>ary</em>(<em>n</em>, <em>K</em>, <em>d</em>) code is used to represent the codeword space formed by a sequence of words, where 1&nbsp;‚â§&nbsp;<em>d</em>&nbsp;‚â§&nbsp;<em>n</em>, <em>n</em> represents the code length, <em>K</em> represents the number of code words, and <em>d</em> represents the distance between codes. According to the assumption, all attacks and normal traffic are finite-length character sequences, thus the total number of code words <em>K</em> can be a specific value. According to the Singleton Bound, then <em>K</em>&nbsp;‚â§&nbsp;<em>q</em><sup><em>n</em>‚àí<em>d</em>+1</sup>. According to the discussion in Section <a name="bsec1" href="#sec1" class="workspace-trigger">1 Introduction</a>, <a name="bsec2" href="#sec2" class="workspace-trigger">2 Related work</a>, the semantic re-encoding and re-mapping can increase the code word length, that is, they can increase the value of <em>n</em>. Then, <span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-13-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>d</mi></mrow></msup><mo is=&quot;true&quot;>&amp;#x2264;</mo><mfrac is=&quot;true&quot;><mrow is=&quot;true&quot;><msup is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>q</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>n</mi><mo is=&quot;true&quot;>+</mo><mn is=&quot;true&quot;>1</mn></mrow></msup></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>K</mi></mrow></mfrac></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="9.216ex" height="3.936ex" viewBox="0 -1217.1 3968.1 1694.5" role="img" focusable="false" style="vertical-align: -1.109ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJMATHI-71"></use></g></g><g is="true" transform="translate(464,362)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-64"></use></g></g></g><g is="true" transform="translate(1212,0)"><use xlink:href="#MJMAIN-2264"></use></g><g is="true" transform="translate(1991,0)"><g transform="translate(397,0)"><rect stroke="none" width="1459" height="60" x="0" y="220"></rect><g is="true" transform="translate(60,546)"><g is="true"><g is="true"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-71"></use></g></g><g is="true" transform="translate(328,256)"><g is="true"><use transform="scale(0.5)" xlink:href="#MJMATHI-6E"></use></g><g is="true" transform="translate(300,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-2B"></use></g><g is="true" transform="translate(689,0)"><use transform="scale(0.5)" xlink:href="#MJMAIN-31"></use></g></g></g></g><g is="true" transform="translate(415,-393)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-4B"></use></g></g></g></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><msup is="true"><mrow is="true"><mi is="true">q</mi></mrow><mrow is="true"><mi is="true">d</mi></mrow></msup><mo is="true">‚â§</mo><mfrac is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">q</mi></mrow><mrow is="true"><mi is="true">n</mi><mo is="true">+</mo><mn is="true">1</mn></mrow></msup></mrow><mrow is="true"><mi is="true">K</mi></mrow></mfrac></math></span></span><script type="math/mml" id="MathJax-Element-13"><math><msup is="true"><mrow is="true"><mi is="true">q</mi></mrow><mrow is="true"><mi is="true">d</mi></mrow></msup><mo is="true">‚â§</mo><mfrac is="true"><mrow is="true"><msup is="true"><mrow is="true"><mi is="true">q</mi></mrow><mrow is="true"><mi is="true">n</mi><mo is="true">+</mo><mn is="true">1</mn></mrow></msup></mrow><mrow is="true"><mi is="true">K</mi></mrow></mfrac></math></script></span>, as the value of <em>n</em> increases, the value of <em>d</em> can increase accordingly. Meanwhile, the semantic re-encoding and re-mapping can increase the average inter-symbol distance between positive and negative samples of the training set. Therefore, if the semantic re-encoding and re-mapping are proper, the average inter-symbol distance between positive and negative samples can be improved, thereby increasing classification accuracy.</p></section></section><section id="sec3.3"><h3 id="sectitle0060" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.3. Deep learning model</h3><p id="p0200">We choose the ResNet (<a name="bbib9" href="#bib9" class="workspace-trigger">He et al., 2016</a>) as a deep learning framework for the method because it shows a good generalization ability for network unknown intrusion traffic.</p><div><p id="p0205">ResNet is based on Convolutional Neural Networks (CNN). CNN are very similar to ordinary neural networks, and they all consist of neurons with learnable weights and biases. As shown in <a name="bfig6" href="#fig6" class="workspace-trigger">Fig.&nbsp;6</a>, ResNet is made up of building blocks with ‚Äúcurved curve‚Äù. From <a name="bfig7" href="#fig7" class="workspace-trigger">Fig.&nbsp;7</a>, we can see that the building blocks are made up of identity mapping and residual mapping. Those two maps can solve the problem of the accuracy decreasing as the network deepens. The identity mapping is the ‚Äúcurved curve‚Äù part. Formally, denoting the desired underlying mapping as <em>H</em>(<em>x</em>), we let the stacked nonlinear layers fit another mapping of <em>F</em>(<em>x</em>)‚âî<em>H</em>(<em>x</em>)&nbsp;‚àí&nbsp;<em>x</em>. The original mapping is recast into <em>F</em>(<em>x</em>)&nbsp;+&nbsp;<em>x</em>.</p><figure class="figure text-xs" id="fig6"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr6.jpg" height="553" alt="Fig.&nbsp;6" aria-describedby="cap0050"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr6_lrg.jpg" target="_blank" download="" title="Download high-res image (270KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (270KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr6.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0050"><p id="fspara0035"><span class="label">Fig. 6</span>. The architecture of 8-layer ResNet.</p></span></span></figure><figure class="figure text-xs" id="fig7"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr7.jpg" height="225" alt="Fig.&nbsp;7" aria-describedby="cap0055"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr7_lrg.jpg" target="_blank" download="" title="Download high-res image (60KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (60KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr7.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0055"><p id="fspara0040"><span class="label">Fig. 7</span>. Residual learning: a building block.</p></span></span></figure></div><p id="p0210">We hypothesize that it is easier to optimize the residual mapping than to optimize the original, unreferenced mapping. To the extreme, if an identity mapping were optimal, it would be easier to push the residual to zero than to fit an identity mapping by a stack of nonlinear layers. The formulation of <em>F</em>(<em>x</em>)&nbsp;+&nbsp;<em>x</em> can be realized by feedforward neural networks with ‚Äúshortcut connections‚Äù. Shortcut connections are those skipping one or more layers. Identity-shortcut connections add neither extra parameter nor computational complexity. The deep residual network can be regarded as the ensemble of shallow neural networks of different depths. Deepening the network will not cause the network to degradation, while the residual design can raise the generation ability.</p></section><section id="sec3.4"><h3 id="sectitle0065" class="u-h4 u-margin-m-top u-margin-xs-bottom">3.4. Multi-space projection</h3><p id="p0215">There are many types of network intrusion traffic. For different types of traffic characteristics, a single spatial transformation is generally difficult to achieve proper feature extraction. In order to further separate the feature space formed by positive and negative samples, we proposed an algorithm called Algorithm 3 using multi-space projection.</p><div><p id="p0220">Sometimes, even for the same type of attack, the network traffic it generates will have many different types of characteristics. For example, in the NSL-KDD attack dataset, the DoS attack type is not balanced. As shown in <a name="bfig8" href="#fig8" class="workspace-trigger">Fig.&nbsp;8</a>, the DoS and Normal data sets are processed by PCA (principal component analysis) algorithm for easy observation. The red is the DoS dataset, and the blue is the Normal dataset. It can be seen from <a name="bfig8" href="#fig8" class="workspace-trigger">Fig.&nbsp;8</a> that the red dot overlaps the blue dot, and the DoS datasets are distributed in different three regions. It is difficult for the learning algorithm to learn three different distribution areas for the same type of attack traffic at the same time.</p><figure class="figure text-xs" id="fig8"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr8.jpg" height="564" alt="Fig.&nbsp;8" aria-describedby="cap0060"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr8_lrg.jpg" target="_blank" download="" title="Download high-res image (445KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (445KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr8.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0060"><p id="fspara0045"><span class="label">Fig. 8</span>. Dos &amp; Normal hybrid distribution in 2D and 3D values.</p></span></span></figure></div><p id="p0225">We describe the steps of Algorithm 3 in the following.</p><p id="p0230">The first step in Algorithm 3 is to use K-means to get more negative set. In other words, we separate the negative sets into more groups. The positive sample set is still in a group. For example, we change the attack type of DoS into DoS1, DoS2, and DoS3. The purpose of this step is to make the classification of the sample set closer to the multi-dimensional normal distribution.</p><div><p id="p0235">The second step: Multi-type binary classifiers (BCs) are used to divide the positive and negative samples. One of BCs consists of a pre-projection module&nbsp;+&nbsp;a specific training set&nbsp;+&nbsp;a ResNet network. Assuming that the pre-projection module runs first, and the network flow feature space obtained has a better specific feature distribution. The new distribution can be taken as a multidimensional normal distribution, and it can be effectively distinguished by BCs. Although ResNet can be stacked to very deep layers, we think that even network is not so deep enough to handle this problem. The structure of BCs is shown in <a name="bfig9" href="#fig9" class="workspace-trigger">Fig.&nbsp;9</a>.</p><figure class="figure text-xs" id="fig9"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr9.jpg" height="300" alt="Fig.&nbsp;9" aria-describedby="cap0065"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr9_lrg.jpg" target="_blank" download="" title="Download high-res image (258KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (258KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr9.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0065"><p id="fspara0050"><span class="label">Fig. 9</span>. The architecture of classifier.</p></span></span></figure></div><p id="p0240">There are several BCs and each of them classifies one type of sample. For an in-coming connection x, BCs make their decision, and if the BCi considers that it belongs to the normal, we define <em>BC</em><sub><em>i</em></sub>(<em>x</em>)&nbsp;=&nbsp;1, and when it belongs to the abnormal, we define <em>BC</em><sub><em>i</em></sub>(<em>x</em>)&nbsp;=&nbsp;0.</p><p id="p0245">The third step is to collect the results of the BCs, and then to calculate the sum of the results.</p><p id="p0250">The final step is to judge if the result is more than 1, then the x is a normal sample, or else the x is an attack sample. That is, if any of the four outcomes votes the connection to be an attack type, then we make the decision that the connection is an attack. The transformation function is as follows:<span class="display"><span id="fd9" class="formula"><span class="label">(9)</span><span class="math"><span class="MathJax_Preview" style=""></span><span class="MathJax_SVG" id="MathJax-Element-14-Frame" tabindex="0" style="font-size: 90%; display: inline-block; position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><munderover accent=&quot;false&quot; accentunder=&quot;false&quot; is=&quot;true&quot;><mrow is=&quot;true&quot;><mo is=&quot;true&quot;>&amp;#x2211;</mo></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi><mo linebreak=&quot;badbreak&quot; is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>0</mn></mrow><mrow is=&quot;true&quot;><mn is=&quot;true&quot;>3</mn></mrow></munderover><mi is=&quot;true&quot;>B</mi><msub is=&quot;true&quot;><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>C</mi></mrow><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>i</mi></mrow></msub><mrow is=&quot;true&quot;><mo stretchy=&quot;false&quot; is=&quot;true&quot;>(</mo><mrow is=&quot;true&quot;><mi is=&quot;true&quot;>x</mi></mrow><mo stretchy=&quot;false&quot; is=&quot;true&quot;>)</mo></mrow><mo is=&quot;true&quot;>&amp;gt;</mo><mo linebreak=&quot;goodbreak&quot; is=&quot;true&quot;>=</mo><mn is=&quot;true&quot;>1</mn></math>" role="presentation"><svg xmlns:xlink="http://www.w3.org/1999/xlink" width="19.562ex" height="3.199ex" viewBox="0 -1005.7 8422.4 1377.5" role="img" focusable="false" style="vertical-align: -0.864ex;" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="matrix(1 0 0 -1 0 0)"><g is="true"><g is="true"><g is="true"><use xlink:href="#MJSZ1-2211"></use></g></g><g is="true" transform="translate(1056,477)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMAIN-33"></use></g></g><g is="true" transform="translate(1056,-287)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g><g is="true" transform="translate(244,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(794,0)"><use transform="scale(0.707)" xlink:href="#MJMAIN-30"></use></g></g></g><g is="true" transform="translate(2471,0)"><use xlink:href="#MJMATHI-42"></use></g><g is="true" transform="translate(3231,0)"><g is="true"><g is="true"><use xlink:href="#MJMATHI-43"></use></g></g><g is="true" transform="translate(715,-150)"><g is="true"><use transform="scale(0.707)" xlink:href="#MJMATHI-69"></use></g></g></g><g is="true" transform="translate(4457,0)"><g is="true"><use xlink:href="#MJMAIN-28"></use></g><g is="true" transform="translate(389,0)"><g is="true"><use xlink:href="#MJMATHI-78"></use></g></g><g is="true" transform="translate(962,0)"><use xlink:href="#MJMAIN-29"></use></g></g><g is="true" transform="translate(6087,0)"><use xlink:href="#MJMAIN-3E"></use></g><g is="true" transform="translate(6865,0)"><use xlink:href="#MJMAIN-3D"></use></g><g is="true" transform="translate(7921,0)"><use xlink:href="#MJMAIN-31"></use></g></g></svg><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><munderover accent="false" accentunder="false" is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">i</mi><mo linebreak="badbreak" is="true">=</mo><mn is="true">0</mn></mrow><mrow is="true"><mn is="true">3</mn></mrow></munderover><mi is="true">B</mi><msub is="true"><mrow is="true"><mi is="true">C</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mrow is="true"><mo stretchy="false" is="true">(</mo><mrow is="true"><mi is="true">x</mi></mrow><mo stretchy="false" is="true">)</mo></mrow><mo is="true">&gt;</mo><mo linebreak="goodbreak" is="true">=</mo><mn is="true">1</mn></math></span></span><script type="math/mml" id="MathJax-Element-14"><math><munderover accent="false" accentunder="false" is="true"><mrow is="true"><mo is="true">‚àë</mo></mrow><mrow is="true"><mi is="true">i</mi><mo linebreak="badbreak" is="true">=</mo><mn is="true">0</mn></mrow><mrow is="true"><mn is="true">3</mn></mrow></munderover><mi is="true">B</mi><msub is="true"><mrow is="true"><mi is="true">C</mi></mrow><mrow is="true"><mi is="true">i</mi></mrow></msub><mrow is="true"><mo stretchy="false" is="true">(</mo><mrow is="true"><mi is="true">x</mi></mrow><mo stretchy="false" is="true">)</mo></mrow><mo is="true">&gt;</mo><mo linebreak="goodbreak" is="true">=</mo><mn is="true">1</mn></math></script></span></span></span></p><p id="p0255">We formalize this algorithm in <a name="bdtbl3" href="#dtbl3" class="workspace-trigger">Algorithm 3</a>.<span class="display"><div class="tables colsep-0 frame-topbot rowsep-0" id="dtbl3"><span class="captions"><span id="cap0020"><p id="tspara0020"><span class="label">Algorithm 3</span>. Multi-space Projection algorithm.</p></span></span><div class="groups"><table><tbody><tr class="valign-top"><td class="align-left">1:&nbsp;Pre-projection and get several training sets.</td></tr><tr class="valign-top"><td class="align-left">2:&nbsp;Train BCs for classify using different training sets.</td></tr><tr class="valign-top"><td class="align-left">3:&nbsp;Aggression the results of BCs.</td></tr><tr class="valign-top"><td class="align-left">4:&nbsp;Final judge.</td></tr></tbody></table></div></div></span></p></section></section><section id="sec4"><h2 id="sectitle0070" class="u-h3 u-margin-l-top u-margin-xs-bottom">4. Experimental results and analysis</h2><p id="p0260">This experiment examines two data sets. One is the dataset collected especially for web attack in Hangdian Security Lab, which contains both the normal and abnormal http streams, named Hduxss_data1.0. The other is the NSL-KDD, which is considered to be the benchmark evaluation data set in the field of intrusion detection. The experiment is performed on Pytorch 1.0 using a computer with GPU 2080ti, the operating system is Ubuntu 18.04, and the memory is 32G.</p><section id="sec4.1"><h3 id="sectitle0075" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.1. Hduxss_data1.0 data set</h3><p id="p0265">The Hduxss_data1.0 data set consists of three types of data:<dl class="list"><dt class="list-label">1.</dt><dd class="list-description"><p id="p0270">Attack samples generated by the SQLMAP(SQLMAP is an open source penetra-tion testing tool that automates the process of detecting and exploiting SQL injection flaws and taking over of database servers). The total number of this type is 810,000.</p></dd><dt class="list-label">2.</dt><dd class="list-description"><p id="p0275">Attack samples manually and automatically generated by the XSSLESS tool; the total number of this type is 11,000.</p></dd><dt class="list-label">3.</dt><dd class="list-description"><p id="p0280">Normal request samples collected through Firefox browser when browses various web pages. We extract parameters from them and obtains 130,000 normal samples.</p></dd></dl></p><div><p id="p0285">For normal samples and abnormal samples, we randomly select 50% of the data for training, 50% of the data for testing, and repeat 10 rounds of testing for the average. The results are shown in <a name="btbl3" href="#tbl3" class="workspace-trigger">Table&nbsp;3</a>. In the test process, all data is processed by SRDLM Algorithm 1, and the outputs are reclassified by support vector machine, naive Bayes, and SRDLM Algorithm 3. It can be seen from <a name="btbl3" href="#tbl3" class="workspace-trigger">Table&nbsp;3</a> that all the machine learning methods involved in the test achieved an accuracy of more than 99% and F1 values, which is mainly because Algorithm 1 has a good feature separation effect on the above attack traffic. At the same time, the SRDLM algorithm achieved the best recognition performance compared with the classical machine learning algorithm. The SRDLM Algorithm 1 performs a round of semantic re-encoding on HTTP data streams, highlighting the special semantics of network data, and increasing the distinguishability of data streams. In the future, no matter which classifier like SVM, Bayes or SRDLM is used, good detection performance can be achieved.</p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl3"><span class="captions"><span id="cap0110"><p id="tspara0035"><span class="label">Table 3</span>. The result of Hduxss_data1.0 dataset.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col"></th><th scope="col">accuracy</th><th scope="col">precision</th><th scope="col">recall</th><th scope="col">F1</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">Algorithm 1 +SVM</td><td class="align-left">99.3%</td><td class="align-left">99.4%</td><td class="align-left">99.2%</td><td class="align-left">0.993</td></tr><tr class="valign-top"><td class="align-left">Algorithm 1 +Naive Bayes</td><td class="align-left">99.0%</td><td class="align-left">99.1%</td><td class="align-left">99.1%</td><td class="align-left">0.991</td></tr><tr class="valign-top"><td class="align-left">SRDLM(including Algorithm 1)</td><td class="align-left">99.5%</td><td class="align-left">99.7%</td><td class="align-left">99.5%</td><td class="align-left">0.996</td></tr></tbody></table></div></div></div><div><p id="p0290">The algorithm stability test results are shown in <a name="bfig10" href="#fig10" class="workspace-trigger">Fig.&nbsp;10</a>. It can be shown that the algorithm requires less data, even in the case of only one thousandth of the data is trained, and it still get high classification accuracy (&gt;98%). With the increase of the training set, the accuracy rate is gradually close to 1. Tests show that the SRDLM algorithm has good stability.</p><figure class="figure text-xs" id="fig10"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr10.jpg" height="278" alt="Fig.&nbsp;10" aria-describedby="cap0070"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr10_lrg.jpg" target="_blank" download="" title="Download high-res image (99KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (99KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr10.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0070"><p id="fspara0055"><span class="label">Fig. 10</span>. The data demand of SRDLM algorithm in Hduxss_data Set.</p></span></span></figure></div></section><section id="sec4.2"><h3 id="sectitle0080" class="u-h4 u-margin-m-top u-margin-xs-bottom">4.2. NSL-KDD data set</h3><div><p id="p0295">Each record of NSL-KDD dataset is a vector that contains 41 features and a label which marks the types: normal or attack. The attack types include four categories: DoS, Probe, U2R, R2L. We use KDDTrain+ and KDDTest+ in our experiment. The data distribution is shown in <a name="btbl4" href="#tbl4" class="workspace-trigger">Table&nbsp;4</a>.</p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl4"><span class="captions"><span id="cap0115"><p id="tspara0040"><span class="label">Table 4</span>. The data distribution of KDDTrain+ and KDDTest+.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col"></th><th scope="col">Total</th><th scope="col">Normal</th><th scope="col">DoS</th><th scope="col">Probe</th><th scope="col">R2L</th><th scope="col">U2R</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">KDDTrain+</td><td class="align-left">125973</td><td class="align-left">37343</td><td class="align-left">45927</td><td class="align-left">11656</td><td class="align-left">995</td><td class="align-left">52</td></tr><tr class="valign-top"><td class="align-left">KDDTest+</td><td class="align-left">22544</td><td class="align-left">9711</td><td class="align-left">7458</td><td class="align-left">2421</td><td class="align-left">2754</td><td class="align-left">200</td></tr></tbody></table></div></div></div><section id="sec4.2.1"><h4 id="sectitle0085" class="u-margin-m-top u-margin-xs-bottom">4.2.1. The generation ability of ResNet</h4><div><p id="p0300">ResNet shows a good generation ability through experiment. We train kNN, Shallow CNN and ResNet models on KDDTrain&nbsp;+&nbsp;to classify the normal and attack traffic in KDDTest+. For the convenience of transformation, we remove the 7th dimension feature rarely used in the 41 dimension features. The 7th dimension feature has zero values in almost all samples in the training set. The remaining 40 features are transformed into a 5 ‚àó 8 matrix, which can be transformed into the input matrix of a CNN model. The experiment result is shown in <a name="btbl5" href="#tbl5" class="workspace-trigger">Table&nbsp;5</a>. The table shows the correct predicted number of samples and the proportion of this number in the test set of the same type with samples. The error rate of the R2L type is the highest among the 5 types. This is mainly because the R2L types in KDDTrain + and KDDTest&nbsp;+&nbsp;are very different, and the classifier is difficult to generalize. As can be seen from <a name="btbl5" href="#tbl5" class="workspace-trigger">Table&nbsp;5</a>, the ResNet network has better average generalization ability for various types of positive and negative samples. Then, the generation ability of the three models on R2L type is analyzed as follows.</p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl5"><span class="captions"><span id="cap0120"><p id="tspara0045"><span class="label">Table 5</span>. The correct predicted number of all types on KDDTest+.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col"></th><th scope="col">kNN</th><th scope="col">kNN rate</th><th scope="col">Shallow CNN</th><th scope="col">Shallow CNN rate</th><th scope="col">ResNet</th><th scope="col">ResNet rate</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">Normal</td><td class="align-left">9478</td><td class="align-left">97.60%</td><td class="align-left">9126</td><td class="align-left">96.38%</td><td class="align-left">8067</td><td class="align-left">89.04%</td></tr><tr class="valign-top"><td class="align-left">DoS</td><td class="align-left">6094</td><td class="align-left">87.71%</td><td class="align-left">6315</td><td class="align-left">84.67%</td><td class="align-left">7099</td><td class="align-left">95.19%</td></tr><tr class="valign-top"><td class="align-left">Probe</td><td class="align-left">1863</td><td class="align-left">76.95%</td><td class="align-left">2116</td><td class="align-left">87.40%</td><td class="align-left">2353</td><td class="align-left">97.19%</td></tr><tr class="valign-top"><td class="align-left">R2L</td><td class="align-left">149</td><td class="align-left">5.41%</td><td class="align-left">70</td><td class="align-left">2.54%</td><td class="align-left">1036</td><td class="align-left">37.62%</td></tr><tr class="valign-top"><td class="align-left">U2R</td><td class="align-left">115</td><td class="align-left">57.5%</td><td class="align-left">112</td><td class="align-left">56%</td><td class="align-left">119</td><td class="align-left">59.5%</td></tr></tbody></table></div></div></div><div><p id="p0305">We use Grad-CAM (<a name="bbib21" href="#bib21" class="workspace-trigger">Selvaraju et al., 2017</a>) to locate important regions with class discrimination in the input sample. As shown in <a name="bfig11" href="#fig11" class="workspace-trigger">Fig.&nbsp;11</a>, the result of Grad-CAM is a heat map. The red area indicates that the pixels of this part contribute the most to the classification result. As can be seen from <a name="bfig11" href="#fig11" class="workspace-trigger">Fig.&nbsp;11</a>, features 34, 35, and 36 contribute the most to the determination of the sample type. Then, the performance on R2L of classifiers through feature 34, 35, 36 was studied. The result is shown in <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a>. In <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a>, the x-axis, y-axis, and z-axis are respectively features 34,35, and 36 named ‚Äòdst_host_same_srv_rate‚Äô, ‚Äòdst_host_diff_srv_rate‚Äô and ‚Äòdst_host_same_src_port_rate‚Äô. There are three types of dots in the figure. The green dots and the orange dots mean the test samples of R2L type wrongly predicted and correctly predicted separately by the models we trained. And the red dots mean the train samples of R2L type. The abbreviated name of the three types of dots in <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a> are ‚ÄòR2L_test_F‚Äô, ‚ÄòR2L_test_T‚Äô and ‚ÄòR2L_train‚Äô. Obviously, the orange dots in <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a>(c) are much larger than those in <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a>(a) (b). From <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a>(c), it can be seen that the trained ResNet model learns some of the attack traffic when the feature 34 is between (0‚Äì0.6), the feature 35 is between (0‚Äì1) and the feature 36 is between (0‚Äì0.7). While in the kNN and Shallow CNN, from <a name="bfig12" href="#fig12" class="workspace-trigger">Fig.&nbsp;12</a>(a) and <a name="bfig12" href="#fig12" class="workspace-trigger">(b)</a>, it can hardly be seen that the correct predicted sample. We then created new 5000 samples that the feature 34, 35, 36 were in the interval of (0‚Äì0.6), (0‚Äì1), (0‚Äì0.7) separately, while the other features were the same as one of R2L samples in the training set. From <a name="bfig13" href="#fig13" class="workspace-trigger">Fig.&nbsp;13</a>, 67% of the samples were predicted right through the ResNet model. The same test works on KNN and shallow CNN networks, 7% of the samples were predicted right for kNN model, while all the created 5000 samples were predicted as the opposite type on the Shallow CNN model. Based on the present experiments, we infer that the kNN model and the Shallow CNN model does not learn the mapping of feature 34, 35, 36 to the classification of the result. While the ResNet model is successfully generated from the training sample to the near region. But there are still regions that could not be generated well, which means the ResNet model still has some limitation on generation. Comparing with the other two models, ResNet model has better generalization ability.</p><figure class="figure text-xs" id="fig11"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr11.jpg" height="216" alt="Fig.&nbsp;11" aria-describedby="cap0075"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr11_lrg.jpg" target="_blank" download="" title="Download high-res image (61KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (61KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr11.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0075"><p id="fspara0060"><span class="label">Fig. 11</span>. Heatmap of a R2L sample on ResNet model.</p></span></span></figure><figure class="figure text-xs" id="fig12"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr12.jpg" height="963" alt="Fig.&nbsp;12" aria-describedby="cap0080"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr12_lrg.jpg" target="_blank" download="" title="Download high-res image (719KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (719KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr12.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0080"><p id="fspara0065"><span class="label">Fig. 12</span>. (a).The kNN result on R2L. (b).The Shallow CNN result on R2L. (c).The ResNet result on R2L. The ‚ÄòR2L_test_F‚Äô means the wrong predicted R2L samples in the test set. The ‚ÄòR2L_test_T‚Äô means the correct predicted R2L samples in the test set. The ‚ÄòR2L_train‚Äô means the R2L samples in the train set.</p></span></span></figure><figure class="figure text-xs" id="fig13"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr13.jpg" height="323" alt="Fig.&nbsp;13" aria-describedby="cap0085"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr13_lrg.jpg" target="_blank" download="" title="Download high-res image (747KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (747KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr13.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0085"><p id="fspara0070"><span class="label">Fig. 13</span>. The ResNet result on new ‚ÄòR2L‚Äô samples.</p></span></span></figure></div></section><section id="sec4.2.2"><h4 id="sectitle0090" class="u-margin-m-top u-margin-xs-bottom">4.2.2. Changing the depths of network</h4><p id="p0310">Based on the theoretical analysis of the CNN, it shows that the depth of the network matters much on the classification accuracy and the training time. Thus, we design an experiment to choose an appropriate depth.</p><div><p id="p0315">For the ResNet, we change the numbers of filters to 2, 4, 8 respectively. The network started with a 3‚àó3 convolution layer, and ended with a global average pooling, a 2-way fully-connected layer, and softmax. There are totally 6n+2 stacked weighted layers. <a name="btbl6" href="#tbl6" class="workspace-trigger">Table&nbsp;6</a> summarizes the architecture: The mix of KDDTrain+ and KDDTest&nbsp;+&nbsp;are used as the training set and the KDDTest+ is the testing set. We compare 8, 20, 56-layer networks. From <a name="btbl7" href="#tbl7" class="workspace-trigger">Table&nbsp;7</a>, it can be seen that with the deepening of network depth, there is hardly an improvement in accuracy. It can be speculated that the depth of the 8-layer ResNet network is enough, and the remaining data that could not be accurately identified is the data that the training set does not know at all. Deeper network means more time. As a result, we chose 8-layer ResNet in our following experiment.</p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl6"><span class="captions"><span id="cap0125"><p id="tspara0050"><span class="label">Table 6</span>. The architecture of the ResNet used in the proposed method.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col">Output map size</th><th scope="col">26‚àó26</th><th scope="col">13‚àó13</th><th scope="col">7‚àó7</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">#layers</td><td class="align-left">1+2n</td><td class="align-left">2n</td><td class="align-left">2n</td></tr><tr class="valign-top"><td class="align-left">#filters</td><td class="align-left">2</td><td class="align-left">4</td><td class="align-left">8</td></tr></tbody></table></div></div><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl7"><span class="captions"><span id="cap0130"><p id="tspara0055"><span class="label">Table 7</span>. Accuracy for binary classification based on training data.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col">Depth of ResNet</th><th scope="col">accuracy</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">ResNet_8</td><td class="align-left">97</td></tr><tr class="valign-top"><td class="align-left">ResNet_20</td><td class="align-left">97.35</td></tr><tr class="valign-top"><td class="align-left">ResNet_56</td><td class="align-left">97.5</td></tr></tbody></table></div></div></div></section><section id="sec4.2.3"><h4 id="sectitle0095" class="u-margin-m-top u-margin-xs-bottom">4.2.3. Evaluating the impact of the semantic re-encoding and re-mapping</h4><p id="p0320">Three kinds of dimensions are employed to test the performance of the feature re-encoding algorithm. They are 40‚àó4, 172‚àó4,194‚àó4. For the 40‚àó4 dimension, we remove the unusable feature 7 from the training and test set, and then copy 3 times to form a 40‚àó4 dimension. For the 172‚àó4 and 194‚àó4 dimension, Algorithm 2 is used to cut the two dimensions to 676 dimensions, which could be transformed into 26‚àó26.</p><p id="p0325">In this section, we use 40‚àó4,172‚àó4 and 194‚àó4 dimension datasets to evaluate the re-encoding impact on the binary classification of NSL-KDD.</p><div><p id="p0330">First, KDDTrain + is used as the training set, and KDDTest&nbsp;+&nbsp;is used as the test set. We set the batchsize of the training set to 16384. And the learning rate is 0.01, the optimization method is Adam, the weight decay is 0.1, and the number of epoch is 10000. It can be seen from <a name="bfig14" href="#fig14" class="workspace-trigger">Fig.&nbsp;14</a> that the accuracy of 172‚àó4 and 194‚àó4 is better than 40‚àó4 dimension. This indicates the effectiveness of semantic re-encoding.</p><figure class="figure text-xs" id="fig14"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr14.jpg" height="288" alt="Fig.&nbsp;14" aria-describedby="cap0090"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr14_lrg.jpg" target="_blank" download="" title="Download high-res image (185KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (185KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr14.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0090"><p id="fspara0075"><span class="label">Fig. 14</span>. The accuracy for binary classification based on KDDTest&nbsp;+&nbsp;dataset with different dimensions.</p></span></span></figure></div><p id="p0335">There seems still some false alarm and missing alarm. In order to promote the ability of generalization, we create some predicted data according to the feature of intrusion traffic, and put them into the training set. And we use this new training dataset to train. The hyper-parameters are the same as the previous one. As is shown in <a name="bfig14" href="#fig14" class="workspace-trigger">Fig.&nbsp;14</a>, the semantically recoded data set performed better than the original data set.</p><p id="p0340">We want to find why there are samples that cannot be classified right. So we mixed the KDDTrain+ with KDDTest+, and split it in to 10 folds with the same distribution of different types of network traffic. Each time, 9 of them are used as the training set and 1 is used as the test set. After 10 times training and testing, we get the average accuracy. From <a name="bfig14" href="#fig14" class="workspace-trigger">Fig.&nbsp;14</a>, it can be seen that the cross-validated detection rate raises obviously than the other two, and the re-encoded dataset is a little better than the 40‚àó4 dimension. The reason can be that the samples in KDDTrain&nbsp;+&nbsp;are not very typical. Some sample types of KDDTest&nbsp;+&nbsp;do not appear at all in KDDTrain+, and the attack samples themselves are significantly different, which makes it difficult to predict KDDTest&nbsp;+&nbsp;based on KDDTrain+.</p><div><p id="p0345">We also compare with big convolution in the first layer, through trying to set the first convolution layer size to 7‚àó7, and contrast with the 3‚àó3 network. The Algorithm 3 is used. <a name="btbl8" href="#tbl8" class="workspace-trigger">Table&nbsp;8</a> shows the result of BCs, the 40‚àó4_3 means the 40‚àó4 dimension with the first convolution of 3‚àó3, and the 40‚àó4_7 means the 40‚àó4 dimension with the first convolution of 7‚àó7. Referring to <a name="bfig8" href="#fig8" class="workspace-trigger">Fig.&nbsp;8</a>, the DoS dataset is separated into 3 parts. In the process of experiment, it is found that although a single DoS is easy to be classified, the effect of the combination of the BCs of DoS and other Attacks is not good. For example, when using accuracy as the classifier design criteria, the results of DoS classification have little impact on the final classification results after merging the results of all BCs. Through the experiment, it is found that using the precision standard to design DoS classifier is the most helpful to the result of multi BCs fusion. Therefore, in the experimental process, the precision standard is used for the design of DoS classifier, and the rest of the classifier design use the accuracy standard. The precisions of the DoS classifiers are shown in <a name="btbl8" href="#tbl8" class="workspace-trigger">Table&nbsp;8</a>. As shown in <a name="bfig15" href="#fig15" class="workspace-trigger">Fig.&nbsp;15</a>, the network whose first convolution is 7‚àó7 convolution outperform the 3‚àó3 size, and the best accuracy of this experiment is 94.03%.</p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl8"><span class="captions"><span id="cap0135"><p id="tspara0060"><span class="label">Table 8</span>. Accuracy for binary classification based on KDDTrain+ and KDDTest+.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col" rowspan="2"></th><th scope="col" rowspan="2">Normal accuracy</th><th scope="col" rowspan="2">R2l&amp;U2R accuracy</th><th scope="col" rowspan="2">Probe accuracy</th><th scope="col" colspan="3">DoS precision</th><th scope="col" rowspan="2">accuracy</th></tr><tr class="rowsep-1 valign-top"><th scope="col">DoS1</th><th scope="col">DoS2</th><th scope="col">DoS3</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">Normal ResNet(40&nbsp;‚àó&nbsp;4_3)</td><td class="align-left">84.67</td><td class="align-left">91.27</td><td class="align-left">95</td><td class="align-left">99.8</td><td class="align-left">92.2</td><td class="align-left">75.1</td><td class="align-left">88.75</td></tr><tr class="valign-top"><td class="align-left">SRDLM(172&nbsp;‚àó&nbsp;4_3)</td><td class="align-left">90.08</td><td class="align-left">95.57</td><td class="align-left">94.54</td><td class="align-left">98.6</td><td class="align-left">91.36</td><td class="align-left">94.3</td><td class="align-left">91.65</td></tr><tr class="valign-top"><td class="align-left">SRDLM(194&nbsp;‚àó&nbsp;4_3)</td><td class="align-left">91.87</td><td class="align-left">93.7</td><td class="align-left">95.6</td><td class="align-left">99.6</td><td class="align-left">99.4</td><td class="align-left">95.6</td><td class="align-left">93.37</td></tr><tr class="valign-top"><td class="align-left">Normal ResNet(40&nbsp;‚àó&nbsp;4_7)</td><td class="align-left">90.04</td><td class="align-left">89.02</td><td class="align-left">93.64</td><td class="align-left">99.7</td><td class="align-left">59</td><td class="align-left">93.3</td><td class="align-left">90.2</td></tr><tr class="valign-top"><td class="align-left">SRDLM(172&nbsp;‚àó&nbsp;4_7)</td><td class="align-left">88.4</td><td class="align-left">94.9</td><td class="align-left">94</td><td class="align-left">99.9</td><td class="align-left">84.7</td><td class="align-left">89.5</td><td class="align-left">91.73</td></tr><tr class="valign-top"><td class="align-left">SRDLM(194&nbsp;‚àó&nbsp;4_7)</td><td class="align-left">90.13</td><td class="align-left">94.8</td><td class="align-left">95.9</td><td class="align-left">95.5</td><td class="align-left">97</td><td class="align-left">93.7</td><td class="align-left">94.03</td></tr></tbody></table></div></div><figure class="figure text-xs" id="fig15"><span><img src="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr15.jpg" height="288" alt="Fig.&nbsp;15" aria-describedby="cap0095"><ol class="links-for-figure"><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr15_lrg.jpg" target="_blank" download="" title="Download high-res image (141KB)"><span class="anchor-text">Download : <span class="download-link-title">Download high-res image (141KB)</span></span></a></li><li><a class="anchor download-link u-font-sans" href="https://ars.els-cdn.com/content/image/1-s2.0-S1084804520301624-gr15.jpg" target="_blank" download="" title="Download full-size image"><span class="anchor-text">Download : <span class="download-link-title">Download full-size image</span></span></a></li></ol></span><span class="captions"><span id="cap0095"><p id="fspara0080"><span class="label">Fig. 15</span>. The accuracy for binary classification based on KDDTrain+ and KDDTest+.</p></span></span></figure></div></section><section id="sec4.2.4"><h4 id="sectitle0100" class="u-margin-m-top u-margin-xs-bottom">4.2.4. Discussion and additional comparisons</h4><div><p id="p0350">The performance comparison between different classification algorithms is shown in <a name="btbl9" href="#tbl9" class="workspace-trigger">Table&nbsp;9</a> and <a name="btbl10" href="#tbl10" class="workspace-trigger">Table&nbsp;10</a>. From <a name="btbl9" href="#tbl9" class="workspace-trigger">Table&nbsp;9</a>, the experimental results show that SRDLM improves the performance by more than 8% compared with other classifiers. While comparing the ANN with the SRDLM, the classification result is unsatisfactory. It can be inferred that the semantic re-encoding and ResNet improved the gap between the attack and the normal samples, and the deep learning algorithm has the ability to fit nonlinear operations. Comparing shallow CNN with SRDLM, the advantage of semantic re-encoding and the generation ability of ResNet are shown obviously. In addition, as the ResNet has the strength of CNN, it runs less time than RNN-IDS. Compared with several current algorithms, the SDRLM algorithm can effectively learn the latent feature of attack sample of each types attack and make the re-encoded semantic space boundaries clearing, thus leading a good accuracy. <a name="btbl10" href="#tbl10" class="workspace-trigger">Table&nbsp;10</a> shows the computational complexity of related typical algorithms. As can be seen in <a name="btbl10" href="#tbl10" class="workspace-trigger">Table&nbsp;10</a>, the complexity of kNN is O(m‚àón). When classifying test samples, the algorithm complexity of kNN is positively related to the size of existing samples, while CNN and SRDLM algorithms are not limited by the size of existing sample sets. The complexity of the rest algorithms in <a name="btbl9" href="#tbl9" class="workspace-trigger">Table&nbsp;9</a> has nothing to do with the number of training set, but they are related to the size of the learning model. The complexity of CNN is O(n‚àór‚àóc‚àól), and the SRDLM is just k times more than the CNN model because of the k BCs computing. The r, c, k, and l values of the SRDLM algorithm are all &lt;10. By introducing GPU parallel computing, the algorithm's running time can be reduced to an acceptable level.</p><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl9"><span class="captions"><span id="cap0140"><p id="tspara0065"><span class="label">Table 9</span>. Performance of the proposed method for testing KDDTest+.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col"></th><th scope="col">accuracy</th><th scope="col">precision</th><th scope="col">recall</th><th scope="col">F1</th></tr></thead><tbody><tr class="valign-top"><td class="align-left">kNN</td><td class="align-left">79.06%</td><td class="align-left">67.8%</td><td class="align-left">97.7%</td><td class="align-left">0.8008</td></tr><tr class="valign-top"><td class="align-left">DBN</td><td class="align-left">63.9%</td><td class="align-left">60.45%</td><td class="align-left">46.8%</td><td class="align-left">0.5276</td></tr><tr class="valign-top"><td class="align-left">Shallow CNN</td><td class="align-left">79.72%</td><td class="align-left">68.92%</td><td class="align-left">96.37%</td><td class="align-left">0.8037</td></tr><tr class="valign-top"><td class="align-left">ANN (<a name="bbib12" href="#bib12" class="workspace-trigger">Ingre and Yadav, 2015</a>)</td><td class="align-left">81.16%</td><td class="align-left">96.59%</td><td class="align-left">69.35%</td><td class="align-left">0.8073</td></tr><tr class="valign-top"><td class="align-left">RNN-IDS (<a name="bbib26" href="#bib26" class="workspace-trigger">Yin et al., 2017</a>)</td><td class="align-left">83.28%</td><td class="align-left">96.92%</td><td class="align-left">72.95%</td><td class="align-left">0.8324</td></tr><tr class="valign-top"><td class="align-left">SRDLM</td><td class="align-left">94.03%</td><td class="align-left">95.37%</td><td class="align-left">90.53%</td><td class="align-left">0.9288</td></tr></tbody></table></div></div><div class="tables colsep-0 frame-topbot rowsep-0" id="tbl10"><span class="captions"><span id="cap0145"><p id="tspara0070"><span class="label">Table 10</span>. Complexity for different types of algorithms. m is the number of train set, n is the dimension of input samples, r is the kernel size of convolutions, l is the number of network layers, c is the convolution channels, k is the number of BCs.</p></span></span><div class="groups"><table><thead><tr class="rowsep-1 valign-top"><th scope="col"></th><th scope="col">Complexity</th></tr></thead><tbody><tr class="valign-top"><th class="align-left" scope="row">kNN</th><td class="align-left">O(m‚àón)</td></tr><tr class="valign-top"><th class="align-left" scope="row">CNN</th><td class="align-left">O(n‚àór‚àóc‚àól)</td></tr><tr class="valign-top"><th class="align-left" scope="row">SRDLM</th><td class="align-left">O(n‚àór‚àóc‚àól‚àók)</td></tr></tbody></table></div></div></div></section></section></section><section id="sec5"><h2 id="sectitle0105" class="u-h3 u-margin-l-top u-margin-xs-bottom">5. Conclusions</h2><p id="p0355">This paper proposes an SRDLM intrusion detection method based on semantic re-encoding and deep learning. The SRDLM algorithm has advantages in dealing with anomaly detection of network traffic with huge semantic coding space and negligible word order. However, for the network traffic that has been extracted features, semantic re-encoding technology has limited performance improvement in traffic detection. Semantic re-encoding technology can be combined with deep learning technology to achieve better network traffic detection results. This paper studies the ResNet network architecture and combines ResNet with semantic re-encoding to effectively improve the generalization ability of the network anomaly detection model. The follow-up work will study the prediction of network abnormal traffic to enhance the robustness of the network detection model.</p></section><section id="sec6"><h2 id="sectitle0110" class="u-h3 u-margin-l-top u-margin-xs-bottom">CRediT authorship contribution statement</h2><p id="p0360"><strong>Zhendong Wu:</strong> Methodology, Writing - original draft, Writing - review &amp; editing, Software, Resources. <strong>Jingjing Wang:</strong> Software, Writing - original draft. <strong>Liqin Hu:</strong> Investigation, Formal analysis. <strong>Zhang Zhang:</strong> Validation. <strong>Han Wu:</strong> Validation.</p></section></div><section id="coi0010"><h2 id="sectitle0115" class="u-h3 u-margin-l-top u-margin-xs-bottom">Declaration of competing interest</h2><p id="p0365">The authors declare that they have no known competing financial interests or personal relationships that could have appeared to influence the work reported in this paper.</p></section><section id="ack0010"><h2 id="sectitle0120" class="u-h3 u-margin-l-top u-margin-xs-bottom">Acknowledgement</h2><p id="p0370">This research is supported by <span id="gs1">National Natural Science Foundation of China</span> (No.<a href="#gs1">61772162</a>), <span id="gs4">Key Projects of NSFC Joint Fund of China</span> (No.<a href="#gs4">U1866209</a>), <span id="gs3">National Natural Science Foundation of China</span> (No.<a href="#gs3">61602144</a>), <span id="gs5">National Key R&amp;D Program of China</span> (No.<a href="#gs5">2018YFB0804102</a>).</p></section></div>